<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Writing TCP servers and clients | ES for Eclipse Vert.x</title>
    <meta name="generator" content="VuePress 1.5.0">
    <link rel="shortcut icon" type="image/png" href="/es4x/favicon.png">
    <link rel="stylesheet" type="text/css" href="/es4x/player/asciinema-player.css">
    <script src="/es4x/player/asciinema-player.js"></script>
    <meta name="description" content="A Modern JavaScript runtime for Eclipse Vert.x">
    <link rel="preload" href="/es4x/assets/css/0.styles.57be2129.css" as="style"><link rel="preload" href="/es4x/assets/js/app.cfb14a02.js" as="script"><link rel="preload" href="/es4x/assets/js/2.96613d0f.js" as="script"><link rel="preload" href="/es4x/assets/js/77.7c3517c1.js" as="script"><link rel="prefetch" href="/es4x/assets/js/10.25f493b2.js"><link rel="prefetch" href="/es4x/assets/js/100.cfb483ce.js"><link rel="prefetch" href="/es4x/assets/js/101.e546445b.js"><link rel="prefetch" href="/es4x/assets/js/102.9c678484.js"><link rel="prefetch" href="/es4x/assets/js/103.58ddcfc8.js"><link rel="prefetch" href="/es4x/assets/js/104.5d636807.js"><link rel="prefetch" href="/es4x/assets/js/105.9c9f8986.js"><link rel="prefetch" href="/es4x/assets/js/106.fb797c19.js"><link rel="prefetch" href="/es4x/assets/js/107.29eb69ad.js"><link rel="prefetch" href="/es4x/assets/js/108.d97e0b4e.js"><link rel="prefetch" href="/es4x/assets/js/109.28629ef4.js"><link rel="prefetch" href="/es4x/assets/js/11.6250afa8.js"><link rel="prefetch" href="/es4x/assets/js/110.3dd0cba3.js"><link rel="prefetch" href="/es4x/assets/js/111.601b115c.js"><link rel="prefetch" href="/es4x/assets/js/112.a49c45ac.js"><link rel="prefetch" href="/es4x/assets/js/113.ea0e864c.js"><link rel="prefetch" href="/es4x/assets/js/114.24c46597.js"><link rel="prefetch" href="/es4x/assets/js/115.65241419.js"><link rel="prefetch" href="/es4x/assets/js/116.a69493f0.js"><link rel="prefetch" href="/es4x/assets/js/117.03106a2c.js"><link rel="prefetch" href="/es4x/assets/js/118.50ed2245.js"><link rel="prefetch" href="/es4x/assets/js/119.beb4913a.js"><link rel="prefetch" href="/es4x/assets/js/12.1f7f2bd3.js"><link rel="prefetch" href="/es4x/assets/js/120.f13c267c.js"><link rel="prefetch" href="/es4x/assets/js/121.197dd995.js"><link rel="prefetch" href="/es4x/assets/js/122.b44c98b3.js"><link rel="prefetch" href="/es4x/assets/js/123.4586e425.js"><link rel="prefetch" href="/es4x/assets/js/124.d00a049e.js"><link rel="prefetch" href="/es4x/assets/js/125.1f32b7a7.js"><link rel="prefetch" href="/es4x/assets/js/126.e0bbd98d.js"><link rel="prefetch" href="/es4x/assets/js/127.fc93d280.js"><link rel="prefetch" href="/es4x/assets/js/128.98e5a4cc.js"><link rel="prefetch" href="/es4x/assets/js/129.fb3a3f88.js"><link rel="prefetch" href="/es4x/assets/js/13.1a7b9986.js"><link rel="prefetch" href="/es4x/assets/js/130.5cd4d89d.js"><link rel="prefetch" href="/es4x/assets/js/131.6ac7fa33.js"><link rel="prefetch" href="/es4x/assets/js/132.c8ad9a79.js"><link rel="prefetch" href="/es4x/assets/js/133.90881bb4.js"><link rel="prefetch" href="/es4x/assets/js/134.f7596c11.js"><link rel="prefetch" href="/es4x/assets/js/135.f8db6a39.js"><link rel="prefetch" href="/es4x/assets/js/136.bd2de92d.js"><link rel="prefetch" href="/es4x/assets/js/137.eabfa5f6.js"><link rel="prefetch" href="/es4x/assets/js/138.c19e308b.js"><link rel="prefetch" href="/es4x/assets/js/139.e437bff1.js"><link rel="prefetch" href="/es4x/assets/js/14.b66836b1.js"><link rel="prefetch" href="/es4x/assets/js/140.8d09b641.js"><link rel="prefetch" href="/es4x/assets/js/141.4d46fb84.js"><link rel="prefetch" href="/es4x/assets/js/142.99040345.js"><link rel="prefetch" href="/es4x/assets/js/143.7d902150.js"><link rel="prefetch" href="/es4x/assets/js/144.0543ff8f.js"><link rel="prefetch" href="/es4x/assets/js/145.6a2886f8.js"><link rel="prefetch" href="/es4x/assets/js/146.01466845.js"><link rel="prefetch" href="/es4x/assets/js/147.42e445c8.js"><link rel="prefetch" href="/es4x/assets/js/148.e677edea.js"><link rel="prefetch" href="/es4x/assets/js/149.50959280.js"><link rel="prefetch" href="/es4x/assets/js/15.bd087613.js"><link rel="prefetch" href="/es4x/assets/js/150.eabb62e5.js"><link rel="prefetch" href="/es4x/assets/js/151.a6f046ed.js"><link rel="prefetch" href="/es4x/assets/js/152.78e21db3.js"><link rel="prefetch" href="/es4x/assets/js/153.eef01fd9.js"><link rel="prefetch" href="/es4x/assets/js/154.f5b66c27.js"><link rel="prefetch" href="/es4x/assets/js/155.f5cbe3be.js"><link rel="prefetch" href="/es4x/assets/js/156.3fdf30f1.js"><link rel="prefetch" href="/es4x/assets/js/157.aeebd96f.js"><link rel="prefetch" href="/es4x/assets/js/158.bec405e9.js"><link rel="prefetch" href="/es4x/assets/js/159.f81bc2fa.js"><link rel="prefetch" href="/es4x/assets/js/16.a392a655.js"><link rel="prefetch" href="/es4x/assets/js/160.611a570e.js"><link rel="prefetch" href="/es4x/assets/js/161.400aed1c.js"><link rel="prefetch" href="/es4x/assets/js/162.60fdd908.js"><link rel="prefetch" href="/es4x/assets/js/163.841834be.js"><link rel="prefetch" href="/es4x/assets/js/164.368aca3b.js"><link rel="prefetch" href="/es4x/assets/js/165.6ed202c4.js"><link rel="prefetch" href="/es4x/assets/js/166.cd243b01.js"><link rel="prefetch" href="/es4x/assets/js/167.74493e23.js"><link rel="prefetch" href="/es4x/assets/js/168.26ae4c80.js"><link rel="prefetch" href="/es4x/assets/js/169.adffbf41.js"><link rel="prefetch" href="/es4x/assets/js/17.f58ddc3f.js"><link rel="prefetch" href="/es4x/assets/js/170.ec119bad.js"><link rel="prefetch" href="/es4x/assets/js/171.8ce41d74.js"><link rel="prefetch" href="/es4x/assets/js/172.c0640f4c.js"><link rel="prefetch" href="/es4x/assets/js/18.d0e693e8.js"><link rel="prefetch" href="/es4x/assets/js/19.2cfa07bf.js"><link rel="prefetch" href="/es4x/assets/js/20.83c2c4e9.js"><link rel="prefetch" href="/es4x/assets/js/21.bfb22c95.js"><link rel="prefetch" href="/es4x/assets/js/22.80259bfc.js"><link rel="prefetch" href="/es4x/assets/js/23.d3df90af.js"><link rel="prefetch" href="/es4x/assets/js/24.47cf75e1.js"><link rel="prefetch" href="/es4x/assets/js/25.af00dd42.js"><link rel="prefetch" href="/es4x/assets/js/26.2c5dd1f3.js"><link rel="prefetch" href="/es4x/assets/js/27.313c4d9d.js"><link rel="prefetch" href="/es4x/assets/js/28.c3fa5296.js"><link rel="prefetch" href="/es4x/assets/js/29.bc391437.js"><link rel="prefetch" href="/es4x/assets/js/3.4d2250de.js"><link rel="prefetch" href="/es4x/assets/js/30.ab72b827.js"><link rel="prefetch" href="/es4x/assets/js/31.360cf0c4.js"><link rel="prefetch" href="/es4x/assets/js/32.a454f02e.js"><link rel="prefetch" href="/es4x/assets/js/33.9072e3dc.js"><link rel="prefetch" href="/es4x/assets/js/34.2cd817f7.js"><link rel="prefetch" href="/es4x/assets/js/35.1499c4b4.js"><link rel="prefetch" href="/es4x/assets/js/36.b24867f2.js"><link rel="prefetch" href="/es4x/assets/js/37.8a1d9476.js"><link rel="prefetch" href="/es4x/assets/js/38.1caa3e15.js"><link rel="prefetch" href="/es4x/assets/js/39.ab25bad3.js"><link rel="prefetch" href="/es4x/assets/js/4.2410671b.js"><link rel="prefetch" href="/es4x/assets/js/40.13850330.js"><link rel="prefetch" href="/es4x/assets/js/41.1f30e160.js"><link rel="prefetch" href="/es4x/assets/js/42.f65b46db.js"><link rel="prefetch" href="/es4x/assets/js/43.86bd3898.js"><link rel="prefetch" href="/es4x/assets/js/44.25aede52.js"><link rel="prefetch" href="/es4x/assets/js/45.fbb6033a.js"><link rel="prefetch" href="/es4x/assets/js/46.13bb4f87.js"><link rel="prefetch" href="/es4x/assets/js/47.01a4d32b.js"><link rel="prefetch" href="/es4x/assets/js/48.4ef5e818.js"><link rel="prefetch" href="/es4x/assets/js/49.896ad60c.js"><link rel="prefetch" href="/es4x/assets/js/5.f2fd7a11.js"><link rel="prefetch" href="/es4x/assets/js/50.54a8010f.js"><link rel="prefetch" href="/es4x/assets/js/51.26142f55.js"><link rel="prefetch" href="/es4x/assets/js/52.b132a309.js"><link rel="prefetch" href="/es4x/assets/js/53.dc983026.js"><link rel="prefetch" href="/es4x/assets/js/54.3ae4a5b7.js"><link rel="prefetch" href="/es4x/assets/js/55.4b3e9675.js"><link rel="prefetch" href="/es4x/assets/js/56.2cc05aac.js"><link rel="prefetch" href="/es4x/assets/js/57.f8c33e2c.js"><link rel="prefetch" href="/es4x/assets/js/58.7b7e6201.js"><link rel="prefetch" href="/es4x/assets/js/59.beab06b9.js"><link rel="prefetch" href="/es4x/assets/js/6.7eb69711.js"><link rel="prefetch" href="/es4x/assets/js/60.ad528007.js"><link rel="prefetch" href="/es4x/assets/js/61.7462fe68.js"><link rel="prefetch" href="/es4x/assets/js/62.c7245534.js"><link rel="prefetch" href="/es4x/assets/js/63.91dfc6d8.js"><link rel="prefetch" href="/es4x/assets/js/64.a9a5d5d7.js"><link rel="prefetch" href="/es4x/assets/js/65.bd897469.js"><link rel="prefetch" href="/es4x/assets/js/66.b6b4afbd.js"><link rel="prefetch" href="/es4x/assets/js/67.b882907b.js"><link rel="prefetch" href="/es4x/assets/js/68.32bb2628.js"><link rel="prefetch" href="/es4x/assets/js/69.6e7fa7f2.js"><link rel="prefetch" href="/es4x/assets/js/7.e56c8e30.js"><link rel="prefetch" href="/es4x/assets/js/70.9fa2afb4.js"><link rel="prefetch" href="/es4x/assets/js/71.228413c9.js"><link rel="prefetch" href="/es4x/assets/js/72.4a3f3614.js"><link rel="prefetch" href="/es4x/assets/js/73.abf3fc90.js"><link rel="prefetch" href="/es4x/assets/js/74.13ff27d1.js"><link rel="prefetch" href="/es4x/assets/js/75.96ffdfe8.js"><link rel="prefetch" href="/es4x/assets/js/76.ef6180eb.js"><link rel="prefetch" href="/es4x/assets/js/78.a4cb55ca.js"><link rel="prefetch" href="/es4x/assets/js/79.2a3d8a2f.js"><link rel="prefetch" href="/es4x/assets/js/8.3d81d937.js"><link rel="prefetch" href="/es4x/assets/js/80.80c9d719.js"><link rel="prefetch" href="/es4x/assets/js/81.7be9486c.js"><link rel="prefetch" href="/es4x/assets/js/82.f30975e2.js"><link rel="prefetch" href="/es4x/assets/js/83.2e22eebd.js"><link rel="prefetch" href="/es4x/assets/js/84.60798b2c.js"><link rel="prefetch" href="/es4x/assets/js/85.a6928290.js"><link rel="prefetch" href="/es4x/assets/js/86.0be2ea51.js"><link rel="prefetch" href="/es4x/assets/js/87.ad51e710.js"><link rel="prefetch" href="/es4x/assets/js/88.81d5d220.js"><link rel="prefetch" href="/es4x/assets/js/89.aac46f66.js"><link rel="prefetch" href="/es4x/assets/js/9.2edb4e2b.js"><link rel="prefetch" href="/es4x/assets/js/90.4a4fd3dc.js"><link rel="prefetch" href="/es4x/assets/js/91.065cc9a5.js"><link rel="prefetch" href="/es4x/assets/js/92.055a4ecc.js"><link rel="prefetch" href="/es4x/assets/js/93.71b53f02.js"><link rel="prefetch" href="/es4x/assets/js/94.b096f725.js"><link rel="prefetch" href="/es4x/assets/js/95.af24f6b1.js"><link rel="prefetch" href="/es4x/assets/js/96.38f15cba.js"><link rel="prefetch" href="/es4x/assets/js/97.c53fc06f.js"><link rel="prefetch" href="/es4x/assets/js/98.3426a32c.js"><link rel="prefetch" href="/es4x/assets/js/99.fa951d15.js">
    <link rel="stylesheet" href="/es4x/assets/css/0.styles.57be2129.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/es4x/" class="home-link router-link-active"><!----> <span class="site-name">ES for Eclipse Vert.x</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/es4x/get-started/" class="nav-link">
  Get started
</a></div><div class="nav-item"><a href="/es4x/advanced/" class="nav-link">
  Advanced
</a></div><div class="nav-item"><a href="/es4x/manual/" class="nav-link router-link-active">
  Manual
</a></div><div class="nav-item"><a href="/es4x/api/" class="nav-link">
  APIs
</a></div><div class="nav-item"><a href="https://github.com/reactiverse/es4x/blob/master/CHANGELOG.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Changelog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/es4x/manual/@vertx/core/net.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li><li class="dropdown-item"><!----> <a href="/es4x/zh/" class="nav-link">
  简体中文
</a></li><li class="dropdown-item"><!----> <a href="/es4x/pt/" class="nav-link">
  Português
</a></li></ul></div></div> <a href="https://github.com/reactiverse/es4x" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/es4x/get-started/" class="nav-link">
  Get started
</a></div><div class="nav-item"><a href="/es4x/advanced/" class="nav-link">
  Advanced
</a></div><div class="nav-item"><a href="/es4x/manual/" class="nav-link router-link-active">
  Manual
</a></div><div class="nav-item"><a href="/es4x/api/" class="nav-link">
  APIs
</a></div><div class="nav-item"><a href="https://github.com/reactiverse/es4x/blob/master/CHANGELOG.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Changelog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/es4x/manual/@vertx/core/net.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li><li class="dropdown-item"><!----> <a href="/es4x/zh/" class="nav-link">
  简体中文
</a></li><li class="dropdown-item"><!----> <a href="/es4x/pt/" class="nav-link">
  Português
</a></li></ul></div></div> <a href="https://github.com/reactiverse/es4x" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Manuals</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/es4x/manual/" aria-current="page" class="sidebar-link">API Reference Manuals</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="writing-tcp-servers-and-clients"><a href="#writing-tcp-servers-and-clients" class="header-anchor">#</a> Writing TCP servers and clients</h1> <p>Vert.x allows you to easily write non blocking TCP clients and servers.</p> <h2 id="creating-a-tcp-server"><a href="#creating-a-tcp-server" class="header-anchor">#</a> Creating a TCP server</h2> <p>The simplest way to create a TCP server, using all default options is as
follows:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> server <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">createNetServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="configuring-a-tcp-server"><a href="#configuring-a-tcp-server" class="header-anchor">#</a> Configuring a TCP server</h2> <p>If you don’t want the default, a server can be configured by passing in
a <code>NetServerOptions</code> instance when creating it:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NetServerOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setPort</span><span class="token punctuation">(</span><span class="token number">4321</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> server <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">createNetServer</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="start-the-server-listening"><a href="#start-the-server-listening" class="header-anchor">#</a> Start the Server Listening</h2> <p>To tell the server to listen for incoming requests you use one of the
<code>listen</code> alternatives.</p> <p>To tell the server to listen at the host and port as specified in the
options:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> server <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">createNetServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Or to specify the host and port in the call to listen, ignoring what is
configured in the options:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> server <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">createNetServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">1234</span><span class="token punctuation">,</span> <span class="token string">&quot;localhost&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The default host is <code>0.0.0.0</code> which means 'listen on all available
addresses' and the default port is <code>0</code>, which is a special value that
instructs the server to find a random unused local port and use that.</p> <p>The actual bind is asynchronous so the server might not actually be
listening until some time <strong>after</strong> the call to listen has returned.</p> <p>If you want to be notified when the server is actually listening you can
provide a handler to the <code>listen</code> call. For example:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> server <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">createNetServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">1234</span><span class="token punctuation">,</span> <span class="token string">&quot;localhost&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token function">succeeded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Server is now listening!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Failed to bind!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="listening-on-a-random-port"><a href="#listening-on-a-random-port" class="header-anchor">#</a> Listening on a random port</h2> <p>If <code>0</code> is used as the listening port, the server will find an unused
random port to listen on.</p> <p>To find out the real port the server is listening on you can call
<code>actualPort</code>.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> server <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">createNetServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&quot;localhost&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token function">succeeded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Server is now listening on actual port: &quot;</span> <span class="token operator">+</span> server<span class="token punctuation">.</span><span class="token function">actualPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Failed to bind!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="getting-notified-of-incoming-connections"><a href="#getting-notified-of-incoming-connections" class="header-anchor">#</a> Getting notified of incoming connections</h2> <p>To be notified when a connection is made you need to set a
<code>connectHandler</code>:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> server <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">createNetServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
server<span class="token punctuation">.</span><span class="token function">connectHandler</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">socket</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// Handle the connection in here</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>When a connection is made the handler will be called with an instance of
<code>NetSocket</code>.</p> <p>This is a socket-like interface to the actual connection, and allows you
to read and write data as well as do various other things like close the
socket.</p> <h2 id="reading-data-from-the-socket"><a href="#reading-data-from-the-socket" class="header-anchor">#</a> Reading data from the socket</h2> <p>To read data from the socket you set the <code>handler</code> on the socket.</p> <p>This handler will be called with an instance of <code>Buffer</code> every time data
is received on the socket.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> server <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">createNetServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
server<span class="token punctuation">.</span><span class="token function">connectHandler</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">socket</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  socket<span class="token punctuation">.</span><span class="token function">handler</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">buffer</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;I received some bytes: &quot;</span> <span class="token operator">+</span> buffer<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="writing-data-to-a-socket"><a href="#writing-data-to-a-socket" class="header-anchor">#</a> Writing data to a socket</h2> <p>You write to a socket using one of <code>write</code>.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Buffer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@vertx/core&quot;</span>

<span class="token comment">// Write a buffer</span>
<span class="token keyword">let</span> buffer <span class="token operator">=</span> Buffer<span class="token punctuation">.</span><span class="token function">buffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">appendFloat</span><span class="token punctuation">(</span><span class="token number">12.34</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">appendInt</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
socket<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>buffer<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Write a string in UTF-8 encoding</span>
socket<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;some data&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Write a string using the specified encoding</span>
socket<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;some data&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;UTF-16&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Write operations are asynchronous and may not occur until some time
after the call to write has returned.</p> <h2 id="closed-handler"><a href="#closed-handler" class="header-anchor">#</a> Closed handler</h2> <p>If you want to be notified when a socket is closed, you can set a
<code>closeHandler</code> on it:</p> <div class="language-js extra-class"><pre class="language-js"><code>socket<span class="token punctuation">.</span><span class="token function">closeHandler</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">v</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;The socket has been closed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="handling-exceptions"><a href="#handling-exceptions" class="header-anchor">#</a> Handling exceptions</h2> <p>You can set an <code>exceptionHandler</code> to receive any exceptions that happen
on the socket.</p> <p>You can set an <code>exceptionHandler</code> to receive any exceptions that happens
before the connection is passed to the <code>connectHandler</code> , e.g during the
TLS handshake.</p> <h2 id="event-bus-write-handler"><a href="#event-bus-write-handler" class="header-anchor">#</a> Event bus write handler</h2> <p>Every socket automatically registers a handler on the event bus, and
when any buffers are received in this handler, it writes them to itself.
Those are local subscriptions not routed on the cluster.</p> <p>This enables you to write data to a socket which is potentially in a
completely different verticle by sending the buffer to the address of
that handler.</p> <p>The address of the handler is given by <code>writeHandlerID</code></p> <h2 id="local-and-remote-addresses"><a href="#local-and-remote-addresses" class="header-anchor">#</a> Local and remote addresses</h2> <p>The local address of a <code>NetSocket</code> can be retrieved using
<code>localAddress</code>.</p> <p>The remote address, (i.e. the address of the other end of the
connection) of a <code>NetSocket</code> can be retrieved using <code>remoteAddress</code>.</p> <h2 id="sending-files-or-resources-from-the-classpath"><a href="#sending-files-or-resources-from-the-classpath" class="header-anchor">#</a> Sending files or resources from the classpath</h2> <p>Files and classpath resources can be written to the socket directly
using <code>sendFile</code>. This can be a very efficient way to send files, as it
can be handled by the OS kernel directly where supported by the
operating system.</p> <p>Please see the chapter about <a href="#classpath">serving files from the
classpath</a> for restrictions of the classpath resolution or
disabling it.</p> <div class="language-js extra-class"><pre class="language-js"><code>socket<span class="token punctuation">.</span><span class="token function">sendFile</span><span class="token punctuation">(</span><span class="token string">&quot;myfile.dat&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="streaming-sockets"><a href="#streaming-sockets" class="header-anchor">#</a> Streaming sockets</h2> <p>Instances of <code>NetSocket</code> are also <code>ReadStream</code> and <code>WriteStream</code>
instances so they can be used to pipe data to or from other read and
write streams.</p> <p>See the chapter on <a href="#streams">streams</a> for more information.</p> <h2 id="upgrading-connections-to-ssl-tls"><a href="#upgrading-connections-to-ssl-tls" class="header-anchor">#</a> Upgrading connections to SSL/TLS</h2> <p>A non SSL/TLS connection can be upgraded to SSL/TLS using
<code>upgradeToSsl</code>.</p> <p>The server or client must be configured for SSL/TLS for this to work
correctly. Please see the <a href="#ssl">chapter on SSL/TLS</a> for more
information.</p> <h2 id="closing-a-tcp-server"><a href="#closing-a-tcp-server" class="header-anchor">#</a> Closing a TCP Server</h2> <p>Call <code>close</code> to close the server. Closing the server closes any open
connections and releases all server resources.</p> <p>The close is actually asynchronous and might not complete until some
time after the call has returned. If you want to be notified when the
actual close has completed then you can pass in a handler.</p> <p>This handler will then be called when the close has fully completed.</p> <div class="language-js extra-class"><pre class="language-js"><code>server<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token function">succeeded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Server is now closed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;close failed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="automatic-clean-up-in-verticles"><a href="#automatic-clean-up-in-verticles" class="header-anchor">#</a> Automatic clean-up in verticles</h2> <p>If you’re creating TCP servers and clients from inside verticles, those
servers and clients will be automatically closed when the verticle is
undeployed.</p> <h2 id="scaling-sharing-tcp-servers"><a href="#scaling-sharing-tcp-servers" class="header-anchor">#</a> Scaling - sharing TCP servers</h2> <p>The handlers of any TCP server are always executed on the same event
loop thread.</p> <p>This means that if you are running on a server with a lot of cores, and
you only have this one instance deployed then you will have at most one
core utilised on your server.</p> <p>In order to utilise more cores of your server you will need to deploy
more instances of the server.</p> <p>You can instantiate more instances programmatically in your code:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Create a few instances so we can utilise cores</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> server <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">createNetServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  server<span class="token punctuation">.</span><span class="token function">connectHandler</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">socket</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    socket<span class="token punctuation">.</span><span class="token function">handler</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">buffer</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// Just echo back the data</span>
      socket<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>buffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">1234</span><span class="token punctuation">,</span> <span class="token string">&quot;localhost&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>or, if you are using verticles you can simply deploy more instances of
your server verticle by using the <code>-instances</code> option on the command
line:</p> <p>vertx run com.mycompany.MyVerticle -instances 10</p> <p>or when programmatically deploying your verticle</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DeploymentOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setInstances</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
vertx<span class="token punctuation">.</span><span class="token function">deployVerticle</span><span class="token punctuation">(</span><span class="token string">&quot;com.mycompany.MyVerticle&quot;</span><span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Once you do this you will find the echo server works functionally
identically to before, but all your cores on your server can be utilised
and more work can be handled.</p> <p>At this point you might be asking yourself <strong>'How can you have more than
one server listening on the same host and port? Surely you will get port
conflicts as soon as you try and deploy more than one instance?'</strong></p> <p><em>Vert.x does a little magic here.*</em></p> <p>When you deploy another server on the same host and port as an existing
server it doesn’t actually try and create a new server listening on the
same host/port.</p> <p>Instead it internally maintains just a single server, and, as incoming
connections arrive it distributes them in a round-robin fashion to any
of the connect handlers.</p> <p>Consequently Vert.x TCP servers can scale over available cores while
each instance remains single threaded.</p> <h2 id="creating-a-tcp-client"><a href="#creating-a-tcp-client" class="header-anchor">#</a> Creating a TCP client</h2> <p>The simplest way to create a TCP client, using all default options is as
follows:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> client <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">createNetClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="configuring-a-tcp-client"><a href="#configuring-a-tcp-client" class="header-anchor">#</a> Configuring a TCP client</h2> <p>If you don’t want the default, a client can be configured by passing in
a <code>NetClientOptions</code> instance when creating it:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NetClientOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setConnectTimeout</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> client <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">createNetClient</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="making-connections"><a href="#making-connections" class="header-anchor">#</a> Making connections</h2> <p>To make a connection to a server you use <code>connect</code>, specifying the port
and host of the server and a handler that will be called with a result
containing the <code>NetSocket</code> when connection is successful or with a
failure if connection failed.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NetClientOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setConnectTimeout</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> client <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">createNetClient</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
client<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token number">4321</span><span class="token punctuation">,</span> <span class="token string">&quot;localhost&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token function">succeeded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Connected!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> socket <span class="token operator">=</span> res<span class="token punctuation">.</span><span class="token function">result</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Failed to connect: &quot;</span> <span class="token operator">+</span> res<span class="token punctuation">.</span><span class="token function">cause</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="configuring-connection-attempts"><a href="#configuring-connection-attempts" class="header-anchor">#</a> Configuring connection attempts</h2> <p>A client can be configured to automatically retry connecting to the
server in the event that it cannot connect. This is configured with
<code>setReconnectInterval</code> and <code>setReconnectAttempts</code>.</p> <blockquote><p><strong>Note</strong></p> <p>Currently Vert.x will not attempt to reconnect if a connection fails,
reconnect attempts and interval only apply to creating initial
connections.</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NetClientOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setReconnectAttempts</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setReconnectInterval</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> client <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">createNetClient</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>By default, multiple connection attempts are disabled.</p> <h2 id="logging-network-activity"><a href="#logging-network-activity" class="header-anchor">#</a> Logging network activity</h2> <p>For debugging purposes, network activity can be logged:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NetServerOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setLogActivity</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> server <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">createNetServer</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>for the client</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NetClientOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setLogActivity</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> client <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">createNetClient</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Network activity is logged by Netty with the <code>DEBUG</code> level and with the
<code>io.netty.handler.logging.LoggingHandler</code> name. When using network
activity logging there are a few things to keep in mind:</p> <ul><li><p>logging is not performed by Vert.x logging but by Netty</p></li> <li><p>this is <strong>not</strong> a production feature</p></li></ul> <p>You should read the <a href="#netty-logging">???</a> section.</p> <h2 id="configuring-servers-and-clients-to-work-with-ssl-tls"><a href="#configuring-servers-and-clients-to-work-with-ssl-tls" class="header-anchor">#</a> Configuring servers and clients to work with SSL/TLS</h2> <p>TCP clients and servers can be configured to use <a href="http://en.wikipedia.org/wiki/Transport_Layer_Security" target="_blank" rel="noopener noreferrer">Transport Layer
Security<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> -
earlier versions of TLS were known as SSL.</p> <p>The APIs of the servers and clients are identical whether or not SSL/TLS
is used, and it’s enabled by configuring the <code>NetClientOptions</code> or
<code>NetServerOptions</code> instances used to create the servers or clients.</p> <h3 id="enabling-ssl-tls-on-the-server"><a href="#enabling-ssl-tls-on-the-server" class="header-anchor">#</a> Enabling SSL/TLS on the server</h3> <p>SSL/TLS is enabled with <code>ssl</code>.</p> <p>By default it is disabled.</p> <h3 id="specifying-key-certificate-for-the-server"><a href="#specifying-key-certificate-for-the-server" class="header-anchor">#</a> Specifying key/certificate for the server</h3> <p>SSL/TLS servers usually provide certificates to clients in order verify
their identity to clients.</p> <p>Certificates/keys can be configured for servers in several ways:</p> <p>The first method is by specifying the location of a Java key-store which
contains the certificate and private key.</p> <p>Java key stores can be managed with the
<a href="http://docs.oracle.com/javase/6/docs/technotes/tools/solaris/keytool.html" target="_blank" rel="noopener noreferrer">keytool<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
utility which ships with the JDK.</p> <p>The password for the key store should also be provided:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NetServerOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setSsl</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setKeyStoreOptions</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">JksOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setPath</span><span class="token punctuation">(</span><span class="token string">&quot;/path/to/your/server-keystore.jks&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">&quot;password-of-your-keystore&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> server <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">createNetServer</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Alternatively you can read the key store yourself as a buffer and
provide that directly:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> myKeyStoreAsABuffer <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">fileSystem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">readFileBlocking</span><span class="token punctuation">(</span><span class="token string">&quot;/path/to/your/server-keystore.jks&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> jksOptions <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JksOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span>myKeyStoreAsABuffer<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">&quot;password-of-your-keystore&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NetServerOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setSsl</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setKeyStoreOptions</span><span class="token punctuation">(</span>jksOptions<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> server <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">createNetServer</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Key/certificate in PKCS#12 format
(<a href="http://en.wikipedia.org/wiki/PKCS_12" target="_blank" rel="noopener noreferrer">http://en.wikipedia.org/wiki/PKCS_12<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>), usually with the <code>.pfx</code> or the
<code>.p12</code> extension can also be loaded in a similar fashion than JKS key
stores:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NetServerOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setSsl</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setPfxKeyCertOptions</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PfxOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setPath</span><span class="token punctuation">(</span><span class="token string">&quot;/path/to/your/server-keystore.pfx&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">&quot;password-of-your-keystore&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> server <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">createNetServer</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Buffer configuration is also supported:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> myKeyStoreAsABuffer <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">fileSystem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">readFileBlocking</span><span class="token punctuation">(</span><span class="token string">&quot;/path/to/your/server-keystore.pfx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> pfxOptions <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PfxOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span>myKeyStoreAsABuffer<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">&quot;password-of-your-keystore&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NetServerOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setSsl</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setPfxKeyCertOptions</span><span class="token punctuation">(</span>pfxOptions<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> server <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">createNetServer</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Another way of providing server private key and certificate separately
using <code>.pem</code> files.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NetServerOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setSsl</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setPemKeyCertOptions</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PemKeyCertOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setKeyPath</span><span class="token punctuation">(</span><span class="token string">&quot;/path/to/your/server-key.pem&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setCertPath</span><span class="token punctuation">(</span><span class="token string">&quot;/path/to/your/server-cert.pem&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> server <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">createNetServer</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Buffer configuration is also supported:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> myKeyAsABuffer <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">fileSystem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">readFileBlocking</span><span class="token punctuation">(</span><span class="token string">&quot;/path/to/your/server-key.pem&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> myCertAsABuffer <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">fileSystem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">readFileBlocking</span><span class="token punctuation">(</span><span class="token string">&quot;/path/to/your/server-cert.pem&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> pemOptions <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PemKeyCertOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setKeyValue</span><span class="token punctuation">(</span>myKeyAsABuffer<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setCertValue</span><span class="token punctuation">(</span>myCertAsABuffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NetServerOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setSsl</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setPemKeyCertOptions</span><span class="token punctuation">(</span>pemOptions<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> server <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">createNetServer</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Vert.x supports reading of unencrypted RSA and/or ECC based private keys
from PKCS8 PEM files. RSA based private keys can also be read from PKCS1
PEM files. X.509 certificates can be read from PEM files containing a
textual encoding of the certificate as defined by <a href="https://tools.ietf.org/html/rfc7468#section-5" target="_blank" rel="noopener noreferrer">RFC 7468,
Section 5<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <blockquote><p><strong>Warning</strong></p> <p>Keep in mind that the keys contained in an unencrypted PKCS8 or a
PKCS1 PEM file can be extracted by anybody who can read the file.
Thus, make sure to put proper access restrictions on such PEM files in
order to prevent misuse.</p></blockquote> <h3 id="specifying-trust-for-the-server"><a href="#specifying-trust-for-the-server" class="header-anchor">#</a> Specifying trust for the server</h3> <p>SSL/TLS servers can use a certificate authority in order to verify the
identity of the clients.</p> <p>Certificate authorities can be configured for servers in several ways:</p> <p>Java trust stores can be managed with the
<a href="http://docs.oracle.com/javase/6/docs/technotes/tools/solaris/keytool.html" target="_blank" rel="noopener noreferrer">keytool<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
utility which ships with the JDK.</p> <p>The password for the trust store should also be provided:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NetServerOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setSsl</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setClientAuth</span><span class="token punctuation">(</span><span class="token string">&quot;REQUIRED&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setTrustStoreOptions</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">JksOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setPath</span><span class="token punctuation">(</span><span class="token string">&quot;/path/to/your/truststore.jks&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">&quot;password-of-your-truststore&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> server <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">createNetServer</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Alternatively you can read the trust store yourself as a buffer and
provide that directly:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> myTrustStoreAsABuffer <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">fileSystem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">readFileBlocking</span><span class="token punctuation">(</span><span class="token string">&quot;/path/to/your/truststore.jks&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NetServerOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setSsl</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setClientAuth</span><span class="token punctuation">(</span><span class="token string">&quot;REQUIRED&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setTrustStoreOptions</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">JksOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span>myTrustStoreAsABuffer<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">&quot;password-of-your-truststore&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> server <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">createNetServer</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Certificate authority in PKCS#12 format
(<a href="http://en.wikipedia.org/wiki/PKCS_12" target="_blank" rel="noopener noreferrer">http://en.wikipedia.org/wiki/PKCS_12<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>), usually with the <code>.pfx</code> or the
<code>.p12</code> extension can also be loaded in a similar fashion than JKS trust
stores:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NetServerOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setSsl</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setClientAuth</span><span class="token punctuation">(</span><span class="token string">&quot;REQUIRED&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setPfxTrustOptions</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PfxOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setPath</span><span class="token punctuation">(</span><span class="token string">&quot;/path/to/your/truststore.pfx&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">&quot;password-of-your-truststore&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> server <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">createNetServer</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Buffer configuration is also supported:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> myTrustStoreAsABuffer <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">fileSystem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">readFileBlocking</span><span class="token punctuation">(</span><span class="token string">&quot;/path/to/your/truststore.pfx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NetServerOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setSsl</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setClientAuth</span><span class="token punctuation">(</span><span class="token string">&quot;REQUIRED&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setPfxTrustOptions</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PfxOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span>myTrustStoreAsABuffer<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">&quot;password-of-your-truststore&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> server <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">createNetServer</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Another way of providing server certificate authority using a list
<code>.pem</code> files.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NetServerOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setSsl</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setClientAuth</span><span class="token punctuation">(</span><span class="token string">&quot;REQUIRED&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setPemTrustOptions</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PemTrustOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setCertPaths</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;/path/to/your/server-ca.pem&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> server <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">createNetServer</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Buffer configuration is also supported:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> myCaAsABuffer <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">fileSystem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">readFileBlocking</span><span class="token punctuation">(</span><span class="token string">&quot;/path/to/your/server-ca.pfx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NetServerOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setSsl</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setClientAuth</span><span class="token punctuation">(</span><span class="token string">&quot;REQUIRED&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setPemTrustOptions</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PemTrustOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setCertValues</span><span class="token punctuation">(</span><span class="token punctuation">[</span>myCaAsABuffer<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> server <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">createNetServer</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="enabling-ssl-tls-on-the-client"><a href="#enabling-ssl-tls-on-the-client" class="header-anchor">#</a> Enabling SSL/TLS on the client</h3> <p>Net Clients can also be easily configured to use SSL. They have the
exact same API when using SSL as when using standard sockets.</p> <p>To enable SSL on a NetClient the function setSSL(true) is called.</p> <h3 id="client-trust-configuration"><a href="#client-trust-configuration" class="header-anchor">#</a> Client trust configuration</h3> <p>If the <code>trustALl</code> is set to true on the client, then the client will
trust all server certificates. The connection will still be encrypted
but this mode is vulnerable to 'man in the middle' attacks. I.e. you
can’t be sure who you are connecting to. Use this with caution.
Default value is false.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NetClientOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setSsl</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setTrustAll</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> client <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">createNetClient</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>If <code>trustAll</code> is not set then a client trust store must be configured
and should contain the certificates of the servers that the client
trusts.</p> <p>By default, host verification is disabled on the client. To enable host
verification, set the algorithm to use on your client (only HTTPS and
LDAPS is currently supported):</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NetClientOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setSsl</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setHostnameVerificationAlgorithm</span><span class="token punctuation">(</span><span class="token string">&quot;HTTPS&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> client <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">createNetClient</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Likewise server configuration, the client trust can be configured in
several ways:</p> <p>The first method is by specifying the location of a Java trust-store
which contains the certificate authority.</p> <p>It is just a standard Java key store, the same as the key stores on the
server side. The client trust store location is set by using the
function <code>path</code> on the <code>jks options</code>. If a server presents a certificate
during connection which is not in the client trust store, the connection
attempt will not succeed.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NetClientOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setSsl</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setTrustStoreOptions</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">JksOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setPath</span><span class="token punctuation">(</span><span class="token string">&quot;/path/to/your/truststore.jks&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">&quot;password-of-your-truststore&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> client <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">createNetClient</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Buffer configuration is also supported:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> myTrustStoreAsABuffer <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">fileSystem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">readFileBlocking</span><span class="token punctuation">(</span><span class="token string">&quot;/path/to/your/truststore.jks&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NetClientOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setSsl</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setTrustStoreOptions</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">JksOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span>myTrustStoreAsABuffer<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">&quot;password-of-your-truststore&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> client <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">createNetClient</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Certificate authority in PKCS#12 format
(<a href="http://en.wikipedia.org/wiki/PKCS_12" target="_blank" rel="noopener noreferrer">http://en.wikipedia.org/wiki/PKCS_12<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>), usually with the <code>.pfx</code> or the
<code>.p12</code> extension can also be loaded in a similar fashion than JKS trust
stores:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NetClientOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setSsl</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setPfxTrustOptions</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PfxOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setPath</span><span class="token punctuation">(</span><span class="token string">&quot;/path/to/your/truststore.pfx&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">&quot;password-of-your-truststore&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> client <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">createNetClient</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Buffer configuration is also supported:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> myTrustStoreAsABuffer <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">fileSystem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">readFileBlocking</span><span class="token punctuation">(</span><span class="token string">&quot;/path/to/your/truststore.pfx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NetClientOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setSsl</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setPfxTrustOptions</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PfxOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span>myTrustStoreAsABuffer<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">&quot;password-of-your-truststore&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> client <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">createNetClient</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Another way of providing server certificate authority using a list
<code>.pem</code> files.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NetClientOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setSsl</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setPemTrustOptions</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PemTrustOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setCertPaths</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;/path/to/your/ca-cert.pem&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> client <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">createNetClient</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Buffer configuration is also supported:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> myTrustStoreAsABuffer <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">fileSystem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">readFileBlocking</span><span class="token punctuation">(</span><span class="token string">&quot;/path/to/your/ca-cert.pem&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NetClientOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setSsl</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setPemTrustOptions</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PemTrustOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setCertValues</span><span class="token punctuation">(</span><span class="token punctuation">[</span>myTrustStoreAsABuffer<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> client <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">createNetClient</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="specifying-key-certificate-for-the-client"><a href="#specifying-key-certificate-for-the-client" class="header-anchor">#</a> Specifying key/certificate for the client</h3> <p>If the server requires client authentication then the client must
present its own certificate to the server when connecting. The client
can be configured in several ways:</p> <p>The first method is by specifying the location of a Java key-store which
contains the key and certificate. Again it’s just a regular Java key
store. The client keystore location is set by using the function <code>path</code>
on the <code>jks options</code>.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NetClientOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setSsl</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setKeyStoreOptions</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">JksOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setPath</span><span class="token punctuation">(</span><span class="token string">&quot;/path/to/your/client-keystore.jks&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">&quot;password-of-your-keystore&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> client <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">createNetClient</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Buffer configuration is also supported:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> myKeyStoreAsABuffer <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">fileSystem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">readFileBlocking</span><span class="token punctuation">(</span><span class="token string">&quot;/path/to/your/client-keystore.jks&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> jksOptions <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JksOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span>myKeyStoreAsABuffer<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">&quot;password-of-your-keystore&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NetClientOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setSsl</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setKeyStoreOptions</span><span class="token punctuation">(</span>jksOptions<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> client <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">createNetClient</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Key/certificate in PKCS#12 format
(<a href="http://en.wikipedia.org/wiki/PKCS_12" target="_blank" rel="noopener noreferrer">http://en.wikipedia.org/wiki/PKCS_12<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>), usually with the <code>.pfx</code> or the
<code>.p12</code> extension can also be loaded in a similar fashion than JKS key
stores:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NetClientOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setSsl</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setPfxKeyCertOptions</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PfxOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setPath</span><span class="token punctuation">(</span><span class="token string">&quot;/path/to/your/client-keystore.pfx&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">&quot;password-of-your-keystore&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> client <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">createNetClient</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Buffer configuration is also supported:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> myKeyStoreAsABuffer <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">fileSystem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">readFileBlocking</span><span class="token punctuation">(</span><span class="token string">&quot;/path/to/your/client-keystore.pfx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> pfxOptions <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PfxOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span>myKeyStoreAsABuffer<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">&quot;password-of-your-keystore&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NetClientOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setSsl</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setPfxKeyCertOptions</span><span class="token punctuation">(</span>pfxOptions<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> client <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">createNetClient</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Another way of providing server private key and certificate separately
using <code>.pem</code> files.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NetClientOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setSsl</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setPemKeyCertOptions</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PemKeyCertOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setKeyPath</span><span class="token punctuation">(</span><span class="token string">&quot;/path/to/your/client-key.pem&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setCertPath</span><span class="token punctuation">(</span><span class="token string">&quot;/path/to/your/client-cert.pem&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> client <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">createNetClient</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Buffer configuration is also supported:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> myKeyAsABuffer <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">fileSystem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">readFileBlocking</span><span class="token punctuation">(</span><span class="token string">&quot;/path/to/your/client-key.pem&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> myCertAsABuffer <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">fileSystem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">readFileBlocking</span><span class="token punctuation">(</span><span class="token string">&quot;/path/to/your/client-cert.pem&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> pemOptions <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PemKeyCertOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setKeyValue</span><span class="token punctuation">(</span>myKeyAsABuffer<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setCertValue</span><span class="token punctuation">(</span>myCertAsABuffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NetClientOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setSsl</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setPemKeyCertOptions</span><span class="token punctuation">(</span>pemOptions<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> client <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">createNetClient</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Keep in mind that pem configuration, the private key is not crypted.</p> <h3 id="self-signed-certificates-for-testing-and-development-purposes"><a href="#self-signed-certificates-for-testing-and-development-purposes" class="header-anchor">#</a> Self-signed certificates for testing and development purposes</h3> <blockquote><p><strong>Caution</strong></p> <p>Do not use this in production settings, and note that the generated
keys are very insecure.</p></blockquote> <p>It is very often the case that self-signed certificates are required, be
it for unit / integration tests or for running a development version of
an application.</p> <p><code>SelfSignedCertificate</code> can be used to provide self-signed PEM
certificate helpers and give <code>KeyCertOptions</code> and <code>TrustOptions</code>
configurations:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> SelfSignedCertificate <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@vertx/core&quot;</span>
<span class="token keyword">let</span> certificate <span class="token operator">=</span> SelfSignedCertificate<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> serverOptions <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NetServerOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setSsl</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setKeyCertOptions</span><span class="token punctuation">(</span>certificate<span class="token punctuation">.</span><span class="token function">keyCertOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setTrustOptions</span><span class="token punctuation">(</span>certificate<span class="token punctuation">.</span><span class="token function">trustOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> server <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">createNetServer</span><span class="token punctuation">(</span>serverOptions<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">connectHandler</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">socket</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  socket<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;Hello!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">1234</span><span class="token punctuation">,</span> <span class="token string">&quot;localhost&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> clientOptions <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NetClientOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setSsl</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setKeyCertOptions</span><span class="token punctuation">(</span>certificate<span class="token punctuation">.</span><span class="token function">keyCertOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setTrustOptions</span><span class="token punctuation">(</span>certificate<span class="token punctuation">.</span><span class="token function">trustOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> client <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">createNetClient</span><span class="token punctuation">(</span>clientOptions<span class="token punctuation">)</span><span class="token punctuation">;</span>
client<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token number">1234</span><span class="token punctuation">,</span> <span class="token string">&quot;localhost&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">ar</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>ar<span class="token punctuation">.</span><span class="token function">succeeded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ar<span class="token punctuation">.</span><span class="token function">result</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">handler</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">buffer</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>buffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;Woops: &quot;</span> <span class="token operator">+</span> ar<span class="token punctuation">.</span><span class="token function">cause</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The client can also be configured to trust all certificates:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> clientOptions <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NetClientOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setSsl</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setTrustAll</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Note that self-signed certificates also work for other TCP protocols
like HTTPS:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> SelfSignedCertificate <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@vertx/core&quot;</span>
<span class="token keyword">let</span> certificate <span class="token operator">=</span> SelfSignedCertificate<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

vertx<span class="token punctuation">.</span><span class="token function">createHttpServer</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HttpServerOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setSsl</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setKeyCertOptions</span><span class="token punctuation">(</span>certificate<span class="token punctuation">.</span><span class="token function">keyCertOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setTrustOptions</span><span class="token punctuation">(</span>certificate<span class="token punctuation">.</span><span class="token function">trustOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">requestHandler</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  req<span class="token punctuation">.</span><span class="token function">response</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">&quot;Hello!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">8080</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="revoking-certificate-authorities"><a href="#revoking-certificate-authorities" class="header-anchor">#</a> Revoking certificate authorities</h3> <p>Trust can be configured to use a certificate revocation list (CRL) for
revoked certificates that should no longer be trusted. The <code>crlPath</code>
configures the crl list to use:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NetClientOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setSsl</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setTrustStoreOptions</span><span class="token punctuation">(</span>trustOptions<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setCrlPaths</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;/path/to/your/crl.pem&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> client <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">createNetClient</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Buffer configuration is also supported:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> myCrlAsABuffer <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">fileSystem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">readFileBlocking</span><span class="token punctuation">(</span><span class="token string">&quot;/path/to/your/crl.pem&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NetClientOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setSsl</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setTrustStoreOptions</span><span class="token punctuation">(</span>trustOptions<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setCrlValues</span><span class="token punctuation">(</span><span class="token punctuation">[</span>myCrlAsABuffer<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> client <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">createNetClient</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="configuring-the-cipher-suite"><a href="#configuring-the-cipher-suite" class="header-anchor">#</a> Configuring the Cipher suite</h3> <p>By default, the TLS configuration will use the Cipher suite of the JVM
running Vert.x. This Cipher suite can be configured with a suite of
enabled ciphers:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NetServerOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setSsl</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setKeyStoreOptions</span><span class="token punctuation">(</span>keyStoreOptions<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setEnabledCipherSuites</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;ECDHE-RSA-AES128-GCM-SHA256&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ECDHE-ECDSA-AES128-GCM-SHA256&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ECDHE-RSA-AES256-GCM-SHA384&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;CDHE-ECDSA-AES256-GCM-SHA384&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> server <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">createNetServer</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Cipher suite can be specified on the <code>NetServerOptions</code> or
<code>NetClientOptions</code> configuration.</p> <h3 id="configuring-tls-protocol-versions"><a href="#configuring-tls-protocol-versions" class="header-anchor">#</a> Configuring TLS protocol versions</h3> <p>By default, the TLS configuration will use the following protocol
versions: SSLv2Hello, TLSv1, TLSv1.1 and TLSv1.2. Protocol versions can
be configured by explicitly adding enabled protocols:</p> <div class="language-js extra-class"><pre class="language-js"><code>Code not translatable
</code></pre></div><p>Protocol versions can be specified on the <code>NetServerOptions</code> or
<code>NetClientOptions</code> configuration.</p> <h3 id="ssl-engine"><a href="#ssl-engine" class="header-anchor">#</a> SSL engine</h3> <p>The engine implementation can be configured to use
<a href="https://www.openssl.org" target="_blank" rel="noopener noreferrer">OpenSSL<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> instead of the JDK implementation.
OpenSSL provides better performances and CPU usage than the JDK engine,
as well as JDK version independence.</p> <p>The engine options to use is</p> <ul><li><p>the <code>getSslEngineOptions</code> options when it is set</p></li> <li><p>otherwise <code>JdkSSLEngineOptions</code></p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Use JDK SSL engine</span>
<span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NetServerOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setSsl</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setKeyStoreOptions</span><span class="token punctuation">(</span>keyStoreOptions<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Use JDK SSL engine explicitly</span>
options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NetServerOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setSsl</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setKeyStoreOptions</span><span class="token punctuation">(</span>keyStoreOptions<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setJdkSslEngineOptions</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">JdkSSLEngineOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Use OpenSSL engine</span>
options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NetServerOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setSsl</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setKeyStoreOptions</span><span class="token punctuation">(</span>keyStoreOptions<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setOpenSslEngineOptions</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">OpenSSLEngineOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="server-name-indication-sni"><a href="#server-name-indication-sni" class="header-anchor">#</a> Server Name Indication (SNI)</h3> <p>Server Name Indication (SNI) is a TLS extension by which a client
specifies a hostname attempting to connect: during the TLS handshake the
client gives a server name and the server can use it to respond with a
specific certificate for this server name instead of the default
deployed certificate. If the server requires client authentication the
server can use a specific trusted CA certificate depending on the
indicated server name.</p> <p>When SNI is active the server uses</p> <ul><li><p>the certificate CN or SAN DNS (Subject Alternative Name with DNS) to
do an exact match, e.g <code>www.example.com</code></p></li> <li><p>the certificate CN or SAN DNS certificate to match a wildcard name,
e.g <code>*.example.com</code></p></li> <li><p>otherwise the first certificate when the client does not present a
server name or the presented server name cannot be matched</p></li></ul> <p>When the server additionally requires client authentication:</p> <ul><li><p>if <code>JksOptions</code> were used to set the trust options (<code>options</code>) then
an exact match with the trust store alias is done</p></li> <li><p>otherwise the available CA certificates are used in the same way as
if no SNI is in place</p></li></ul> <p>You can enable SNI on the server by setting <code>setSni</code> to <code>true</code> and
configured the server with multiple key/certificate pairs.</p> <p>Java KeyStore files or PKCS12 files can store multiple key/cert pairs
out of the box.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> keyCertOptions <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JksOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setPath</span><span class="token punctuation">(</span><span class="token string">&quot;keystore.jks&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">&quot;wibble&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> netServer <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">createNetServer</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">NetServerOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setKeyStoreOptions</span><span class="token punctuation">(</span>keyCertOptions<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setSsl</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setSni</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>PemKeyCertOptions</code> can be configured to hold multiple entries:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> keyCertOptions <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PemKeyCertOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setKeyPaths</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;default-key.pem&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;host1-key.pem&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;etc...&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setCertPaths</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;default-cert.pem&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;host2-key.pem&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;etc...&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> netServer <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">createNetServer</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">NetServerOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setPemKeyCertOptions</span><span class="token punctuation">(</span>keyCertOptions<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setSsl</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setSni</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The client implicitly sends the connecting host as an SNI server name
for Fully Qualified Domain Name (FQDN).</p> <p>You can provide an explicit server name when connecting a socket</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> client <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">createNetClient</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">NetClientOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setTrustStoreOptions</span><span class="token punctuation">(</span>trustOptions<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setSsl</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Connect to 'localhost' and present 'server.name' server name</span>
client<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token number">1234</span><span class="token punctuation">,</span> <span class="token string">&quot;localhost&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;server.name&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token function">succeeded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Connected!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> socket <span class="token operator">=</span> res<span class="token punctuation">.</span><span class="token function">result</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Failed to connect: &quot;</span> <span class="token operator">+</span> res<span class="token punctuation">.</span><span class="token function">cause</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>It can be used for different purposes:</p> <ul><li><p>present a server name different than the server host</p></li> <li><p>present a server name while connecting to an IP</p></li> <li><p>force to present a server name when using shortname</p></li></ul> <h3 id="application-layer-protocol-negotiation-alpn"><a href="#application-layer-protocol-negotiation-alpn" class="header-anchor">#</a> Application-Layer Protocol Negotiation (ALPN)</h3> <p>Application-Layer Protocol Negotiation (ALPN) is a TLS extension for
application layer protocol negotiation. It is used by HTTP/2: during the
TLS handshake the client gives the list of application protocols it
accepts and the server responds with a protocol it supports.</p> <p>If you are using Java 9, you are fine and you can use HTTP/2 out of the
box without extra steps.</p> <p>Java 8 does not supports ALPN out of the box, so ALPN should be enabled
by other means:</p> <ul><li><p><em>OpenSSL</em> support</p></li> <li><p><em>Jetty-ALPN</em> support</p></li></ul> <p>The engine options to use is</p> <ul><li><p>the <code>getSslEngineOptions</code> options when it is set</p></li> <li><p><code>JdkSSLEngineOptions</code> when ALPN is available for JDK</p></li> <li><p><code>OpenSSLEngineOptions</code> when ALPN is available for OpenSSL</p></li> <li><p>otherwise it fails</p></li></ul> <h4 id="openssl-alpn-support"><a href="#openssl-alpn-support" class="header-anchor">#</a> OpenSSL ALPN support</h4> <p>OpenSSL provides native ALPN support.</p> <p>OpenSSL requires to configure <code>setOpenSslEngineOptions</code> and use
<a href="http://netty.io/wiki/forked-tomcat-native.html" target="_blank" rel="noopener noreferrer">netty-tcnative<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> jar on
the classpath. Using tcnative may require OpenSSL to be installed on
your OS depending on the tcnative implementation.</p> <h4 id="jetty-alpn-support"><a href="#jetty-alpn-support" class="header-anchor">#</a> Jetty-ALPN support</h4> <p>Jetty-ALPN is a small jar that overrides a few classes of Java 8
distribution to support ALPN.</p> <p>The JVM must be started with the <em>alpn-boot-${version}.jar</em> in its
<code>bootclasspath</code>:</p> <div class="language- extra-class"><pre><code>-Xbootclasspath/p:/path/to/alpn-boot${version}.jar
</code></pre></div><p>where ${version} depends on the JVM version, e.g. <em>8.1.7.v20160121</em> for
<em>OpenJDK 1.8.0u74</em> . The complete list is available on the <a href="http://www.eclipse.org/jetty/documentation/current/alpn-chapter.html" target="_blank" rel="noopener noreferrer">Jetty-ALPN
page<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>The main drawback is that the version depends on the JVM.</p> <p>To solve this problem the <em><a href="https://github.com/jetty-project/jetty-alpn-agent" target="_blank" rel="noopener noreferrer">Jetty ALPN
agent<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></em> can be use
instead. The agent is a JVM agent that will chose the correct ALPN
version for the JVM running it:</p> <div class="language- extra-class"><pre><code>-javaagent:/path/to/alpn/agent
</code></pre></div><h2 id="using-a-proxy-for-client-connections"><a href="#using-a-proxy-for-client-connections" class="header-anchor">#</a> Using a proxy for client connections</h2> <p>The <code>NetClient</code> supports either a HTTP/1.x <em>CONNECT</em>, <em>SOCKS4a</em> or
<em>SOCKS5</em> proxy.</p> <p>The proxy can be configured in the <code>NetClientOptions</code> by setting a
<code>ProxyOptions</code> object containing proxy type, hostname, port and
optionally username and password.</p> <p>Here’s an example:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NetClientOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setProxyOptions</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ProxyOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setType</span><span class="token punctuation">(</span><span class="token string">&quot;SOCKS5&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setHost</span><span class="token punctuation">(</span><span class="token string">&quot;localhost&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setPort</span><span class="token punctuation">(</span><span class="token number">1080</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setUsername</span><span class="token punctuation">(</span><span class="token string">&quot;username&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">&quot;secret&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> client <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">createNetClient</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The DNS resolution is always done on the proxy server, to achieve the
functionality of a SOCKS4 client, it is necessary to resolve the DNS
address locally.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/reactiverse/es4x/edit/develop/docs/manual/@vertx/core/net.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">3/30/2020, 11:09:36 PM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/es4x/assets/js/app.cfb14a02.js" defer></script><script src="/es4x/assets/js/2.96613d0f.js" defer></script><script src="/es4x/assets/js/77.7c3517c1.js" defer></script>
  </body>
</html>
