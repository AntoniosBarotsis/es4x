<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ES for Eclipse Vert.x</title>
    <meta name="generator" content="VuePress 1.5.0">
    <link rel="shortcut icon" type="image/png" href="/es4x/favicon.png">
    <link rel="stylesheet" type="text/css" href="/es4x/player/asciinema-player.css">
    <script src="/es4x/player/asciinema-player.js"></script>
    <meta name="description" content="A Modern JavaScript runtime for Eclipse Vert.x">
    <link rel="preload" href="/es4x/assets/css/0.styles.57be2129.css" as="style"><link rel="preload" href="/es4x/assets/js/app.cfb14a02.js" as="script"><link rel="preload" href="/es4x/assets/js/2.96613d0f.js" as="script"><link rel="preload" href="/es4x/assets/js/7.e56c8e30.js" as="script"><link rel="prefetch" href="/es4x/assets/js/10.25f493b2.js"><link rel="prefetch" href="/es4x/assets/js/100.cfb483ce.js"><link rel="prefetch" href="/es4x/assets/js/101.e546445b.js"><link rel="prefetch" href="/es4x/assets/js/102.9c678484.js"><link rel="prefetch" href="/es4x/assets/js/103.58ddcfc8.js"><link rel="prefetch" href="/es4x/assets/js/104.5d636807.js"><link rel="prefetch" href="/es4x/assets/js/105.9c9f8986.js"><link rel="prefetch" href="/es4x/assets/js/106.fb797c19.js"><link rel="prefetch" href="/es4x/assets/js/107.29eb69ad.js"><link rel="prefetch" href="/es4x/assets/js/108.d97e0b4e.js"><link rel="prefetch" href="/es4x/assets/js/109.28629ef4.js"><link rel="prefetch" href="/es4x/assets/js/11.6250afa8.js"><link rel="prefetch" href="/es4x/assets/js/110.3dd0cba3.js"><link rel="prefetch" href="/es4x/assets/js/111.601b115c.js"><link rel="prefetch" href="/es4x/assets/js/112.a49c45ac.js"><link rel="prefetch" href="/es4x/assets/js/113.ea0e864c.js"><link rel="prefetch" href="/es4x/assets/js/114.24c46597.js"><link rel="prefetch" href="/es4x/assets/js/115.65241419.js"><link rel="prefetch" href="/es4x/assets/js/116.a69493f0.js"><link rel="prefetch" href="/es4x/assets/js/117.03106a2c.js"><link rel="prefetch" href="/es4x/assets/js/118.50ed2245.js"><link rel="prefetch" href="/es4x/assets/js/119.beb4913a.js"><link rel="prefetch" href="/es4x/assets/js/12.1f7f2bd3.js"><link rel="prefetch" href="/es4x/assets/js/120.f13c267c.js"><link rel="prefetch" href="/es4x/assets/js/121.197dd995.js"><link rel="prefetch" href="/es4x/assets/js/122.b44c98b3.js"><link rel="prefetch" href="/es4x/assets/js/123.4586e425.js"><link rel="prefetch" href="/es4x/assets/js/124.d00a049e.js"><link rel="prefetch" href="/es4x/assets/js/125.1f32b7a7.js"><link rel="prefetch" href="/es4x/assets/js/126.e0bbd98d.js"><link rel="prefetch" href="/es4x/assets/js/127.fc93d280.js"><link rel="prefetch" href="/es4x/assets/js/128.98e5a4cc.js"><link rel="prefetch" href="/es4x/assets/js/129.fb3a3f88.js"><link rel="prefetch" href="/es4x/assets/js/13.1a7b9986.js"><link rel="prefetch" href="/es4x/assets/js/130.5cd4d89d.js"><link rel="prefetch" href="/es4x/assets/js/131.6ac7fa33.js"><link rel="prefetch" href="/es4x/assets/js/132.c8ad9a79.js"><link rel="prefetch" href="/es4x/assets/js/133.90881bb4.js"><link rel="prefetch" href="/es4x/assets/js/134.f7596c11.js"><link rel="prefetch" href="/es4x/assets/js/135.f8db6a39.js"><link rel="prefetch" href="/es4x/assets/js/136.bd2de92d.js"><link rel="prefetch" href="/es4x/assets/js/137.eabfa5f6.js"><link rel="prefetch" href="/es4x/assets/js/138.c19e308b.js"><link rel="prefetch" href="/es4x/assets/js/139.e437bff1.js"><link rel="prefetch" href="/es4x/assets/js/14.b66836b1.js"><link rel="prefetch" href="/es4x/assets/js/140.8d09b641.js"><link rel="prefetch" href="/es4x/assets/js/141.4d46fb84.js"><link rel="prefetch" href="/es4x/assets/js/142.99040345.js"><link rel="prefetch" href="/es4x/assets/js/143.7d902150.js"><link rel="prefetch" href="/es4x/assets/js/144.0543ff8f.js"><link rel="prefetch" href="/es4x/assets/js/145.6a2886f8.js"><link rel="prefetch" href="/es4x/assets/js/146.01466845.js"><link rel="prefetch" href="/es4x/assets/js/147.42e445c8.js"><link rel="prefetch" href="/es4x/assets/js/148.e677edea.js"><link rel="prefetch" href="/es4x/assets/js/149.50959280.js"><link rel="prefetch" href="/es4x/assets/js/15.bd087613.js"><link rel="prefetch" href="/es4x/assets/js/150.eabb62e5.js"><link rel="prefetch" href="/es4x/assets/js/151.a6f046ed.js"><link rel="prefetch" href="/es4x/assets/js/152.78e21db3.js"><link rel="prefetch" href="/es4x/assets/js/153.eef01fd9.js"><link rel="prefetch" href="/es4x/assets/js/154.f5b66c27.js"><link rel="prefetch" href="/es4x/assets/js/155.f5cbe3be.js"><link rel="prefetch" href="/es4x/assets/js/156.3fdf30f1.js"><link rel="prefetch" href="/es4x/assets/js/157.aeebd96f.js"><link rel="prefetch" href="/es4x/assets/js/158.bec405e9.js"><link rel="prefetch" href="/es4x/assets/js/159.f81bc2fa.js"><link rel="prefetch" href="/es4x/assets/js/16.a392a655.js"><link rel="prefetch" href="/es4x/assets/js/160.611a570e.js"><link rel="prefetch" href="/es4x/assets/js/161.400aed1c.js"><link rel="prefetch" href="/es4x/assets/js/162.60fdd908.js"><link rel="prefetch" href="/es4x/assets/js/163.841834be.js"><link rel="prefetch" href="/es4x/assets/js/164.368aca3b.js"><link rel="prefetch" href="/es4x/assets/js/165.6ed202c4.js"><link rel="prefetch" href="/es4x/assets/js/166.cd243b01.js"><link rel="prefetch" href="/es4x/assets/js/167.74493e23.js"><link rel="prefetch" href="/es4x/assets/js/168.26ae4c80.js"><link rel="prefetch" href="/es4x/assets/js/169.adffbf41.js"><link rel="prefetch" href="/es4x/assets/js/17.f58ddc3f.js"><link rel="prefetch" href="/es4x/assets/js/170.ec119bad.js"><link rel="prefetch" href="/es4x/assets/js/171.8ce41d74.js"><link rel="prefetch" href="/es4x/assets/js/172.c0640f4c.js"><link rel="prefetch" href="/es4x/assets/js/18.d0e693e8.js"><link rel="prefetch" href="/es4x/assets/js/19.2cfa07bf.js"><link rel="prefetch" href="/es4x/assets/js/20.83c2c4e9.js"><link rel="prefetch" href="/es4x/assets/js/21.bfb22c95.js"><link rel="prefetch" href="/es4x/assets/js/22.80259bfc.js"><link rel="prefetch" href="/es4x/assets/js/23.d3df90af.js"><link rel="prefetch" href="/es4x/assets/js/24.47cf75e1.js"><link rel="prefetch" href="/es4x/assets/js/25.af00dd42.js"><link rel="prefetch" href="/es4x/assets/js/26.2c5dd1f3.js"><link rel="prefetch" href="/es4x/assets/js/27.313c4d9d.js"><link rel="prefetch" href="/es4x/assets/js/28.c3fa5296.js"><link rel="prefetch" href="/es4x/assets/js/29.bc391437.js"><link rel="prefetch" href="/es4x/assets/js/3.4d2250de.js"><link rel="prefetch" href="/es4x/assets/js/30.ab72b827.js"><link rel="prefetch" href="/es4x/assets/js/31.360cf0c4.js"><link rel="prefetch" href="/es4x/assets/js/32.a454f02e.js"><link rel="prefetch" href="/es4x/assets/js/33.9072e3dc.js"><link rel="prefetch" href="/es4x/assets/js/34.2cd817f7.js"><link rel="prefetch" href="/es4x/assets/js/35.1499c4b4.js"><link rel="prefetch" href="/es4x/assets/js/36.b24867f2.js"><link rel="prefetch" href="/es4x/assets/js/37.8a1d9476.js"><link rel="prefetch" href="/es4x/assets/js/38.1caa3e15.js"><link rel="prefetch" href="/es4x/assets/js/39.ab25bad3.js"><link rel="prefetch" href="/es4x/assets/js/4.2410671b.js"><link rel="prefetch" href="/es4x/assets/js/40.13850330.js"><link rel="prefetch" href="/es4x/assets/js/41.1f30e160.js"><link rel="prefetch" href="/es4x/assets/js/42.f65b46db.js"><link rel="prefetch" href="/es4x/assets/js/43.86bd3898.js"><link rel="prefetch" href="/es4x/assets/js/44.25aede52.js"><link rel="prefetch" href="/es4x/assets/js/45.fbb6033a.js"><link rel="prefetch" href="/es4x/assets/js/46.13bb4f87.js"><link rel="prefetch" href="/es4x/assets/js/47.01a4d32b.js"><link rel="prefetch" href="/es4x/assets/js/48.4ef5e818.js"><link rel="prefetch" href="/es4x/assets/js/49.896ad60c.js"><link rel="prefetch" href="/es4x/assets/js/5.f2fd7a11.js"><link rel="prefetch" href="/es4x/assets/js/50.54a8010f.js"><link rel="prefetch" href="/es4x/assets/js/51.26142f55.js"><link rel="prefetch" href="/es4x/assets/js/52.b132a309.js"><link rel="prefetch" href="/es4x/assets/js/53.dc983026.js"><link rel="prefetch" href="/es4x/assets/js/54.3ae4a5b7.js"><link rel="prefetch" href="/es4x/assets/js/55.4b3e9675.js"><link rel="prefetch" href="/es4x/assets/js/56.2cc05aac.js"><link rel="prefetch" href="/es4x/assets/js/57.f8c33e2c.js"><link rel="prefetch" href="/es4x/assets/js/58.7b7e6201.js"><link rel="prefetch" href="/es4x/assets/js/59.beab06b9.js"><link rel="prefetch" href="/es4x/assets/js/6.7eb69711.js"><link rel="prefetch" href="/es4x/assets/js/60.ad528007.js"><link rel="prefetch" href="/es4x/assets/js/61.7462fe68.js"><link rel="prefetch" href="/es4x/assets/js/62.c7245534.js"><link rel="prefetch" href="/es4x/assets/js/63.91dfc6d8.js"><link rel="prefetch" href="/es4x/assets/js/64.a9a5d5d7.js"><link rel="prefetch" href="/es4x/assets/js/65.bd897469.js"><link rel="prefetch" href="/es4x/assets/js/66.b6b4afbd.js"><link rel="prefetch" href="/es4x/assets/js/67.b882907b.js"><link rel="prefetch" href="/es4x/assets/js/68.32bb2628.js"><link rel="prefetch" href="/es4x/assets/js/69.6e7fa7f2.js"><link rel="prefetch" href="/es4x/assets/js/70.9fa2afb4.js"><link rel="prefetch" href="/es4x/assets/js/71.228413c9.js"><link rel="prefetch" href="/es4x/assets/js/72.4a3f3614.js"><link rel="prefetch" href="/es4x/assets/js/73.abf3fc90.js"><link rel="prefetch" href="/es4x/assets/js/74.13ff27d1.js"><link rel="prefetch" href="/es4x/assets/js/75.96ffdfe8.js"><link rel="prefetch" href="/es4x/assets/js/76.ef6180eb.js"><link rel="prefetch" href="/es4x/assets/js/77.7c3517c1.js"><link rel="prefetch" href="/es4x/assets/js/78.a4cb55ca.js"><link rel="prefetch" href="/es4x/assets/js/79.2a3d8a2f.js"><link rel="prefetch" href="/es4x/assets/js/8.3d81d937.js"><link rel="prefetch" href="/es4x/assets/js/80.80c9d719.js"><link rel="prefetch" href="/es4x/assets/js/81.7be9486c.js"><link rel="prefetch" href="/es4x/assets/js/82.f30975e2.js"><link rel="prefetch" href="/es4x/assets/js/83.2e22eebd.js"><link rel="prefetch" href="/es4x/assets/js/84.60798b2c.js"><link rel="prefetch" href="/es4x/assets/js/85.a6928290.js"><link rel="prefetch" href="/es4x/assets/js/86.0be2ea51.js"><link rel="prefetch" href="/es4x/assets/js/87.ad51e710.js"><link rel="prefetch" href="/es4x/assets/js/88.81d5d220.js"><link rel="prefetch" href="/es4x/assets/js/89.aac46f66.js"><link rel="prefetch" href="/es4x/assets/js/9.2edb4e2b.js"><link rel="prefetch" href="/es4x/assets/js/90.4a4fd3dc.js"><link rel="prefetch" href="/es4x/assets/js/91.065cc9a5.js"><link rel="prefetch" href="/es4x/assets/js/92.055a4ecc.js"><link rel="prefetch" href="/es4x/assets/js/93.71b53f02.js"><link rel="prefetch" href="/es4x/assets/js/94.b096f725.js"><link rel="prefetch" href="/es4x/assets/js/95.af24f6b1.js"><link rel="prefetch" href="/es4x/assets/js/96.38f15cba.js"><link rel="prefetch" href="/es4x/assets/js/97.c53fc06f.js"><link rel="prefetch" href="/es4x/assets/js/98.3426a32c.js"><link rel="prefetch" href="/es4x/assets/js/99.fa951d15.js">
    <link rel="stylesheet" href="/es4x/assets/css/0.styles.57be2129.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/es4x/" class="home-link router-link-active"><!----> <span class="site-name">ES for Eclipse Vert.x</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/es4x/get-started/" class="nav-link">
  Get started
</a></div><div class="nav-item"><a href="/es4x/advanced/" class="nav-link">
  Advanced
</a></div><div class="nav-item"><a href="/es4x/manual/" class="nav-link router-link-active">
  Manual
</a></div><div class="nav-item"><a href="/es4x/api/" class="nav-link">
  APIs
</a></div><div class="nav-item"><a href="https://github.com/reactiverse/es4x/blob/master/CHANGELOG.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Changelog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/es4x/manual/@vertx/amqp-bridge/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li><li class="dropdown-item"><!----> <a href="/es4x/zh/" class="nav-link">
  简体中文
</a></li><li class="dropdown-item"><!----> <a href="/es4x/pt/" class="nav-link">
  Português
</a></li></ul></div></div> <a href="https://github.com/reactiverse/es4x" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/es4x/get-started/" class="nav-link">
  Get started
</a></div><div class="nav-item"><a href="/es4x/advanced/" class="nav-link">
  Advanced
</a></div><div class="nav-item"><a href="/es4x/manual/" class="nav-link router-link-active">
  Manual
</a></div><div class="nav-item"><a href="/es4x/api/" class="nav-link">
  APIs
</a></div><div class="nav-item"><a href="https://github.com/reactiverse/es4x/blob/master/CHANGELOG.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Changelog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/es4x/manual/@vertx/amqp-bridge/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li><li class="dropdown-item"><!----> <a href="/es4x/zh/" class="nav-link">
  简体中文
</a></li><li class="dropdown-item"><!----> <a href="/es4x/pt/" class="nav-link">
  Português
</a></li></ul></div></div> <a href="https://github.com/reactiverse/es4x" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Manuals</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/es4x/manual/" aria-current="page" class="sidebar-link">API Reference Manuals</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p>This component provides AMQP 1.0 producer and consumer support via a
bridging layer implementing the Vert.x event bus MessageProducer and
MessageConsumer APIs over the top of
<a href="https://github.com/vert-x3/vertx-proton/" target="_blank" rel="noopener noreferrer">vertx-proton<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <blockquote><p><strong>Warning</strong></p> <p>This component will be removed in Vert.x 4, instead you should use
<a href="https://vertx.io/docs/vertx-amqp-client/java/" target="_blank" rel="noopener noreferrer">Vert.x AMQP Client<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <h1 id="using-vert-x-amqp-bridge"><a href="#using-vert-x-amqp-bridge" class="header-anchor">#</a> Using Vert.x AMQP Bridge</h1> <p>To use Vert.x AMQP Bridge, add the following dependency to the
<em>dependencies</em> section of your build descriptor:</p> <ul><li>Maven (in your <code>pom.xml</code>):</li></ul> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>io.vertx<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>vertx-amqp-bridge<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${maven.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>Gradle (in your <code>build.gradle</code> file):</li></ul> <div class="language-groovy extra-class"><pre class="language-groovy"><code>compile io<span class="token punctuation">.</span>vertx<span class="token punctuation">:</span>vertx<span class="token operator">-</span>amqp<span class="token operator">-</span>bridge<span class="token punctuation">:</span><span class="token punctuation">$</span><span class="token punctuation">{</span>maven<span class="token punctuation">.</span>version<span class="token punctuation">}</span>
</code></pre></div><h1 id="getting-started"><a href="#getting-started" class="header-anchor">#</a> Getting Started</h1> <h2 id="sending-a-message"><a href="#sending-a-message" class="header-anchor">#</a> Sending a Message</h2> <p>Here is a simple example of creating a <code>MessageProducer</code> and sending a
message with it. First, an <code>AmqpBridge</code> is created and started to
establish the underlying AMQP connection, then when this is complete the
producer is created and a message sent using it. You can optionally
supply a username and password when starting the bridge, as well as
supplying <code>AmqpBridgeOptions</code> in order to configure various options such
as for using SSL connections.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> AmqpBridge <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@vertx/amqp-bridge&quot;</span>
<span class="token keyword">let</span> bridge <span class="token operator">=</span> AmqpBridge<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>vertx<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Start the bridge, then use the event loop thread to process things thereafter.</span>
bridge<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token string">&quot;localhost&quot;</span><span class="token punctuation">,</span> <span class="token number">5672</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// Set up a producer using the bridge, send a message with it.</span>
  <span class="token keyword">let</span> producer <span class="token operator">=</span> bridge<span class="token punctuation">.</span><span class="token function">createProducer</span><span class="token punctuation">(</span><span class="token string">&quot;myAmqpAddress&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">let</span> amqpMsgPayload <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  amqpMsgPayload<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token string">&quot;myStringContent&quot;</span><span class="token punctuation">;</span>

  producer<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>amqpMsgPayload<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="receiving-a-message"><a href="#receiving-a-message" class="header-anchor">#</a> Receiving a Message</h2> <p>Here is a simple example of creating a <code>MessageConsumer</code> and registering
a handler with it. First, an <code>AmqpBridge</code> is created and started to
establish the underlying AMQP connection, then when this is complete the
consumer is created and a handler registered that prints the body of
incoming AMQP messages.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> AmqpBridge <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@vertx/amqp-bridge&quot;</span>
<span class="token keyword">let</span> bridge <span class="token operator">=</span> AmqpBridge<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>vertx<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Start the bridge, then use the event loop thread to process things thereafter.</span>
bridge<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token string">&quot;localhost&quot;</span><span class="token punctuation">,</span> <span class="token number">5672</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// Set up a consumer using the bridge, register a handler for it.</span>
  <span class="token keyword">let</span> consumer <span class="token operator">=</span> bridge<span class="token punctuation">.</span><span class="token function">createConsumer</span><span class="token punctuation">(</span><span class="token string">&quot;myAmqpAddress&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  consumer<span class="token punctuation">.</span><span class="token function">handler</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">vertxMsg</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> amqpMsgPayload <span class="token operator">=</span> vertxMsg<span class="token punctuation">.</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> amqpBody <span class="token operator">=</span> amqpMsgPayload<span class="token punctuation">.</span>body<span class="token punctuation">;</span>

    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Received a message with body: &quot;</span> <span class="token operator">+</span> amqpBody<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Receipt of the AMQP message is accepted automatically as soon as the
consumer’s handler returns upon delivering the message to the
application.</p> <h1 id="message-payload"><a href="#message-payload" class="header-anchor">#</a> Message Payload</h1> <h2 id="overview"><a href="#overview" class="header-anchor">#</a> Overview</h2> <p>The message payload is passed as a JsonObject with elements representing
various sections of the <a href="http://docs.oasis-open.org/amqp/core/v1.0/os/amqp-core-messaging-v1.0-os.html#section-message-format" target="_blank" rel="noopener noreferrer">AMQP
message<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>The top-level elements supported are:</p> <p><strong>body</strong>: The content for the body section of the AMQP message.
<strong>body_type</strong>: An optional String used to indicate whether the &quot;body&quot;
element represents an AmqpValue (default), Data, or AmqpSequence
section. The values used are &quot;value&quot;, &quot;data&quot;, and &quot;sequence&quot;
respectively. <strong>header</strong>: An optional JsonObject representing the
elements of the message Header section. Expanded below. <strong>properties</strong>:
An optional JsonObject representing the elements of the message
Properties section. Expanded below. <strong>application_properties</strong>: An
optional JsonObject containing any application defined
properties(/headers). <strong>message_annotations</strong>: An optional JsonObject
representing any message annotations.</p> <p>The elements of the optional &quot;header&quot; sub-element are:</p> <p><strong>durable</strong>: optional boolean indicating whether the message is durable
(default false). <strong>priority</strong>: optional short indicating the message
priority (default 4). <strong>ttl</strong>: optional long indicating ttl in
milliseconds (no default). See also 'properties' absolute expiry time.
<strong>first_acquirer</strong>: boolean indicating if this is the first acquirer of
the message (default false) <strong>delivery_count</strong>: long indicating the
number of previous <em>failed</em> delivery attempts for message.</p> <p>The elements of the optional &quot;properties&quot; sub-element are:</p> <p><strong>to</strong>: optional string with address message is being sent to (no
default). <strong>reply_to</strong>: optional string with address for replies (no
default). Set automatically when sent with reply handler.
<strong>message_id</strong>: optional string with message id (no default). Set
automatically when sending with reply handler. <strong>correlation_id</strong>:
optional string with correlation id (no default). Set automatically when
implicit reply is sent. <strong>subject</strong>: optional string with message
subject (no default). <strong>group_id</strong>: optional string with message group
id (no default). <strong>group_sequence</strong>: optional long with message group
sequence (no default). <strong>reply_to_group_id</strong>: optional string with
message reply to group id (no default). <strong>content_type</strong>: optional
string with message content type (no default). Only for use with Data
body sections. <strong>content_encoding</strong>: optional string with message
content encoding (no default). <strong>creation_time</strong>: optional long with
message creation time in milliseconds since the unix epoch (no default).
<strong>absolute_expiry_time</strong>: optional long with absolute expiry time as
milliseconds since the unix epoch (no default). <strong>user_id</strong>: optional
string with the id of the user sending the message (no default).</p> <h2 id="application-properties"><a href="#application-properties" class="header-anchor">#</a> Application Properties</h2> <p>To send a message with application properties, the
&quot;application_properties&quot; element is added to the payload, containing a
JsonObject whose contents represent the application property entries,
which have string keys and a object representing a simple value such as
String, Boolean, Integer, etc. For example, adding a property to a sent
message could look something like:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> applicationProperties <span class="token operator">=</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
applicationProperties<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;value&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> amqpMsgPayload <span class="token operator">=</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
amqpMsgPayload<span class="token punctuation">.</span>application_properties <span class="token operator">=</span> applicationProperties<span class="token punctuation">;</span>

producer<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>amqpMsgPayload<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>When receiving a message with application properties, the
&quot;application_properties&quot; element is added to the JsonObject payload
returned, containing a JsonObject whose contents represent the
application property entries. For example, retrieving an
application-property from a received message might look like:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Check the application properties section was present before use, it may not be</span>
<span class="token keyword">let</span> appProps <span class="token operator">=</span> amqpMsgPayload<span class="token punctuation">.</span>application_properties<span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>appProps <span class="token operator">!==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> appProps <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> propValue <span class="token operator">=</span> appProps<span class="token punctuation">.</span>propertyName<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h1 id="flow-control"><a href="#flow-control" class="header-anchor">#</a> Flow Control</h1> <p>Message transfer between peers, such as clients and servers, is governed
by credit in AMQP 1.0, with receiving peers granting sending peers a
number of credits to allow them to send messages. As each message is
sent a unit of credit is used up, with the receiving peer needing to
replenish the senders credit over time in order for message delivery to
progress. This allows for recipients to flow control senders by
governing the amount of outstanding credit available.</p> <h2 id="producers"><a href="#producers" class="header-anchor">#</a> Producers</h2> <p>While a MessageProducer will buffer outgoing messages if there are
insufficient credits to send them all immediately, and then send them
once credit is granted, it is typically more desirable for the
application to work in tandem with the producer and attempt to send only
what it knows can actually currently be sent.</p> <p>This is possible by inspecting whether the producer write queue is full,
i.e it currently has no credit to send:</p> <div class="language-js extra-class"><pre class="language-js"><code>producer<span class="token punctuation">.</span><span class="token function">writeQueueFull</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>This check can be used in concert with a handler that can be registered
to receive callbacks whenever the producer receives more credit and is
able to send messages immediately rather than buffer them:</p> <div class="language-js extra-class"><pre class="language-js"><code>producer<span class="token punctuation">.</span><span class="token function">drainHandler</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">v</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...do stuff and send...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="consumers"><a href="#consumers" class="header-anchor">#</a> Consumers</h2> <p>In the case of a MessageConsumer, the bridge automatically gives 1000
credits to the sending peer when the consumer handler is registered, and
replenishes this credit automatically as messages are delivered to the
handler. It is possible to adjust the amount of credit given initially
(the value must be at least 1) by adjusting the maximum buffered message
value before registering a handler, for example:</p> <div class="language-js extra-class"><pre class="language-js"><code>consumer<span class="token punctuation">.</span><span class="token function">setMaxBufferedMessages</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
consumer<span class="token punctuation">.</span><span class="token function">handler</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...handle received messages...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h1 id="connecting-using-ssl"><a href="#connecting-using-ssl" class="header-anchor">#</a> Connecting using SSL</h1> <p>You can also optionally supply <code>AmqpBridgeOptions</code> when creating the
bridge in order to configure various options, the most typically used of
which are around behaviour for SSL connections.</p> <p>The following is an example of using configuration to create a bridge
connecting to a server using SSL, authenticating with a username and
password, and supplying a PKCS12 based trust store to verify trust of
the server certificate:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> AmqpBridge <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@vertx/amqp-bridge&quot;</span>
<span class="token keyword">let</span> bridgeOptions <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AmqpBridgeOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
bridgeOptions<span class="token punctuation">.</span>ssl <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> trustOptions <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PfxOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setPath</span><span class="token punctuation">(</span><span class="token string">&quot;path/to/pkcs12.truststore&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">&quot;password&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
bridgeOptions<span class="token punctuation">.</span>pfxTrustOptions <span class="token operator">=</span> trustOptions<span class="token punctuation">;</span>

<span class="token keyword">let</span> bridge <span class="token operator">=</span> AmqpBridge<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>vertx<span class="token punctuation">,</span> bridgeOptions<span class="token punctuation">)</span><span class="token punctuation">;</span>
bridge<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token string">&quot;localhost&quot;</span><span class="token punctuation">,</span> <span class="token number">5672</span><span class="token punctuation">,</span> <span class="token string">&quot;username&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;password&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// ..do things with the bridge..</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The following is an example of using configuration to create a bridge
connecting to a server requiring SSL Client Certificate Authentication,
supplying both a PKCS12 based trust store to verify trust of the server
certificate and also a PKCS12 based key store containing an SSL key and
certificate the server can use to verify the client:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> AmqpBridge <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@vertx/amqp-bridge&quot;</span>
<span class="token keyword">let</span> bridgeOptions <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AmqpBridgeOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
bridgeOptions<span class="token punctuation">.</span>ssl <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> trustOptions <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PfxOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setPath</span><span class="token punctuation">(</span><span class="token string">&quot;path/to/pkcs12.truststore&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">&quot;password&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
bridgeOptions<span class="token punctuation">.</span>pfxTrustOptions <span class="token operator">=</span> trustOptions<span class="token punctuation">;</span>

<span class="token keyword">let</span> keyCertOptions <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PfxOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setPath</span><span class="token punctuation">(</span><span class="token string">&quot;path/to/pkcs12.keystore&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">&quot;password&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
bridgeOptions<span class="token punctuation">.</span>pfxKeyCertOptions <span class="token operator">=</span> keyCertOptions<span class="token punctuation">;</span>

<span class="token keyword">let</span> bridge <span class="token operator">=</span> AmqpBridge<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>vertx<span class="token punctuation">,</span> bridgeOptions<span class="token punctuation">)</span><span class="token punctuation">;</span>
bridge<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token string">&quot;localhost&quot;</span><span class="token punctuation">,</span> <span class="token number">5672</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// ..do things with the bridge..</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h1 id="sending-and-receiving-replies"><a href="#sending-and-receiving-replies" class="header-anchor">#</a> Sending and Receiving replies.</h1> <p>Like many messaging protocols, AMQP includes support for a reply-to
address to be set on each message sent so that recipients can be told
where to send any responses required. The vert.x <code>Message</code> objects also
support the concept of a reply address, though when using the Event Bus
the sender doesn’t set it explicitly, and it is instead populated
implicitly if a message is sent with a reply <code>Handler</code>. This section
describes how the bridge handles sending and receiving AMQP messages
with reply-to while using the Vert.x producer, consumer, and message
APIs implemented by the bridge.</p> <h2 id="sent-messages-seeking-a-reply"><a href="#sent-messages-seeking-a-reply" class="header-anchor">#</a> Sent messages seeking a reply.</h2> <p>There are two options when sending messages to which responses are
required:</p> <ul><li><p>Populate the AMQP reply-to address of the outgoing message
explicitly.</p></li> <li><p>Provide a reply handler when sending to populate it implicitly.</p></li></ul> <p>With the first option, you may explicitly populate the &quot;reply_to&quot;
element of the message &quot;properties&quot; section, as outlined in the <a href="#message_payload">message
payload overview</a>. Here you would provide a string
containing the name of the AMQP address on the server to which
recipients should direct their responses, typically a named queue to
which you have already established a consumer to receive the replies.
This route may be necessary if you need to receive multiple replies to a
given sent AMQP message.</p> <p>With the second option a reply <code>Handler</code> may also be given in addition
to the message payload when sending a message, to be registered such
that it is invoked when a [single] response message is received for
the message being sent.</p> <p>To facilitate this, upon startup the bridge internally creates a
consumer from a server-named dynamic address, the name of which it then
uses as the reply-to address on any AMQP messages sent when a
replyHandler was given. The bridge also populates the <em>message-id</em> of
the outgoing AMQP message, and uses this value to keep track of the
reply handler. Incoming messages on the internal 'reply consumer' have
their <em>correlation-id</em> values inspected in order to match them to the
reply handler originally given, requiring that reply senders populate
the <em>correlation-id</em> field with the <em>message-id</em> of the original
message.</p> <p>The following shows the process for the second option:</p> <p><img src="/es4x/assets/img/producer-reply-handler.8b514372.png" alt="producer reply handler"></p> <ol><li><p>The producer is used to send a message to an AMQP address, providing
a reply handler.</p></li> <li><p>The bridge send implementation populates the <em>reply-to</em> and
<em>message-id</em> fields of the outgoing AMQP message, records the
handler, and sends the message to the server.</p></li> <li><p>The receiving application (perhaps also a Vert.x AMQP bridge)
consumes the message and sends a reply to its <em>reply-to</em> address,
setting its <em>correlation-id</em> field as the original messages
<em>message-id</em>.</p></li> <li><p>The server dispatches the reply message to the internal 'reply
consumer' of the bridge.</p></li> <li><p>The bridge processes the AMQP message, creating the Vert.x Message
with JsonObject body, uses the <em>correlation-id</em> value to match it
with the reply handler, and then invokes the handler with the reply
message.</p></li></ol> <p>The following is a basic example of sending a message and providing a
reply-handler to process the response:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> amqpMsgPayload <span class="token operator">=</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
amqpMsgPayload<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token string">&quot;myRequest&quot;</span><span class="token punctuation">;</span>

producer<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>amqpMsgPayload<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> amqpReplyMessagePayload <span class="token operator">=</span> res<span class="token punctuation">.</span><span class="token function">result</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// ...do something with reply message...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="received-messages-seeking-a-reply"><a href="#received-messages-seeking-a-reply" class="header-anchor">#</a> Received messages seeking a reply.</h2> <p>When a message arrives, its replyAddress may be inspected. If the AMQP
message had its <em>reply-to</em> field populated, then the address given will
be returned from the Vert.x message replyAddress method. If no
<em>reply-to</em> value was present on the message, the value returned will be
null.</p> <p>There are two options when receiving messages to which responses are
required:</p> <ul><li><p>Populate the AMQP reply-to address of an outgoing message sent
explicitly using a producer.</p></li> <li><p>Send a reply using the Message reply method.</p></li></ul> <p>With the first option, you may explicitly populate the &quot;reply_to&quot;
element of the message &quot;properties&quot; section, as outlined in the <a href="#message_payload">message
payload overview</a>, and send it explicitly using a
producer established to the address using the bridge.</p> <p>With the second option, a reply message may be sent by calling the reply
method on the Vert.x message object. The reply method implementation
ensures that the outgoing message <em>correlation-id</em> is populated
appropriately using the <em>message-id</em> of the original message, such that
the response can be matched in the case the original message was sent
from a Vert.x AMQP bridge producer with a reply handler provided.</p> <p>The following outlines the process for both routes, of receiving a
message sent by an application (not shown), and sending a reply:</p> <p><img src="/es4x/assets/img/consumer-reply.80a17ad5.png" alt="consumer reply"></p> <ol><li><p>The server sends an AMQP message to the consumer, with a reply-to
value set to another address.</p></li> <li><p>The bridge processes the AMQP message, creating the Vert.x Message
with JsonObject body. The Message replyAddress is set to the
reply-to value from the AMQP message.</p></li> <li><p>The Message is passed to the consumer Handler, which processes it,
inspecting the replyAddress and preparing to send a response.</p></li> <li><p>The handler chooses to either send a reply using an explicit
producer, or call the reply method on the message object.</p></li> <li><p>The reply message arrives at the response address on the server,
ready to be sent to a reply consumer for the original sending
application .</p></li></ol> <p>The following is a basic example of sending a reply using the message
reply method:</p> <div class="language-js extra-class"><pre class="language-js"><code>consumer<span class="token punctuation">.</span><span class="token function">handler</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...do something with received message...then reply...</span>
  <span class="token keyword">let</span> replyAddress <span class="token operator">=</span> msg<span class="token punctuation">.</span><span class="token function">replyAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>replyAddress <span class="token operator">!==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> replyAddress <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> amqpReplyMessagePayload <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    amqpReplyMessagePayload<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token string">&quot;myResponse&quot;</span><span class="token punctuation">;</span>

    msg<span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span>amqpReplyMessagePayload<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/reactiverse/es4x/edit/develop/docs/manual/@vertx/amqp-bridge/index.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">3/12/2020, 11:19:42 AM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/es4x/assets/js/app.cfb14a02.js" defer></script><script src="/es4x/assets/js/2.96613d0f.js" defer></script><script src="/es4x/assets/js/7.e56c8e30.js" defer></script>
  </body>
</html>
