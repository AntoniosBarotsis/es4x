(window.webpackJsonp=window.webpackJsonp||[]).push([[72],{284:function(s,t,e){"use strict";e.r(t);var a=e(28),n=Object(a.a)({},(function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"the-event-bus"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#the-event-bus"}},[s._v("#")]),s._v(" The Event Bus")]),s._v(" "),e("p",[s._v("The "),e("code",[s._v("event bus")]),s._v(" is the "),e("strong",[s._v("nervous system")]),s._v(" of Vert.x.")]),s._v(" "),e("p",[s._v("There is a single event bus instance for every Vert.x instance and it is\nobtained using the method "),e("code",[s._v("eventBus")]),s._v(".")]),s._v(" "),e("p",[s._v("The event bus allows different parts of your application to communicate\nwith each other, irrespective of what language they are written in, and\nwhether they’re in the same Vert.x instance, or in a different Vert.x\ninstance.")]),s._v(" "),e("p",[s._v("It can even be bridged to allow client-side JavaScript running in a\nbrowser to communicate on the same event bus.")]),s._v(" "),e("p",[s._v("The event bus forms a distributed peer-to-peer messaging system spanning\nmultiple server nodes and multiple browsers.")]),s._v(" "),e("p",[s._v("The event bus supports publish/subscribe, point-to-point, and\nrequest-response messaging.")]),s._v(" "),e("p",[s._v("The event bus API is very simple. It basically involves registering\nhandlers, unregistering handlers and sending and publishing messages.")]),s._v(" "),e("p",[s._v("First some theory:")]),s._v(" "),e("h2",{attrs:{id:"the-theory"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#the-theory"}},[s._v("#")]),s._v(" The Theory")]),s._v(" "),e("h3",{attrs:{id:"addressing"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#addressing"}},[s._v("#")]),s._v(" Addressing")]),s._v(" "),e("p",[s._v("Messages are sent on the event bus to an "),e("strong",[s._v("address")]),s._v(".")]),s._v(" "),e("p",[s._v("Vert.x doesn’t bother with any fancy addressing schemes. In Vert.x an\naddress is simply a string. Any string is valid. However it is wise to\nuse some kind of scheme, "),e("em",[s._v("e.g.")]),s._v(" using periods to demarcate a namespace.")]),s._v(" "),e("p",[s._v("Some examples of valid addresses are europe.news.feed1,\nacme.games.pacman, sausages, and X.")]),s._v(" "),e("h3",{attrs:{id:"handlers"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#handlers"}},[s._v("#")]),s._v(" Handlers")]),s._v(" "),e("p",[s._v("Messages are received by handlers. You register a handler at an address.")]),s._v(" "),e("p",[s._v("Many different handlers can be registered at the same address.")]),s._v(" "),e("p",[s._v("A single handler can be registered at many different addresses.")]),s._v(" "),e("h3",{attrs:{id:"publish-subscribe-messaging"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#publish-subscribe-messaging"}},[s._v("#")]),s._v(" Publish / subscribe messaging")]),s._v(" "),e("p",[s._v("The event bus supports "),e("strong",[s._v("publishing")]),s._v(" messages.")]),s._v(" "),e("p",[s._v("Messages are published to an address. Publishing means delivering the\nmessage to all handlers that are registered at that address.")]),s._v(" "),e("p",[s._v("This is the familiar "),e("strong",[s._v("publish/subscribe")]),s._v(" messaging pattern.")]),s._v(" "),e("h3",{attrs:{id:"point-to-point-and-request-response-messaging"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#point-to-point-and-request-response-messaging"}},[s._v("#")]),s._v(" Point-to-point and Request-Response messaging")]),s._v(" "),e("p",[s._v("The event bus also supports "),e("strong",[s._v("point-to-point")]),s._v(" messaging.")]),s._v(" "),e("p",[s._v("Messages are sent to an address. Vert.x will then route them to just one\nof the handlers registered at that address.")]),s._v(" "),e("p",[s._v("If there is more than one handler registered at the address, one will be\nchosen using a non-strict round-robin algorithm.")]),s._v(" "),e("p",[s._v("With point-to-point messaging, an optional reply handler can be\nspecified when sending the message.")]),s._v(" "),e("p",[s._v("When a message is received by a recipient, and has been handled, the\nrecipient can optionally decide to reply to the message. If they do so,\nthe reply handler will be called.")]),s._v(" "),e("p",[s._v("When the reply is received back by the sender, it too can be replied to.\nThis can be repeated "),e("em",[s._v("ad infinitum")]),s._v(", and allows a dialog to be set up\nbetween two different verticles.")]),s._v(" "),e("p",[s._v("This is a common messaging pattern called the "),e("strong",[s._v("request-response")]),s._v("\npattern.")]),s._v(" "),e("h3",{attrs:{id:"best-effort-delivery"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#best-effort-delivery"}},[s._v("#")]),s._v(" Best-effort delivery")]),s._v(" "),e("p",[s._v("Vert.x does its best to deliver messages and won’t consciously throw\nthem away. This is called "),e("strong",[s._v("best-effort")]),s._v(" delivery.")]),s._v(" "),e("p",[s._v("However, in case of failure of all or parts of the event bus, there is a\npossibility messages might be lost.")]),s._v(" "),e("p",[s._v("If your application cares about lost messages, you should code your\nhandlers to be idempotent, and your senders to retry after recovery.")]),s._v(" "),e("h3",{attrs:{id:"types-of-messages"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#types-of-messages"}},[s._v("#")]),s._v(" Types of messages")]),s._v(" "),e("p",[s._v("Out of the box Vert.x allows any primitive/simple type, String, or\n"),e("code",[s._v("buffers")]),s._v(" to be sent as messages.")]),s._v(" "),e("p",[s._v("However it’s a convention and common practice in Vert.x to send messages\nas "),e("a",{attrs:{href:"http://json.org/",target:"_blank",rel:"noopener noreferrer"}},[s._v("JSON"),e("OutboundLink")],1)]),s._v(" "),e("p",[s._v("JSON is very easy to create, read and parse in all the languages that\nVert.x supports so it has become a kind of "),e("em",[s._v("lingua franca")]),s._v(" for Vert.x.")]),s._v(" "),e("p",[s._v("However you are not forced to use JSON if you don’t want to.")]),s._v(" "),e("p",[s._v("The event bus is very flexible and also supports sending arbitrary\nobjects over the event bus. You can do this by defining a "),e("code",[s._v("codec")]),s._v(" for\nthe objects you want to send.")]),s._v(" "),e("h2",{attrs:{id:"the-event-bus-api"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#the-event-bus-api"}},[s._v("#")]),s._v(" The Event Bus API")]),s._v(" "),e("p",[s._v("Let’s jump into the API.")]),s._v(" "),e("h3",{attrs:{id:"getting-the-event-bus"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#getting-the-event-bus"}},[s._v("#")]),s._v(" Getting the event bus")]),s._v(" "),e("p",[s._v("You get a reference to the event bus as follows:")]),s._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" eb "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" vertx"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("eventBus")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),e("p",[s._v("There is a single instance of the event bus per Vert.x instance.")]),s._v(" "),e("h3",{attrs:{id:"registering-handlers"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#registering-handlers"}},[s._v("#")]),s._v(" Registering Handlers")]),s._v(" "),e("p",[s._v("This simplest way to register a handler is using "),e("code",[s._v("consumer")]),s._v(". Here’s an\nexample:")]),s._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" eb "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" vertx"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("eventBus")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\neb"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("consumer")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"news.uk.sport"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("message")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  console"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"I have received a message: "')]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" message"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("body")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),e("p",[s._v("When a message arrives for your handler, your handler will be called,\npassing in the "),e("code",[s._v("message")]),s._v(".")]),s._v(" "),e("p",[s._v("The object returned from call to consumer() is an instance of\n"),e("code",[s._v("MessageConsumer")]),s._v(".")]),s._v(" "),e("p",[s._v("This object can subsequently be used to unregister the handler, or use\nthe handler as a stream.")]),s._v(" "),e("p",[s._v("Alternatively you can use "),e("code",[s._v("consumer")]),s._v(" to return a MessageConsumer with no\nhandler set, and then set the handler on that. For example:")]),s._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" eb "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" vertx"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("eventBus")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" consumer "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" eb"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("consumer")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"news.uk.sport"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nconsumer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("handler")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("message")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  console"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"I have received a message: "')]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" message"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("body")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),e("p",[s._v("When registering a handler on a clustered event bus, it can take some\ntime for the registration to reach all nodes of the cluster.")]),s._v(" "),e("p",[s._v("If you want to be notified when this has completed, you can register a\n"),e("code",[s._v("completion handler")]),s._v(" on the MessageConsumer object.")]),s._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[s._v("consumer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("completionHandler")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("res")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("res"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("succeeded")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    console"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"The handler registration has reached all nodes"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    console"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Registration failed!"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),e("h3",{attrs:{id:"un-registering-handlers"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#un-registering-handlers"}},[s._v("#")]),s._v(" Un-registering Handlers")]),s._v(" "),e("p",[s._v("To unregister a handler, call "),e("code",[s._v("unregister")]),s._v(".")]),s._v(" "),e("p",[s._v("If you are on a clustered event bus, un-registering can take some time\nto propagate across the nodes. If you want to be notified when this is\ncomplete, use "),e("code",[s._v("unregister")]),s._v(".")]),s._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[s._v("consumer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("unregister")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("res")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("res"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("succeeded")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    console"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"The handler un-registration has reached all nodes"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    console"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Un-registration failed!"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),e("h3",{attrs:{id:"publishing-messages"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#publishing-messages"}},[s._v("#")]),s._v(" Publishing messages")]),s._v(" "),e("p",[s._v("Publishing a message is simple. Just use "),e("code",[s._v("publish")]),s._v(" specifying the\naddress to publish it to.")]),s._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[s._v("eventBus"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("publish")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"news.uk.sport"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Yay! Someone kicked a ball"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),e("p",[s._v("That message will then be delivered to all handlers registered against\nthe address news.uk.sport.")]),s._v(" "),e("h3",{attrs:{id:"sending-messages"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#sending-messages"}},[s._v("#")]),s._v(" Sending messages")]),s._v(" "),e("p",[s._v("Sending a message will result in only one handler registered at the\naddress receiving the message. This is the point-to-point messaging\npattern. The handler is chosen in a non-strict round-robin fashion.")]),s._v(" "),e("p",[s._v("You can send a message with "),e("code",[s._v("send")]),s._v(".")]),s._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[s._v("eventBus"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("send")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"news.uk.sport"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Yay! Someone kicked a ball"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),e("h3",{attrs:{id:"setting-headers-on-messages"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#setting-headers-on-messages"}},[s._v("#")]),s._v(" Setting headers on messages")]),s._v(" "),e("p",[s._v("Messages sent over the event bus can also contain headers. This can be\nspecified by providing a {@link io.vertx.core.eventbus.DeliveryOptions}\nwhen sending or publishing:")]),s._v(" "),e("div",{staticClass:"language-$lang extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("{@link docoverride.eventbus.Examples#headers(io.vertx.core.eventbus.EventBus)}\n")])])]),e("h3",{attrs:{id:"message-ordering"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#message-ordering"}},[s._v("#")]),s._v(" Message ordering")]),s._v(" "),e("p",[s._v("Vert.x will deliver messages to any particular handler in the same order\nthey were sent from any particular sender.")]),s._v(" "),e("h3",{attrs:{id:"the-message-object"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#the-message-object"}},[s._v("#")]),s._v(" The Message object")]),s._v(" "),e("p",[s._v("The object you receive in a message handler is a "),e("code",[s._v("Message")]),s._v(".")]),s._v(" "),e("p",[s._v("The "),e("code",[s._v("body")]),s._v(" of the message corresponds to the object that was sent or\npublished.")]),s._v(" "),e("p",[s._v("The headers of the message are available with "),e("code",[s._v("headers")]),s._v(".")]),s._v(" "),e("h3",{attrs:{id:"acknowledging-messages-sending-replies"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#acknowledging-messages-sending-replies"}},[s._v("#")]),s._v(" Acknowledging messages / sending replies")]),s._v(" "),e("p",[s._v("When using "),e("code",[s._v("send")]),s._v(" the event bus attempts to deliver the message to a\n"),e("code",[s._v("MessageConsumer")]),s._v(" registered with the event bus.")]),s._v(" "),e("p",[s._v('In some cases it’s useful for the sender to know when the consumer has\nreceived the message and "processed" it using '),e("strong",[s._v("request-response")]),s._v("\npattern.")]),s._v(" "),e("p",[s._v("To acknowledge that the message has been processed, the consumer can\nreply to the message by calling "),e("code",[s._v("reply")]),s._v(".")]),s._v(" "),e("p",[s._v("When this happens it causes a reply to be sent back to the sender and\nthe reply handler is invoked with the reply.")]),s._v(" "),e("p",[s._v("An example will make this clear:")]),s._v(" "),e("p",[s._v("The receiver:")]),s._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" consumer "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" eventBus"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("consumer")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"news.uk.sport"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nconsumer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("handler")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("message")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  console"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"I have received a message: "')]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" message"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("body")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  message"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("reply")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"how interesting!"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),e("p",[s._v("The sender:")]),s._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[s._v("eventBus"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("request")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"news.uk.sport"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Yay! Someone kicked a ball across a patch of grass"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("ar")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ar"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("succeeded")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    console"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Received reply: "')]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" ar"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("result")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("body")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),e("p",[s._v("The reply can contain a message body which can contain useful\ninformation.")]),s._v(" "),e("p",[s._v('What the "processing" actually means is application-defined and depends\nentirely on what the message consumer does and is not something that the\nVert.x event bus itself knows or cares about.')]),s._v(" "),e("p",[s._v("Some examples:")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("A simple message consumer which implements a service which returns\nthe time of the day would acknowledge with a message containing the\ntime of day in the reply body")])]),s._v(" "),e("li",[e("p",[s._v("A message consumer which implements a persistent queue, might\nacknowledge with "),e("code",[s._v("true")]),s._v(" if the message was successfully persisted in\nstorage, or "),e("code",[s._v("false")]),s._v(" if not.")])]),s._v(" "),e("li",[e("p",[s._v("A message consumer which processes an order might acknowledge with\n"),e("code",[s._v("true")]),s._v(" when the order has been successfully processed so it can be\ndeleted from the database")])])]),s._v(" "),e("h3",{attrs:{id:"sending-with-timeouts"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#sending-with-timeouts"}},[s._v("#")]),s._v(" Sending with timeouts")]),s._v(" "),e("p",[s._v("When sending a message with a reply handler, you can specify a timeout\nin the "),e("code",[s._v("DeliveryOptions")]),s._v(".")]),s._v(" "),e("p",[s._v("If a reply is not received within that time, the reply handler will be\ncalled with a failure.")]),s._v(" "),e("p",[s._v("The default timeout is 30 seconds.")]),s._v(" "),e("h3",{attrs:{id:"send-failures"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#send-failures"}},[s._v("#")]),s._v(" Send Failures")]),s._v(" "),e("p",[s._v("Message sends can fail for other reasons, including:")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("There are no handlers available to send the message to")])]),s._v(" "),e("li",[e("p",[s._v("The recipient has explicitly failed the message using "),e("code",[s._v("fail")])])])]),s._v(" "),e("p",[s._v("In all cases, the reply handler will be called with the specific\nfailure.")]),s._v(" "),e("h3",{attrs:{id:"message-codecs"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#message-codecs"}},[s._v("#")]),s._v(" Message Codecs")]),s._v(" "),e("p",[s._v("You can send any object you like across the event bus if you define and\nregister a {@link io.vertx.core.eventbus.MessageCodec message codec} for\nit.")]),s._v(" "),e("p",[s._v("Message codecs have a name and you specify that name in the {@link\nio.vertx.core.eventbus.DeliveryOptions} when sending or publishing the\nmessage:")]),s._v(" "),e("div",{staticClass:"language-java extra-class"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),e("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@link")]),s._v(" docoverride"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("eventbus"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Examples")]),s._v("#example10"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),e("p",[s._v("If you always want the same codec to be used for a particular type then\nyou can register a default codec for it, then you don’t have to specify\nthe codec on each send in the delivery options:")]),s._v(" "),e("div",{staticClass:"language-java extra-class"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),e("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@link")]),s._v(" docoverride"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("eventbus"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Examples")]),s._v("#example11"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),e("p",[s._v("You unregister a message codec with {@link\nio.vertx.core.eventbus.EventBus#unregisterCodec}.")]),s._v(" "),e("p",[s._v("Message codecs don’t always have to encode and decode as the same type.\nFor example you can write a codec that allows a MyPOJO class to be sent,\nbut when that message is sent to a handler it arrives as a MyOtherPOJO\nclass.")]),s._v(" "),e("h3",{attrs:{id:"clustered-event-bus"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#clustered-event-bus"}},[s._v("#")]),s._v(" Clustered Event Bus")]),s._v(" "),e("p",[s._v("The event bus doesn’t just exist in a single Vert.x instance. By\nclustering different Vert.x instances together on your network they can\nform a single, distributed event bus.")]),s._v(" "),e("h3",{attrs:{id:"clustering-programmatically"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#clustering-programmatically"}},[s._v("#")]),s._v(" Clustering programmatically")]),s._v(" "),e("p",[s._v("If you’re creating your Vert.x instance programmatically you get a\nclustered event bus by configuring the Vert.x instance as clustered;")]),s._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" Vertx "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"@vertx/core"')]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" options "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("VertxOptions")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nVertx"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("clusteredVertx")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("options"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("res")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("res"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("succeeded")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" vertx "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" res"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("result")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" eventBus "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" vertx"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("eventBus")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    console"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"We now have a clustered event bus: "')]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" eventBus"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    console"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Failed: "')]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" res"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("cause")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),e("p",[s._v("You should also make sure you have a "),e("code",[s._v("ClusterManager")]),s._v(" implementation on\nyour classpath, for example the Hazelcast cluster manager.")]),s._v(" "),e("h3",{attrs:{id:"clustering-on-the-command-line"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#clustering-on-the-command-line"}},[s._v("#")]),s._v(" Clustering on the command line")]),s._v(" "),e("p",[s._v("You can run Vert.x clustered on the command line with")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v("vertx run my-verticle.js -cluster\n")])])]),e("h2",{attrs:{id:"automatic-clean-up-in-verticles"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#automatic-clean-up-in-verticles"}},[s._v("#")]),s._v(" Automatic clean-up in verticles")]),s._v(" "),e("p",[s._v("If you’re registering event bus handlers from inside verticles, those\nhandlers will be automatically unregistered when the verticle is\nundeployed.")]),s._v(" "),e("h1",{attrs:{id:"configuring-the-event-bus"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#configuring-the-event-bus"}},[s._v("#")]),s._v(" Configuring the event bus")]),s._v(" "),e("p",[s._v("The event bus can be configured. It is particularly useful when the\nevent bus is clustered. Under the hood the event bus uses TCP\nconnections to send and receive messages, so the {@link\nio.vertx.core.eventbus.EventBusOptions} let you configure all aspects of\nthese TCP connections. As the event bus acts as a server and client, the\nconfiguration is close to {@link io.vertx.core.net.NetClientOptions} and\n{@link io.vertx.core.net.NetServerOptions}.")]),s._v(" "),e("div",{staticClass:"language-$lang extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("{@link examples.EventBusExamples#example13}\n")])])]),e("p",[s._v("The previous snippet depicts how you can use SSL connections for the\nevent bus, instead of plain TCP connections.")]),s._v(" "),e("p",[e("strong",[s._v("WARNING")]),s._v(": to enforce the security in clustered mode, you "),e("strong",[s._v("must")]),s._v("\nconfigure the cluster manager to use encryption or enforce security.\nRefer to the documentation of the cluster manager for further details.")]),s._v(" "),e("p",[s._v("The event bus configuration needs to be consistent in all the cluster\nnodes.")]),s._v(" "),e("p",[s._v("The {@link io.vertx.core.eventbus.EventBusOptions} also lets you specify\nwhether or not the event bus is clustered, the port and host.")]),s._v(" "),e("p",[s._v("When used in containers, you can also configure the public host and\nport:")]),s._v(" "),e("div",{staticClass:"language-$lang extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("{@link examples.EventBusExamples#example14}\n")])])])])}),[],!1,null,null,null);t.default=n.exports}}]);