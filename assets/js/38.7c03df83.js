(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{251:function(t,a,s){"use strict";s.r(a);var e=s(28),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"mongo-auth-provider-implementation"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mongo-auth-provider-implementation"}},[t._v("#")]),t._v(" Mongo Auth Provider implementation")]),t._v(" "),s("p",[t._v("We provide an implementation of "),s("code",[t._v("AuthProvider")]),t._v(" which uses the Vert.x\n"),s("code",[t._v("MongoClient")]),t._v(" to perform authentication and authorisation against a\nMongoDb.")]),t._v(" "),s("p",[t._v("To use this project, add the following dependency to the "),s("em",[t._v("dependencies")]),t._v("\nsection of your build descriptor:")]),t._v(" "),s("ul",[s("li",[t._v("Maven (in your "),s("code",[t._v("pom.xml")]),t._v("):")])]),t._v(" "),s("div",{staticClass:"language-xml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("io.vertx"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("vertx-auth-mongo"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("${maven.version}"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("ul",[s("li",[t._v("Gradle (in your "),s("code",[t._v("build.gradle")]),t._v(" file):")])]),t._v(" "),s("div",{staticClass:"language-groovy extra-class"},[s("pre",{pre:!0,attrs:{class:"language-groovy"}},[s("code",[t._v("compile "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'io.vertx:vertx-auth-mongo:${maven.version}'")]),t._v("\n")])])]),s("p",[t._v("To create an instance you first need an instance of "),s("code",[t._v("MongoClient")]),t._v(". To\nlearn how to create one of those please consult the documentation for\nthe MongoClient.")]),t._v(" "),s("p",[t._v("Once you’ve got one of those you can create a "),s("code",[t._v("MongoAuth")]),t._v(" instance as\nfollows:")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" MongoClient "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"@vertx/mongo-client"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" MongoAuth "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"@vertx/auth-mongo"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" client "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" MongoClient"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createShared")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vertx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" mongoClientConfig"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" authProperties "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" authProvider "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" MongoAuth"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("create")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("client"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" authProperties"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("Once you’ve got your instance you can authenticate and authorise with it\njust like any "),s("code",[t._v("AuthProvider")]),t._v(".")]),t._v(" "),s("p",[t._v('The out of the box config assumes the usage of the collection with name\n"user", the username stored and read by field "username" some others.')]),t._v(" "),s("p",[t._v('In order to avoid duplicates of user names your "user" collection should\nhave a unique index on "username". In order to do this you should run\nthe following snippet on your mongo server:')]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[t._v("db.user.createIndex( { username: 1 }, { unique: true } )\n")])])]),s("p",[t._v("The reason you should add the index is that due to the nature of mongo\ndoing a query first to verify if a username is already taken and then\ninsert a document cannot be run as an atomic action. Using the index the\ncode will try to insert the row and fail if duplicate.")]),t._v(" "),s("p",[t._v("You can also change all the defaults for the mongo collection and column\nnames using any of the methods:")]),t._v(" "),s("p",[s("code",[t._v("setCollectionName")]),t._v(" "),s("code",[t._v("setUsernameField")]),t._v(" "),s("code",[t._v("setPasswordField")]),t._v(" "),s("code",[t._v("setPermissionField")]),t._v(" "),s("code",[t._v("setRoleField")]),t._v(" if you want to adapt that to your\nneeds.")]),t._v(" "),s("p",[t._v("The default implementation assumes that the password is stored in the\ndatabase as a SHA-512 hash after being concatenated with a salt. It also\nassumes the salt is stored in the table too. The field, where the salt\nis stored can be set by "),s("code",[t._v("setSaltField")]),t._v(', the default is "salt". You are\nable to change this behaviour by using '),s("code",[t._v("setSaltStyle")]),t._v(". The HashStrategy\nyou can retrieve by "),s("code",[t._v("getHashStrategy")]),t._v(". By using this, you are able to\nset: "),s("code",[t._v("NO_SALT")]),t._v(" by which passwords are not crypted and stored in\ncleartext. ( see the warning below! ) "),s("code",[t._v("COLUMN")]),t._v(", which will create a\nsalt per user and store this inside the defined column of the user. (\nsee the warning below! ) "),s("code",[t._v("EXTERNAL")]),t._v(", which will store only the crypted\npassword in the database and will use a salt from external, which you\nwill have to set by "),s("code",[t._v("setExternalSalt")])]),t._v(" "),s("p",[t._v("If you want to override this behaviour you can do so by providing an\nalternative hash strategy and setting it with "),s("code",[t._v("setHashStrategy")])]),t._v(" "),s("blockquote",[s("p",[s("strong",[t._v("Warning")])]),t._v(" "),s("p",[t._v("It is strongly advised to use the "),s("code",[t._v("EXTERNAL")]),t._v(" option. The NO_SALT\noption is existing for development phase only and even the COLUMN\noption is not recommended, cause salt and password are stored inside\nthe same place!")])]),t._v(" "),s("blockquote",[s("p",[s("strong",[t._v("Warning")])]),t._v(" "),s("p",[t._v("As of 2018 OWASP recommends the usage of stronger encryption\nalgorithms to hash user passwords for this case you can change from\nthe default (preserved for backwards-compatibility) to PBKDF2. For new\nprojects this should be the standard.")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" MongoClient "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"@vertx/mongo-client"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" MongoAuth "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"@vertx/auth-mongo"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" client "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" MongoClient"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createShared")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vertx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" mongoClientConfig"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" authProperties "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" authProvider "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" MongoAuth"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("create")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("client"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" authProperties"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nauthProvider"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setHashAlgorithm")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'PBKDF2'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h1",{attrs:{id:"vertx-auth-jdbc-and-gdpr"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#vertx-auth-jdbc-and-gdpr"}},[t._v("#")]),t._v(" Vertx Auth JDBC and GDPR")]),t._v(" "),s("p",[t._v("GDPR is a regulation from the common European Union law. It\noverrides/supercedes national data protection laws and extents the\npreviously existing directives. This section of the manual is by no\nmeans a thorough walkthrough of the regulation, it is just a small\nsummary how this component adheres to the requirements. Companies not\nadhering to the equirements can be fined on 4% of the turnover or 20\nmillion euro. Therefore we want to make sure that as a user of Vert.x\nAuth JDBC you’re are on the good track to comply.")]),t._v(" "),s("p",[t._v("The law defines certain terminology:")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("Data Subject - Person whose personal data is processed (e.g.: User)")])]),t._v(" "),s("li",[s("p",[t._v("Personal Data - Any data about an identifiable or identified person")])]),t._v(" "),s("li",[s("p",[t._v("Data Processing - Any operation (manual or automated) on personal\ndata")])]),t._v(" "),s("li",[s("p",[t._v("Controller - The entity (company) that requests and uses the data")])]),t._v(" "),s("li",[s("p",[t._v("Processors - Any entity that processes data on behalf of a\ncontroller (e.g.: cloud service provider)")])])]),t._v(" "),s("p",[t._v("GDPR defines the following functionality:")]),t._v(" "),s("ul",[s("li",[s("p",[t._v('"Forget me" - Right to erasure')])]),t._v(" "),s("li",[s("p",[t._v("Mark profile as restricted - Right to restriction of processing")])]),t._v(" "),s("li",[s("p",[t._v("Export data - Right to portability")])]),t._v(" "),s("li",[s("p",[t._v("Allow profile editing - Right to rectification")])]),t._v(" "),s("li",[s("p",[t._v("See all my data - Right to access")])]),t._v(" "),s("li",[s("p",[t._v("Consent checkboxes")])]),t._v(" "),s("li",[s("p",[t._v("Age checks")])]),t._v(" "),s("li",[s("p",[t._v("Data destruction - Data minimization principle")])])]),t._v(" "),s("p",[t._v("This module complies to the GDPR law by not storing any identifiable\ninformation about a data subject. The only reference is the username\nwhich is not linked to any personal data.")]),t._v(" "),s("p",[t._v("In order to add personal data to your application you should create your\nown data schema and use the username column as a reference to your data.\nAs a tip you should have a boolean flag to mark the personal data as\nrestricted to comply to the right to restriction of processing which\nmeans that if you need to handle the data, e.g.: send a bulk email from\na mailing list you are not allowed to do so if the flag is true.")]),t._v(" "),s("p",[t._v("The right to erasure does not mean that you must wipe all records from\nyour application, e.g.: in a bank this right cannot be used to erase a\nrunning loan or debt. You are allowed to keep your application data but\nmust erase the personal data. In case of Vert.x Auth JDBC you should\ndelete your table but can still use a reference to the username as long\nas is not possible to link the username to the personal data.")]),t._v(" "),s("p",[t._v("Important note is that this must survive backups! As a tip backup the\ndata, and data erasure on different archives so they can be replayed\nindividually.")]),t._v(" "),s("h1",{attrs:{id:"authentication"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#authentication"}},[t._v("#")]),t._v(" Authentication")]),t._v(" "),s("p",[t._v("When authenticating using this implementation, it assumes "),s("code",[t._v("username")]),t._v(" and\n"),s("code",[t._v("password")]),t._v(" fields are present in the authentication info:")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" authInfo "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"username"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"tim"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"password"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"sausages"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nauthProvider"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("authenticate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("authInfo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("res")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("succeeded")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" user "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("result")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Failed!")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("Instead of the "),s("code",[t._v("username")]),t._v(" and "),s("code",[t._v("password")]),t._v(" field names used in the\nprevious snippet, you should use: "),s("code",[t._v("setUsernameCredentialField")]),t._v(" and\n"),s("code",[t._v("setPasswordCredentialField")])]),t._v(" "),s("h1",{attrs:{id:"authorisation-permission-role-model"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#authorisation-permission-role-model"}},[t._v("#")]),t._v(" Authorisation - Permission-Role Model")]),t._v(" "),s("p",[t._v("Although Vert.x auth itself does not mandate any specific model of\npermissions (they are just opaque strings), this implementation assumes\na familiar user/role/permission model, where a user can have zero or\nmore roles and a role can have zero or more permissions.")]),t._v(" "),s("p",[t._v("If validating if a user has a particular permission simply pass the\npermission into. "),s("code",[t._v("isAuthorised")]),t._v(" as follows:")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("user"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("isAuthorized")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"commit_code"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("res")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("succeeded")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" hasPermission "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("result")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Failed to")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("If validating that a user has a particular "),s("em",[t._v("role")]),t._v(" then you should prefix\nthe argument with the role prefix.")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" MongoAuth "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"@vertx/auth-mongo"')]),t._v("\n\nuser"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("isAuthorized")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MongoAuth"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("ROLE_PREFIX")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"manager"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("res")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("succeeded")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" hasRole "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("result")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Failed to")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])])}),[],!1,null,null,null);a.default=n.exports}}]);