<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ES for Eclipse Vert.x</title>
    <meta name="description" content="A Modern JavaScript runtime for Eclipse Vert.x">
    <meta name="generator" content="VuePress 1.3.1">
    <link rel="shortcut icon" type="image/png" href="/es4x/favicon.png">
  <link rel="stylesheet" type="text/css" href="/es4x/player/asciinema-player.css">
  <script src="/es4x/player/asciinema-player.js"></script>
    
    <link rel="preload" href="/es4x/assets/css/0.styles.93ea0277.css" as="style"><link rel="preload" href="/es4x/assets/js/app.45f626e2.js" as="script"><link rel="preload" href="/es4x/assets/js/2.9528bf06.js" as="script"><link rel="preload" href="/es4x/assets/js/122.efa391c4.js" as="script"><link rel="prefetch" href="/es4x/assets/js/10.4e356b44.js"><link rel="prefetch" href="/es4x/assets/js/100.cf2ccba6.js"><link rel="prefetch" href="/es4x/assets/js/101.8c6eded7.js"><link rel="prefetch" href="/es4x/assets/js/102.8f2e6411.js"><link rel="prefetch" href="/es4x/assets/js/103.d72d2546.js"><link rel="prefetch" href="/es4x/assets/js/104.03ea6f93.js"><link rel="prefetch" href="/es4x/assets/js/105.97bae8c0.js"><link rel="prefetch" href="/es4x/assets/js/106.9a2e2ca0.js"><link rel="prefetch" href="/es4x/assets/js/107.aeb22b58.js"><link rel="prefetch" href="/es4x/assets/js/108.bae986db.js"><link rel="prefetch" href="/es4x/assets/js/109.2b947af9.js"><link rel="prefetch" href="/es4x/assets/js/11.6cb08ab3.js"><link rel="prefetch" href="/es4x/assets/js/110.c71e71a1.js"><link rel="prefetch" href="/es4x/assets/js/111.593de263.js"><link rel="prefetch" href="/es4x/assets/js/112.0670c01a.js"><link rel="prefetch" href="/es4x/assets/js/113.53d46a58.js"><link rel="prefetch" href="/es4x/assets/js/114.c5556463.js"><link rel="prefetch" href="/es4x/assets/js/115.5743b73f.js"><link rel="prefetch" href="/es4x/assets/js/116.b7169463.js"><link rel="prefetch" href="/es4x/assets/js/117.94d01670.js"><link rel="prefetch" href="/es4x/assets/js/118.19a97283.js"><link rel="prefetch" href="/es4x/assets/js/119.d3fd593f.js"><link rel="prefetch" href="/es4x/assets/js/12.462e9a0b.js"><link rel="prefetch" href="/es4x/assets/js/120.ff97e661.js"><link rel="prefetch" href="/es4x/assets/js/121.1f1ea408.js"><link rel="prefetch" href="/es4x/assets/js/123.8176ba1b.js"><link rel="prefetch" href="/es4x/assets/js/124.f3b0f209.js"><link rel="prefetch" href="/es4x/assets/js/125.b11510bd.js"><link rel="prefetch" href="/es4x/assets/js/126.220618b5.js"><link rel="prefetch" href="/es4x/assets/js/127.1cd7573a.js"><link rel="prefetch" href="/es4x/assets/js/128.25319ee3.js"><link rel="prefetch" href="/es4x/assets/js/129.dc2cd690.js"><link rel="prefetch" href="/es4x/assets/js/13.86534a95.js"><link rel="prefetch" href="/es4x/assets/js/130.c8eab2ac.js"><link rel="prefetch" href="/es4x/assets/js/131.38e243ce.js"><link rel="prefetch" href="/es4x/assets/js/132.7b5be48d.js"><link rel="prefetch" href="/es4x/assets/js/133.c4a3d298.js"><link rel="prefetch" href="/es4x/assets/js/134.0a4d935c.js"><link rel="prefetch" href="/es4x/assets/js/135.366362b3.js"><link rel="prefetch" href="/es4x/assets/js/136.08fa614d.js"><link rel="prefetch" href="/es4x/assets/js/137.0cb036fd.js"><link rel="prefetch" href="/es4x/assets/js/138.467d7d28.js"><link rel="prefetch" href="/es4x/assets/js/139.cb378fe8.js"><link rel="prefetch" href="/es4x/assets/js/14.1906865f.js"><link rel="prefetch" href="/es4x/assets/js/140.36143b91.js"><link rel="prefetch" href="/es4x/assets/js/141.ed806584.js"><link rel="prefetch" href="/es4x/assets/js/142.13516e41.js"><link rel="prefetch" href="/es4x/assets/js/143.28297a8b.js"><link rel="prefetch" href="/es4x/assets/js/144.66f8db50.js"><link rel="prefetch" href="/es4x/assets/js/145.6da12fa8.js"><link rel="prefetch" href="/es4x/assets/js/146.d112bce8.js"><link rel="prefetch" href="/es4x/assets/js/147.7d52db6c.js"><link rel="prefetch" href="/es4x/assets/js/148.0fca2378.js"><link rel="prefetch" href="/es4x/assets/js/149.978c6cc9.js"><link rel="prefetch" href="/es4x/assets/js/15.7354219e.js"><link rel="prefetch" href="/es4x/assets/js/150.ca96a809.js"><link rel="prefetch" href="/es4x/assets/js/151.d272996f.js"><link rel="prefetch" href="/es4x/assets/js/152.9dbcc7b6.js"><link rel="prefetch" href="/es4x/assets/js/153.cf8da14b.js"><link rel="prefetch" href="/es4x/assets/js/154.ed046717.js"><link rel="prefetch" href="/es4x/assets/js/155.2b58da6a.js"><link rel="prefetch" href="/es4x/assets/js/156.fbc8b7da.js"><link rel="prefetch" href="/es4x/assets/js/157.0b67f2b3.js"><link rel="prefetch" href="/es4x/assets/js/158.dfe2036c.js"><link rel="prefetch" href="/es4x/assets/js/159.3e734a3c.js"><link rel="prefetch" href="/es4x/assets/js/16.e1582919.js"><link rel="prefetch" href="/es4x/assets/js/160.22aec581.js"><link rel="prefetch" href="/es4x/assets/js/161.83304a96.js"><link rel="prefetch" href="/es4x/assets/js/162.2e66100b.js"><link rel="prefetch" href="/es4x/assets/js/163.b623a314.js"><link rel="prefetch" href="/es4x/assets/js/164.c60e6322.js"><link rel="prefetch" href="/es4x/assets/js/165.9f3eb69b.js"><link rel="prefetch" href="/es4x/assets/js/17.54bde0b4.js"><link rel="prefetch" href="/es4x/assets/js/18.b5c20f2c.js"><link rel="prefetch" href="/es4x/assets/js/19.055d91ed.js"><link rel="prefetch" href="/es4x/assets/js/20.2a1467f5.js"><link rel="prefetch" href="/es4x/assets/js/21.351d0112.js"><link rel="prefetch" href="/es4x/assets/js/22.d7f7da51.js"><link rel="prefetch" href="/es4x/assets/js/23.8c7fdb15.js"><link rel="prefetch" href="/es4x/assets/js/24.e10c3043.js"><link rel="prefetch" href="/es4x/assets/js/25.c430d31f.js"><link rel="prefetch" href="/es4x/assets/js/26.16bd25ee.js"><link rel="prefetch" href="/es4x/assets/js/27.9eae56e3.js"><link rel="prefetch" href="/es4x/assets/js/28.7328b6a0.js"><link rel="prefetch" href="/es4x/assets/js/29.acbccb35.js"><link rel="prefetch" href="/es4x/assets/js/3.ea01a935.js"><link rel="prefetch" href="/es4x/assets/js/30.54c5acd8.js"><link rel="prefetch" href="/es4x/assets/js/31.be66d5df.js"><link rel="prefetch" href="/es4x/assets/js/32.65ce4eb7.js"><link rel="prefetch" href="/es4x/assets/js/33.ae2a52a4.js"><link rel="prefetch" href="/es4x/assets/js/34.0ad20f26.js"><link rel="prefetch" href="/es4x/assets/js/35.bb3728a5.js"><link rel="prefetch" href="/es4x/assets/js/36.0d06c159.js"><link rel="prefetch" href="/es4x/assets/js/37.b5eb90bc.js"><link rel="prefetch" href="/es4x/assets/js/38.96c660f9.js"><link rel="prefetch" href="/es4x/assets/js/39.41e1b587.js"><link rel="prefetch" href="/es4x/assets/js/4.fc776d3f.js"><link rel="prefetch" href="/es4x/assets/js/40.d0a26be1.js"><link rel="prefetch" href="/es4x/assets/js/41.59d59cd8.js"><link rel="prefetch" href="/es4x/assets/js/42.b78cae14.js"><link rel="prefetch" href="/es4x/assets/js/43.912b9356.js"><link rel="prefetch" href="/es4x/assets/js/44.e13ccccc.js"><link rel="prefetch" href="/es4x/assets/js/45.3ef02006.js"><link rel="prefetch" href="/es4x/assets/js/46.faa0287b.js"><link rel="prefetch" href="/es4x/assets/js/47.b487ba0e.js"><link rel="prefetch" href="/es4x/assets/js/48.ae8f3a89.js"><link rel="prefetch" href="/es4x/assets/js/49.83e2beca.js"><link rel="prefetch" href="/es4x/assets/js/5.2d4d3e75.js"><link rel="prefetch" href="/es4x/assets/js/50.5e1d5ffb.js"><link rel="prefetch" href="/es4x/assets/js/51.ff2c55ca.js"><link rel="prefetch" href="/es4x/assets/js/52.2ab6b963.js"><link rel="prefetch" href="/es4x/assets/js/53.003dce91.js"><link rel="prefetch" href="/es4x/assets/js/54.2f1ec2ff.js"><link rel="prefetch" href="/es4x/assets/js/55.27fcc794.js"><link rel="prefetch" href="/es4x/assets/js/56.f1494ba7.js"><link rel="prefetch" href="/es4x/assets/js/57.3dc75b31.js"><link rel="prefetch" href="/es4x/assets/js/58.ad7c5835.js"><link rel="prefetch" href="/es4x/assets/js/59.15c22822.js"><link rel="prefetch" href="/es4x/assets/js/6.08d23168.js"><link rel="prefetch" href="/es4x/assets/js/60.d88cd9dd.js"><link rel="prefetch" href="/es4x/assets/js/61.7f160678.js"><link rel="prefetch" href="/es4x/assets/js/62.a37de390.js"><link rel="prefetch" href="/es4x/assets/js/63.5d41db03.js"><link rel="prefetch" href="/es4x/assets/js/64.ef0f557b.js"><link rel="prefetch" href="/es4x/assets/js/65.82c56c7b.js"><link rel="prefetch" href="/es4x/assets/js/66.5db98484.js"><link rel="prefetch" href="/es4x/assets/js/67.1908aa6a.js"><link rel="prefetch" href="/es4x/assets/js/68.d7f74580.js"><link rel="prefetch" href="/es4x/assets/js/69.0d374e99.js"><link rel="prefetch" href="/es4x/assets/js/7.39a683cb.js"><link rel="prefetch" href="/es4x/assets/js/70.73111967.js"><link rel="prefetch" href="/es4x/assets/js/71.962e5b0d.js"><link rel="prefetch" href="/es4x/assets/js/72.e26b7b02.js"><link rel="prefetch" href="/es4x/assets/js/73.f9e5cfa0.js"><link rel="prefetch" href="/es4x/assets/js/74.63ba0b89.js"><link rel="prefetch" href="/es4x/assets/js/75.fa4a1977.js"><link rel="prefetch" href="/es4x/assets/js/76.3917601b.js"><link rel="prefetch" href="/es4x/assets/js/77.955be584.js"><link rel="prefetch" href="/es4x/assets/js/78.889ea1de.js"><link rel="prefetch" href="/es4x/assets/js/79.571498d4.js"><link rel="prefetch" href="/es4x/assets/js/8.3fc576d4.js"><link rel="prefetch" href="/es4x/assets/js/80.6adfce5e.js"><link rel="prefetch" href="/es4x/assets/js/81.d6ddc5b3.js"><link rel="prefetch" href="/es4x/assets/js/82.13fefac4.js"><link rel="prefetch" href="/es4x/assets/js/83.dfe401bf.js"><link rel="prefetch" href="/es4x/assets/js/84.cfff53fa.js"><link rel="prefetch" href="/es4x/assets/js/85.0f669957.js"><link rel="prefetch" href="/es4x/assets/js/86.1ea59e44.js"><link rel="prefetch" href="/es4x/assets/js/87.505880b7.js"><link rel="prefetch" href="/es4x/assets/js/88.b3b56624.js"><link rel="prefetch" href="/es4x/assets/js/89.7d996ac0.js"><link rel="prefetch" href="/es4x/assets/js/9.c659cef0.js"><link rel="prefetch" href="/es4x/assets/js/90.17d5c851.js"><link rel="prefetch" href="/es4x/assets/js/91.09fa57b1.js"><link rel="prefetch" href="/es4x/assets/js/92.9a5f5d37.js"><link rel="prefetch" href="/es4x/assets/js/93.9d0cf327.js"><link rel="prefetch" href="/es4x/assets/js/94.87202bb5.js"><link rel="prefetch" href="/es4x/assets/js/95.d8625634.js"><link rel="prefetch" href="/es4x/assets/js/96.c761c159.js"><link rel="prefetch" href="/es4x/assets/js/97.e8755c70.js"><link rel="prefetch" href="/es4x/assets/js/98.49262cb9.js"><link rel="prefetch" href="/es4x/assets/js/99.d62e0c5e.js">
    <link rel="stylesheet" href="/es4x/assets/css/0.styles.93ea0277.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/es4x/" class="home-link router-link-active"><!----> <span class="site-name">ES for Eclipse Vert.x</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/es4x/get-started/" class="nav-link">
  Get started
</a></div><div class="nav-item"><a href="/es4x/advanced/" class="nav-link">
  Advanced
</a></div><div class="nav-item"><a href="/es4x/manual/" class="nav-link router-link-active">
  Manual
</a></div><div class="nav-item"><a href="/es4x/api/" class="nav-link">
  APIs
</a></div><div class="nav-item"><a href="https://github.com/reactiverse/es4x/blob/master/CHANGELOG.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Changelog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/es4x/manual/@vertx/shell/" class="nav-link router-link-exact-active router-link-active">
  English
</a></li><li class="dropdown-item"><!----> <a href="/es4x/zh/" class="nav-link">
  简体中文
</a></li><li class="dropdown-item"><!----> <a href="/es4x/pt/" class="nav-link">
  Português
</a></li></ul></div></div> <a href="https://github.com/reactiverse/es4x" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/es4x/get-started/" class="nav-link">
  Get started
</a></div><div class="nav-item"><a href="/es4x/advanced/" class="nav-link">
  Advanced
</a></div><div class="nav-item"><a href="/es4x/manual/" class="nav-link router-link-active">
  Manual
</a></div><div class="nav-item"><a href="/es4x/api/" class="nav-link">
  APIs
</a></div><div class="nav-item"><a href="https://github.com/reactiverse/es4x/blob/master/CHANGELOG.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Changelog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/es4x/manual/@vertx/shell/" class="nav-link router-link-exact-active router-link-active">
  English
</a></li><li class="dropdown-item"><!----> <a href="/es4x/zh/" class="nav-link">
  简体中文
</a></li><li class="dropdown-item"><!----> <a href="/es4x/pt/" class="nav-link">
  Português
</a></li></ul></div></div> <a href="https://github.com/reactiverse/es4x" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Manuals</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/es4x/manual/" class="sidebar-link">API Reference Manuals</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p>Vert.x Shell is a command line interface for the Vert.x runtime
available from regular terminals using different protocols.</p> <p>Vert.x Shell provides a variety of commands for interacting live with
Vert.x services.</p> <p>Vert.x Shell can be extended with custom commands in any language
supported by Vert.x</p> <h1 id="using-vert-x-shell"><a href="#using-vert-x-shell" class="header-anchor">#</a> Using Vert.x Shell</h1> <p>Vert.x Shell is a Vert.x Service and can be started programmatically via
the <code>ShellService</code> or deployed as a service.</p> <h2 id="shell-service"><a href="#shell-service" class="header-anchor">#</a> Shell service</h2> <p>The shell can be started as a service directly either from the command
line or as a the Vert.x deployment:</p> <p><strong>Starting a shell service available via Telnet.</strong></p> <div class="language- extra-class"><pre><code>vertx run -conf '{&quot;telnetOptions&quot;:{&quot;port&quot;:5000}}' maven:io.vertx:vertx-shell:${maven.version}
</code></pre></div><p>or</p> <p><strong>Starting a shell service available via SSH.</strong></p> <div class="language- extra-class"><pre><code># create a key pair for the SSH server
keytool -genkey -keyalg RSA -keystore ssh.jks -keysize 2048 -validity 1095 -dname CN=localhost -keypass secret -storepass secret
# create the auth config
echo user.admin=password &gt; auth.properties
# start the shell
vertx run -conf '{&quot;sshOptions&quot;:{&quot;port&quot;:4000,&quot;keyPairOptions&quot;:{&quot;path&quot;:&quot;ssh.jks&quot;,&quot;password&quot;:&quot;secret&quot;},&quot;authOptions&quot;:{&quot;provider&quot;:&quot;shiro&quot;,&quot;config&quot;:{&quot;properties_path&quot;:&quot;file:auth.properties&quot;}}}}' maven:io.vertx:vertx-shell:${maven.version}
</code></pre></div><p>or</p> <p><strong>Starting a shell service available via HTTP.</strong></p> <div class="language- extra-class"><pre><code># create a certificate for the HTTP server
keytool -genkey -keyalg RSA -keystore keystore.jks -keysize 2048 -validity 1095 -dname CN=localhost -keypass secret -storepass secret
# create the auth config
echo user.admin=password &gt; auth.properties
vertx run -conf '{&quot;httpOptions&quot;:{&quot;port&quot;:8080,&quot;ssl&quot;:true,&quot;keyStoreOptions&quot;:{&quot;path&quot;:&quot;keystore.jks&quot;,&quot;password&quot;:&quot;secret&quot;},&quot;authOptions&quot;:{&quot;provider&quot;:&quot;&quot;shiro,&quot;config&quot;:{&quot;properties_path&quot;:&quot;file:auth.properties&quot;}}}}' maven:io.vertx:vertx-shell:${maven.version}
</code></pre></div><p>You can also deploy this service inside your own verticle:</p> <div class="language-js extra-class"><pre class="language-js"><code>vertx<span class="token punctuation">.</span><span class="token function">deployVerticle</span><span class="token punctuation">(</span><span class="token string">&quot;maven:{maven-groupId}:{maven-artifactId}:{maven-version}&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">DeploymentOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string">&quot;telnetOptions&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;host&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;localhost&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;port&quot;</span> <span class="token operator">:</span> <span class="token number">4000</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>or</p> <div class="language-js extra-class"><pre class="language-js"><code>vertx<span class="token punctuation">.</span><span class="token function">deployVerticle</span><span class="token punctuation">(</span><span class="token string">&quot;maven:{maven-groupId}:{maven-artifactId}:{maven-version}&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">DeploymentOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string">&quot;sshOptions&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;host&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;localhost&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;port&quot;</span> <span class="token operator">:</span> <span class="token number">5000</span><span class="token punctuation">,</span>
      <span class="token string">&quot;keyPairOptions&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;path&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;src/test/resources/ssh.jks&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;password&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;wibble&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token string">&quot;authOptions&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;provider&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;shiro&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;config&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token string">&quot;properties_path&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;file:/path/to/my/auth.properties&quot;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>or</p> <div class="language-js extra-class"><pre class="language-js"><code>vertx<span class="token punctuation">.</span><span class="token function">deployVerticle</span><span class="token punctuation">(</span><span class="token string">&quot;maven:{maven-groupId}:{maven-artifactId}:{maven-version}&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">DeploymentOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string">&quot;httpOptions&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;host&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;localhost&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;port&quot;</span> <span class="token operator">:</span> <span class="token number">8080</span><span class="token punctuation">,</span>
      <span class="token string">&quot;ssl&quot;</span> <span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token string">&quot;keyPairOptions&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;path&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;src/test/resources/server-keystore.jks&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;password&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;wibble&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token string">&quot;authOptions&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;provider&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;shiro&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;config&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token string">&quot;properties_path&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;file:/path/to/my/auth.properties&quot;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p><strong>Note</strong></p> <p>when Vert.x Shell is already on your classpath you can use
<code>service:io.vertx.ext.shell</code> instead or
<code>maven:io.vertx:vertx-shell:${maven.version}</code></p></blockquote> <h2 id="programmatic-service"><a href="#programmatic-service" class="header-anchor">#</a> Programmatic service</h2> <p>The <code>ShellService</code> takes care of starting an instance of Vert.x Shell.</p> <p>Starting a shell service available via SSH:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> ShellService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@vertx/shell&quot;</span>
<span class="token keyword">let</span> service <span class="token operator">=</span> ShellService<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>vertx<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">ShellServiceOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setSSHOptions</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">SSHTermOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setHost</span><span class="token punctuation">(</span><span class="token string">&quot;localhost&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setPort</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setKeyPairOptions</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">JksOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">setPath</span><span class="token punctuation">(</span><span class="token string">&quot;server-keystore.jks&quot;</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">&quot;wibble&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setAuthOptions</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ShiroAuthOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">setType</span><span class="token punctuation">(</span><span class="token string">&quot;PROPERTIES&quot;</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">setConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token string">&quot;properties_path&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;file:/path/to/my/auth.properties&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
service<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Starting a shell service available via Telnet:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> ShellService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@vertx/shell&quot;</span>
<span class="token keyword">let</span> service <span class="token operator">=</span> ShellService<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>vertx<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">ShellServiceOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setTelnetOptions</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">TelnetTermOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setHost</span><span class="token punctuation">(</span><span class="token string">&quot;localhost&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setPort</span><span class="token punctuation">(</span><span class="token number">4000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
service<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The <code>TelnetTermOptions</code> extends the Vert.x Core <code>NetServerOptions</code> as
the Telnet server implementation is based on a <code>NetServer</code>.</p> <blockquote><p><strong>Caution</strong></p> <p>Telnet does not provide any authentication nor encryption at all.</p></blockquote> <p>Starting a shell service available via HTTP:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> ShellService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@vertx/shell&quot;</span>
<span class="token keyword">let</span> service <span class="token operator">=</span> ShellService<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>vertx<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">ShellServiceOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setHttpOptions</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HttpTermOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setHost</span><span class="token punctuation">(</span><span class="token string">&quot;localhost&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setPort</span><span class="token punctuation">(</span><span class="token number">8080</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
service<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h1 id="authentication"><a href="#authentication" class="header-anchor">#</a> Authentication</h1> <p>The SSH and HTTP connectors provide both authentication built on top of
<em>vertx-auth</em> with the following supported providers:</p> <ul><li><p><em>shiro</em> : provides <code>.properties</code> and <em>LDAP</em> backend as seen in the
ShellService presentation</p></li> <li><p><em>jdbc</em> : JDBC backend</p></li> <li><p><em>mongo</em> : MongoDB backend</p></li></ul> <p>These options can be created directly using directly <code>AuthOptions</code>:</p> <ul><li><p><code>ShiroAuthOptions</code> for Shiro</p></li> <li><p><code>JDBCAuthOptions</code> for JDBC</p></li> <li><p><code>MongoAuthOptions</code> for Mongo</p></li></ul> <p>As for external service configuration in Json, the <code>authOptions</code> uses
the <code>provider</code> property to distinguish:</p> <div class="language- extra-class"><pre><code>{
 ...
 &quot;authOptions&quot;: {
   &quot;provider&quot;:&quot;shiro&quot;,
   &quot;config&quot;: {
     &quot;properties_path&quot;:&quot;file:auth.properties&quot;
   }
 }
 ...
}
</code></pre></div><h1 id="telnet-term-configuration"><a href="#telnet-term-configuration" class="header-anchor">#</a> Telnet term configuration</h1> <p>Telnet terms are configured by <code>setTelnetOptions</code>, the
<code>TelnetTermOptions</code> extends the <code>NetServerOptions</code> so they have the
exact same configuration.</p> <h1 id="ssh-term-configuration"><a href="#ssh-term-configuration" class="header-anchor">#</a> SSH term configuration</h1> <p>SSH terms are configured by <code>setSSHOptions</code>:</p> <ul><li><p><code>setPort</code>: port</p></li> <li><p><code>setHost</code>: host</p></li></ul> <p>Only username/password authentication is supported at the moment, it can
be configured with property file or LDAP, see Vert.x Auth for more info:</p> <ul><li><code>setAuthOptions</code>: configures user authentication</li></ul> <p>The server key configuration reuses the key pair store configuration
scheme provided by <em>Vert.x Core</em>:</p> <ul><li><p><code>setKeyPairOptions</code>: set <code>.jks</code> key pair store</p></li> <li><p><code>setPfxKeyPairOptions</code>: set <code>.pfx</code> key pair store</p></li> <li><p><code>setPemKeyPairOptions</code>: set <code>.pem</code> key pair store</p></li></ul> <p><strong>Deploying the Shell Service on SSH with Mongo authentication.</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>vertx<span class="token punctuation">.</span><span class="token function">deployVerticle</span><span class="token punctuation">(</span><span class="token string">&quot;maven:{maven-groupId}:{maven-artifactId}:{maven-version}&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">DeploymentOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string">&quot;sshOptions&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;host&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;localhost&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;port&quot;</span> <span class="token operator">:</span> <span class="token number">5000</span><span class="token punctuation">,</span>
      <span class="token string">&quot;keyPairOptions&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;path&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;src/test/resources/ssh.jks&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;password&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;wibble&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token string">&quot;authOptions&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;provider&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;mongo&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;config&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token string">&quot;connection_string&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;mongodb://localhost:27018&quot;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>Running the Shell Service on SSH with Mongo authentication.</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> ShellService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@vertx/shell&quot;</span>
<span class="token keyword">let</span> service <span class="token operator">=</span> ShellService<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>vertx<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">ShellServiceOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setSSHOptions</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">SSHTermOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setHost</span><span class="token punctuation">(</span><span class="token string">&quot;localhost&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setPort</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setKeyPairOptions</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">JksOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">setPath</span><span class="token punctuation">(</span><span class="token string">&quot;server-keystore.jks&quot;</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">&quot;wibble&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setAuthOptions</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MongoAuthOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">setConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token string">&quot;connection_string&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;mongodb://localhost:27018&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
service<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>Deploying the Shell Service on SSH with JDBC authentication.</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>vertx<span class="token punctuation">.</span><span class="token function">deployVerticle</span><span class="token punctuation">(</span><span class="token string">&quot;maven:{maven-groupId}:{maven-artifactId}:{maven-version}&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">DeploymentOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string">&quot;sshOptions&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;host&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;localhost&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;port&quot;</span> <span class="token operator">:</span> <span class="token number">5000</span><span class="token punctuation">,</span>
      <span class="token string">&quot;keyPairOptions&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;path&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;src/test/resources/ssh.jks&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;password&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;wibble&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token string">&quot;authOptions&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;provider&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;jdbc&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;config&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token string">&quot;url&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;jdbc:hsqldb:mem:test?shutdown=true&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;driver_class&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;org.hsqldb.jdbcDriver&quot;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>Running the Shell Service on SSH with JDBC authentication.</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> ShellService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@vertx/shell&quot;</span>
<span class="token keyword">let</span> service <span class="token operator">=</span> ShellService<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>vertx<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">ShellServiceOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setSSHOptions</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">SSHTermOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setHost</span><span class="token punctuation">(</span><span class="token string">&quot;localhost&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setPort</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setKeyPairOptions</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">JksOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">setPath</span><span class="token punctuation">(</span><span class="token string">&quot;server-keystore.jks&quot;</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">&quot;wibble&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setAuthOptions</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">JDBCAuthOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">setConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token string">&quot;url&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;jdbc:hsqldb:mem:test?shutdown=true&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;driver_class&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;org.hsqldb.jdbcDriver&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
service<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h1 id="http-term-configuration"><a href="#http-term-configuration" class="header-anchor">#</a> HTTP term configuration</h1> <p>HTTP terms are configured by <code>setHttpOptions</code>, the http options extends
the <code>HttpServerOptions</code> so they expose the exact same configuration.</p> <p>In addition there are extra options for configuring an HTTP term:</p> <ul><li><p><code>setAuthOptions</code>: configures user authentication</p></li> <li><p><code>setSockJSHandlerOptions</code>: configures SockJS</p></li> <li><p><code>setSockJSPath</code>: the SockJS path in the router</p></li></ul> <p><strong>Deploying the Shell Service on HTTP with Mongo authentication.</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>vertx<span class="token punctuation">.</span><span class="token function">deployVerticle</span><span class="token punctuation">(</span><span class="token string">&quot;maven:{maven-groupId}:{maven-artifactId}:{maven-version}&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">DeploymentOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string">&quot;httpOptions&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;host&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;localhost&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;port&quot;</span> <span class="token operator">:</span> <span class="token number">8080</span><span class="token punctuation">,</span>
      <span class="token string">&quot;ssl&quot;</span> <span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token string">&quot;keyPairOptions&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;path&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;src/test/resources/server-keystore.jks&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;password&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;wibble&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token string">&quot;authOptions&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;provider&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;mongo&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;config&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token string">&quot;connection_string&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;mongodb://localhost:27018&quot;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>Running the Shell Service on HTTP with Mongo authentication.</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> ShellService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@vertx/shell&quot;</span>
<span class="token keyword">let</span> service <span class="token operator">=</span> ShellService<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>vertx<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">ShellServiceOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setHttpOptions</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HttpTermOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setHost</span><span class="token punctuation">(</span><span class="token string">&quot;localhost&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setPort</span><span class="token punctuation">(</span><span class="token number">8080</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setAuthOptions</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MongoAuthOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">setConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token string">&quot;connection_string&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;mongodb://localhost:27018&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
service<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>Deploying the Shell Service on HTTP with JDBC authentication.</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>vertx<span class="token punctuation">.</span><span class="token function">deployVerticle</span><span class="token punctuation">(</span><span class="token string">&quot;maven:{maven-groupId}:{maven-artifactId}:{maven-version}&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">DeploymentOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string">&quot;httpOptions&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;host&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;localhost&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;port&quot;</span> <span class="token operator">:</span> <span class="token number">8080</span><span class="token punctuation">,</span>
      <span class="token string">&quot;ssl&quot;</span> <span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token string">&quot;keyPairOptions&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;path&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;src/test/resources/server-keystore.jks&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;password&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;wibble&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token string">&quot;authOptions&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;provider&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;jdbc&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;config&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token string">&quot;url&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;jdbc:hsqldb:mem:test?shutdown=true&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;driver_class&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;org.hsqldb.jdbcDriver&quot;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>Running the Shell Service on HTTP with JDBC authentication.</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> ShellService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@vertx/shell&quot;</span>
<span class="token keyword">let</span> service <span class="token operator">=</span> ShellService<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>vertx<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">ShellServiceOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setHttpOptions</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HttpTermOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setHost</span><span class="token punctuation">(</span><span class="token string">&quot;localhost&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setPort</span><span class="token punctuation">(</span><span class="token number">8080</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setAuthOptions</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">JDBCAuthOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">setConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token string">&quot;url&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;jdbc:hsqldb:mem:test?shutdown=true&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;driver_class&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;org.hsqldb.jdbcDriver&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
service<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h1 id="keymap-configuration"><a href="#keymap-configuration" class="header-anchor">#</a> Keymap configuration</h1> <p>The shell uses a default keymap configuration that can be overriden
using the <code>inputrc</code> property of the various term configuration object:</p> <ul><li><p><code>setIntputrc</code></p></li> <li><p><code>setIntputrc</code></p></li> <li><p><code>setIntputrc</code></p></li></ul> <p>The <code>inputrc</code> must point to a file available via the classloader or the
filesystem.</p> <p>The <code>inputrc</code> only function bindings and the available functions are:</p> <ul><li><p><em>backward-char</em></p></li> <li><p><em>forward-char</em></p></li> <li><p><em>next-history</em></p></li> <li><p><em>previous-history</em></p></li> <li><p><em>backward-delete-char</em></p></li> <li><p><em>backward-delete-char</em></p></li> <li><p><em>backward-word</em></p></li> <li><p><em>end-of-line</em></p></li> <li><p><em>beginning-of-line</em></p></li> <li><p><em>delete-char</em></p></li> <li><p><em>delete-char</em></p></li> <li><p><em>complete</em></p></li> <li><p><em>accept-line</em></p></li> <li><p><em>accept-line</em></p></li> <li><p><em>kill-line</em></p></li> <li><p><em>backward-word</em></p></li> <li><p><em>forward-word</em></p></li> <li><p><em>backward-kill-word</em></p></li></ul> <blockquote><p><strong>Note</strong></p> <p>Extra functions can be added, however this is done by implementing
functions of the <code>Term.d</code> project on which Vert.x Shell is based, for
instance the <a href="https://github.com/termd/termd/blob/c1629623c8a3add4bde7778640bf8cc233a7c98f/src/examples/java/examples/readlinefunction/ReverseFunction.java" target="_blank" rel="noopener noreferrer">reverse
function<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
can be implemented and then declared in a
<code>META-INF/services/io.termd.core.readline.Function</code> to be loaded by
the shell.</p></blockquote> <h1 id="base-commands"><a href="#base-commands" class="header-anchor">#</a> Base commands</h1> <p>To find out the available commands you can use the <em>help</em> builtin
command:</p> <ol><li><p>Verticle commands</p> <ol><li><p>verticle-ls: list all deployed verticles</p></li> <li><p>verticle-undeploy: undeploy a verticle</p></li> <li><p>verticle-deploy: deploys a verticle with deployment options as
JSON string</p></li> <li><p>verticle-factories: list all known verticle factories</p></li></ol></li> <li><p>File system commands</p> <ol><li><p>ls</p></li> <li><p>cd</p></li> <li><p>pwd</p></li></ol></li> <li><p>Bus commands</p> <ol><li><p>bus-tail: display all incoming messages on an event bus address</p></li> <li><p>bus-send: send a message on the event bus</p></li></ol></li> <li><p>Net commands</p> <ol><li>net-ls: list all available net servers, including HTTP servers</li></ol></li> <li><p>Shared data commands</p> <ol><li><p>local-map-put</p></li> <li><p>local-map-get</p></li> <li><p>local-map-rm</p></li></ol></li> <li><p>Various commands</p> <ol><li><p>echo</p></li> <li><p>sleep</p></li> <li><p>help</p></li> <li><p>exit</p></li> <li><p>logout</p></li></ol></li> <li><p>Job control</p> <ol><li><p>fg</p></li> <li><p>bg</p></li> <li><p>jobs</p></li></ol></li></ol> <blockquote><p><strong>Note</strong></p> <p>this command list should evolve in next releases of Vert.x Shell.
Other Vert.x project may provide commands to extend Vert.x Shell, for
instance Dropwizard Metrics.</p></blockquote> <h1 id="extending-vert-x-shell"><a href="#extending-vert-x-shell" class="header-anchor">#</a> Extending Vert.x Shell</h1> <p>Vert.x Shell can be extended with custom commands in any of the
languages supporting code generation.</p> <p>A command is created by the <code>CommandBuilder.command</code> method: the command
process handler is called by the shell when the command is executed,
this handler can be set with the <code>processHandler</code> method:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> CommandBuilder <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@vertx/shell&quot;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CommandRegistry <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@vertx/shell&quot;</span>

<span class="token keyword">let</span> builder <span class="token operator">=</span> CommandBuilder<span class="token punctuation">.</span><span class="token function">command</span><span class="token punctuation">(</span><span class="token string">&quot;my-command&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
builder<span class="token punctuation">.</span><span class="token function">processHandler</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">process</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

  <span class="token comment">// Write a message to the console</span>
  process<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;Hello World&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// End the process</span>
  process<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Register the command</span>
<span class="token keyword">let</span> registry <span class="token operator">=</span> CommandRegistry<span class="token punctuation">.</span><span class="token function">getShared</span><span class="token punctuation">(</span>vertx<span class="token punctuation">)</span><span class="token punctuation">;</span>
registry<span class="token punctuation">.</span><span class="token function">registerCommand</span><span class="token punctuation">(</span>builder<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>vertx<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>After a command is created, it needs to be registed to a
<code>CommandRegistry</code>. The command registry holds all the commands for a
Vert.x instance.</p> <p>A command is registered until it is unregistered with the
<code>unregisterCommand</code>. When a command is registered from a Verticle, this
command is unregistered when this verticle is undeployed.</p> <blockquote><p><strong>Note</strong></p> <p>Command callbacks are invoked in the {@literal io.vertx.core.Context}
when the command is registered in the registry. Keep this in mind if
you maintain state in a command.</p></blockquote> <p>The <code>CommandProcess</code> object can be used for interacting with the shell.</p> <h2 id="command-arguments"><a href="#command-arguments" class="header-anchor">#</a> Command arguments</h2> <p>The <code>args</code> returns the command arguments:</p> <div class="language-js extra-class"><pre class="language-js"><code>command<span class="token punctuation">.</span><span class="token function">processHandler</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">process</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

  process<span class="token punctuation">.</span><span class="token function">args</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">arg</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// Print each argument on the console</span>
    process<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;Argument &quot;</span> <span class="token operator">+</span> arg<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  process<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Besides it is also possible to create commands using <code>Vert.x CLI</code>: it
makes easier to write command line argument parsing:</p> <ul><li><p><em>option</em> and <em>argument</em> parsing</p></li> <li><p>argument <em>validation</em></p></li> <li><p>generation of the command <em>usage</em></p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token constant">CLI</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@vertx/core&quot;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CommandBuilder <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@vertx/shell&quot;</span>
<span class="token keyword">let</span> cli <span class="token operator">=</span> <span class="token constant">CLI</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">&quot;my-command&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addArgument</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Argument</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setArgName</span><span class="token punctuation">(</span><span class="token string">&quot;my-arg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addOption</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Option</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setShortName</span><span class="token punctuation">(</span><span class="token string">&quot;m&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setLongName</span><span class="token punctuation">(</span><span class="token string">&quot;my-option&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> command <span class="token operator">=</span> CommandBuilder<span class="token punctuation">.</span><span class="token function">command</span><span class="token punctuation">(</span>cli<span class="token punctuation">)</span><span class="token punctuation">;</span>
command<span class="token punctuation">.</span><span class="token function">processHandler</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">process</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

  <span class="token keyword">let</span> commandLine <span class="token operator">=</span> process<span class="token punctuation">.</span><span class="token function">commandLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">let</span> argValue <span class="token operator">=</span> commandLine<span class="token punctuation">.</span><span class="token function">getArgumentValue</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> optValue <span class="token operator">=</span> commandLine<span class="token punctuation">.</span><span class="token function">getOptionValue</span><span class="token punctuation">(</span><span class="token string">&quot;my-option&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  process<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;The argument is &quot;</span> <span class="token operator">+</span> argValue <span class="token operator">+</span> <span class="token string">&quot; and the option is &quot;</span> <span class="token operator">+</span> optValue<span class="token punctuation">)</span><span class="token punctuation">;</span>

  process<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>When an option named <em>help</em> is added to the CLI object, the shell will
take care of generating the command usage when the option is activated:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token constant">CLI</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@vertx/core&quot;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CommandBuilder <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@vertx/shell&quot;</span>
<span class="token keyword">let</span> cli <span class="token operator">=</span> <span class="token constant">CLI</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">&quot;my-command&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addArgument</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Argument</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setArgName</span><span class="token punctuation">(</span><span class="token string">&quot;my-arg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addOption</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Option</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setArgName</span><span class="token punctuation">(</span><span class="token string">&quot;help&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setShortName</span><span class="token punctuation">(</span><span class="token string">&quot;h&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setLongName</span><span class="token punctuation">(</span><span class="token string">&quot;help&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> command <span class="token operator">=</span> CommandBuilder<span class="token punctuation">.</span><span class="token function">command</span><span class="token punctuation">(</span>cli<span class="token punctuation">)</span><span class="token punctuation">;</span>
command<span class="token punctuation">.</span><span class="token function">processHandler</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">process</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>When the command executes the <code>process</code> is provided for interacting with
the shell. A <code>CommandProcess</code> extends <code>Tty</code> which is used for
interacting with the terminal.</p> <h2 id="terminal-usage"><a href="#terminal-usage" class="header-anchor">#</a> Terminal usage</h2> <h3 id="terminal-i-o"><a href="#terminal-i-o" class="header-anchor">#</a> terminal I/O</h3> <p>The <code>stdinHandler</code> handler is used to be notified when the terminal
receives data, e.g the user uses his keyboard:</p> <div class="language-js extra-class"><pre class="language-js"><code>tty<span class="token punctuation">.</span><span class="token function">stdinHandler</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Received &quot;</span> <span class="token operator">+</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>A command can use the <code>write</code> to write to the standard output.</p> <div class="language-js extra-class"><pre class="language-js"><code>tty<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;Hello World&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="terminal-size"><a href="#terminal-size" class="header-anchor">#</a> Terminal size</h3> <p>The current terminal size can be obtained using <code>width</code> and <code>height</code>.</p> <div class="language-js extra-class"><pre class="language-js"><code>tty<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;Current terminal size: (&quot;</span> <span class="token operator">+</span> tty<span class="token punctuation">.</span><span class="token function">width</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;, &quot;</span> <span class="token operator">+</span> tty<span class="token punctuation">.</span><span class="token function">height</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="resize-event"><a href="#resize-event" class="header-anchor">#</a> Resize event</h3> <p>When the size of the terminal changes the <code>resizehandler</code> is called, the
new terminal size can be obtained with <code>width</code> and <code>height</code>.</p> <div class="language-js extra-class"><pre class="language-js"><code>tty<span class="token punctuation">.</span><span class="token function">resizehandler</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">v</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;terminal resized : &quot;</span> <span class="token operator">+</span> tty<span class="token punctuation">.</span><span class="token function">width</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> tty<span class="token punctuation">.</span><span class="token function">height</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="terminal-type"><a href="#terminal-type" class="header-anchor">#</a> Terminal type</h3> <p>The terminal type is useful for sending escape codes to the remote
terminal: <code>type</code> returns the current terminal type, it can be null if
the terminal has not advertised the value.</p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;terminal type : &quot;</span> <span class="token operator">+</span> tty<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="shell-session"><a href="#shell-session" class="header-anchor">#</a> Shell session</h2> <p>The shell is a connected service that naturally maintains a session with
the client, this session can be used in commands to scope data. A
command can get the session with <code>session</code>:</p> <div class="language-js extra-class"><pre class="language-js"><code>command<span class="token punctuation">.</span><span class="token function">processHandler</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">process</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

  <span class="token keyword">let</span> session <span class="token operator">=</span> process<span class="token punctuation">.</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>session<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;my_key&quot;</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token keyword">null</span> <span class="token operator">||</span> session<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;my_key&quot;</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    session<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;my key&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;my value&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  process<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="process-termination"><a href="#process-termination" class="header-anchor">#</a> Process termination</h2> <p>Calling <code>end</code> ends the current process. It can be called directly in the
invocation of the command handler or any time later:</p> <div class="language-js extra-class"><pre class="language-js"><code>command<span class="token punctuation">.</span><span class="token function">processHandler</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">process</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> vertx <span class="token operator">=</span> process<span class="token punctuation">.</span><span class="token function">vertx</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Set a timer</span>
  vertx<span class="token punctuation">.</span><span class="token function">setTimer</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

    <span class="token comment">// End the command when the timer is fired</span>
    process<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="process-events"><a href="#process-events" class="header-anchor">#</a> Process events</h2> <p>A command can subscribe to a few process events.</p> <h3 id="interrupt-event"><a href="#interrupt-event" class="header-anchor">#</a> Interrupt event</h3> <p>The <code>interruptHandler</code> is called when the process is interrupted, this
event is fired when the user press <em>Ctrl+C</em> during the execution of a
command. This handler can be used for interrupting commands <em>blocking</em>
the CLI and gracefully ending the command process:</p> <div class="language-js extra-class"><pre class="language-js"><code>command<span class="token punctuation">.</span><span class="token function">processHandler</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">process</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> vertx <span class="token operator">=</span> process<span class="token punctuation">.</span><span class="token function">vertx</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Every second print a message on the console</span>
  <span class="token keyword">let</span> periodicId <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">setPeriodic</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    process<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;tick\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// When user press Ctrl+C: cancel the timer and end the process</span>
  process<span class="token punctuation">.</span><span class="token function">interruptHandler</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">v</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    vertx<span class="token punctuation">.</span><span class="token function">cancelTimer</span><span class="token punctuation">(</span>periodicId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    process<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>When no interrupt handler is registered, pressing <em>Ctrl+C</em> will have no
effect on the current process and the event will be delayed and will
likely be handled by the shell, like printing a new line on the console.</p> <h3 id="suspend-resume-events"><a href="#suspend-resume-events" class="header-anchor">#</a> Suspend/resume events</h3> <p>The <code>suspendHandler</code> is called when the process is running and the user
press <em>Ctrl+Z</em>, the command is <em>suspended</em>:</p> <ul><li><p>the command can receive the suspend event when it has registered an
handler for this event</p></li> <li><p>the command will not receive anymore data from the standard input</p></li> <li><p>the shell prompt the user for input</p></li> <li><p>the command can receive interrupts event or end events</p></li></ul> <p>The <code>resumeHandler</code> is called when the process is resumed, usually when
the user types <em>fg</em>:</p> <ul><li><p>the command can receive the resume event when it has registered an
handler for this event</p></li> <li><p>the command will receive again data from the standard input when it
has registered an stdin handler</p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code>command<span class="token punctuation">.</span><span class="token function">processHandler</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">process</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

  <span class="token comment">// Command is suspended</span>
  process<span class="token punctuation">.</span><span class="token function">suspendHandler</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">v</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Suspended&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Command is resumed</span>
  process<span class="token punctuation">.</span><span class="token function">resumeHandler</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">v</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Resumed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="end-events"><a href="#end-events" class="header-anchor">#</a> End events</h3> <p>The <code>endHandler</code> (io.vertx.core.Handler)} is called when the process is
running or suspended and the command terminates, for instance the shell
session is closed, the command is <em>terminated</em>.</p> <div class="language-js extra-class"><pre class="language-js"><code>command<span class="token punctuation">.</span><span class="token function">processHandler</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">process</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

  <span class="token comment">// Command terminates</span>
  process<span class="token punctuation">.</span><span class="token function">endHandler</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">v</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Terminated&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The end handler is called even when the command invokes <code>end</code>.</p> <p>This handler is useful for cleaning up resources upon command
termination, for instance closing a client or a timer.</p> <h2 id="command-completion"><a href="#command-completion" class="header-anchor">#</a> Command completion</h2> <p>A command can provide a completion handler when it wants to provide
contextual command line interface completion.</p> <p>Like the process handler, the <code>completion handler</code> is non blocking because the implementation may use Vert.x
services, e.g the file system.</p> <p>The <code>lineTokens</code> returns a list of <code>tokens</code> from the beginning of the
line to the cursor position. The list can be empty if the cursor when
the cursor is at the beginning of the line.</p> <p>The <code>rawLine</code> returns the current completed from the beginning of the
line to the cursor position, in raw format, i.e without any char escape
performed.</p> <p>Completion ends with a call to <code>complete</code>.</p> <h1 id="shell-server"><a href="#shell-server" class="header-anchor">#</a> Shell server</h1> <p>The Shell service is a convenient facade for starting a preconfigured
shell either programmatically or as a Vert.x service. When more
flexibility is needed, a <code>ShellServer</code> can be used instead of the
service.</p> <p>For instance the shell http term can be configured to use an existing
router instead of starting its own http server.</p> <p>Using a shell server requires explicit configuration but provides full
flexiblity, a shell server is setup in a few steps:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> ShellServer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@vertx/shell&quot;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Router <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@vertx/web&quot;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> TermServer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@vertx/shell&quot;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CommandResolver <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@vertx/shell&quot;</span>

<span class="token keyword">let</span> server <span class="token operator">=</span> ShellServer<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>vertx<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> shellRouter <span class="token operator">=</span> Router<span class="token punctuation">.</span><span class="token function">router</span><span class="token punctuation">(</span>vertx<span class="token punctuation">)</span><span class="token punctuation">;</span>
router<span class="token punctuation">.</span><span class="token function">mountSubRouter</span><span class="token punctuation">(</span><span class="token string">&quot;/shell&quot;</span><span class="token punctuation">,</span> shellRouter<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> httpTermServer <span class="token operator">=</span> TermServer<span class="token punctuation">.</span><span class="token function">createHttpTermServer</span><span class="token punctuation">(</span>vertx<span class="token punctuation">,</span> router<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> sshTermServer <span class="token operator">=</span> TermServer<span class="token punctuation">.</span><span class="token function">createSSHTermServer</span><span class="token punctuation">(</span>vertx<span class="token punctuation">)</span><span class="token punctuation">;</span>

server<span class="token punctuation">.</span><span class="token function">registerTermServer</span><span class="token punctuation">(</span>httpTermServer<span class="token punctuation">)</span><span class="token punctuation">;</span>
server<span class="token punctuation">.</span><span class="token function">registerTermServer</span><span class="token punctuation">(</span>sshTermServer<span class="token punctuation">)</span><span class="token punctuation">;</span>

server<span class="token punctuation">.</span><span class="token function">registerCommandResolver</span><span class="token punctuation">(</span>CommandResolver<span class="token punctuation">.</span><span class="token function">baseCommands</span><span class="token punctuation">(</span>vertx<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li><p>create a the shell server</p></li> <li><p>create an HTTP term server mounted on an existing router</p></li> <li><p>create an SSH term server</p></li> <li><p>register term servers</p></li> <li><p>register all base commands</p></li> <li><p>finally start the shell server</p></li></ul> <p>Besides, the shell server can also be used for creating in process shell
session: it provides a programmatic interactive shell.</p> <p>In process shell session can be created with <code>createShell</code>:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Create a shell ession</span>
<span class="token keyword">let</span> shell <span class="token operator">=</span> shellServer<span class="token punctuation">.</span><span class="token function">createShell</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The main use case is running or testing a command:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Pty <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@vertx/shell&quot;</span>

<span class="token comment">// Create a shell</span>
<span class="token keyword">let</span> shell <span class="token operator">=</span> shellServer<span class="token punctuation">.</span><span class="token function">createShell</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Create a job fo the command</span>
<span class="token keyword">let</span> job <span class="token operator">=</span> shell<span class="token punctuation">.</span><span class="token function">createJob</span><span class="token punctuation">(</span><span class="token string">&quot;my-command 1234&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Create a pseudo terminal</span>
<span class="token keyword">let</span> pty <span class="token operator">=</span> Pty<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
pty<span class="token punctuation">.</span><span class="token function">stdoutHandler</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Command wrote &quot;</span> <span class="token operator">+</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Run the command</span>
job<span class="token punctuation">.</span><span class="token function">setTty</span><span class="token punctuation">(</span>pty<span class="token punctuation">.</span><span class="token function">slave</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
job<span class="token punctuation">.</span><span class="token function">statusUpdateHandler</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">status</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Command terminated with status &quot;</span> <span class="token operator">+</span> status<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The <code>Pty</code> pseudo terminal is the main interface for interacting with the
command when it’s running:</p> <ul><li><p>uses standard input/output for writing or reading strings</p></li> <li><p>resize the terminal</p></li></ul> <p>The <code>close</code> closes the shell, it will terminate all jobs in the current
shell session.</p> <h1 id="terminal-servers"><a href="#terminal-servers" class="header-anchor">#</a> Terminal servers</h1> <p>Vert.x Shell also provides bare terminal servers for those who need to
write pure terminal applications.</p> <p>A <code>Term</code> handler must be set on a term server before starting it. This
handler will handle each term when the user connects.</p> <p>An <code>AuthOptions</code> can be set on <code>SSHTermOptions</code> and <code>HttpTermOptions</code>.
Alternatively, an <code>AuthProvider</code> can be <code>set</code> directly on the term
server before starting it.</p> <h2 id="ssh-term"><a href="#ssh-term" class="header-anchor">#</a> SSH term</h2> <p>The terminal server <code>Term</code> handler accepts incoming terminal
connections. When a remote terminal connects, the <code>Term</code> can be used to
interact with connected terminal.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> TermServer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@vertx/shell&quot;</span>
<span class="token keyword">let</span> server <span class="token operator">=</span> TermServer<span class="token punctuation">.</span><span class="token function">createSSHTermServer</span><span class="token punctuation">(</span>vertx<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">SSHTermOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setPort</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setHost</span><span class="token punctuation">(</span><span class="token string">&quot;localhost&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
server<span class="token punctuation">.</span><span class="token function">termHandler</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">term</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  term<span class="token punctuation">.</span><span class="token function">stdinHandler</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">line</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    term<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The <code>Term</code> is also a <code>Tty</code>, this section explains how to use the tty.</p> <h2 id="telnet-term"><a href="#telnet-term" class="header-anchor">#</a> Telnet term</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> TermServer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@vertx/shell&quot;</span>
<span class="token keyword">let</span> server <span class="token operator">=</span> TermServer<span class="token punctuation">.</span><span class="token function">createTelnetTermServer</span><span class="token punctuation">(</span>vertx<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">TelnetTermOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setPort</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setHost</span><span class="token punctuation">(</span><span class="token string">&quot;localhost&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
server<span class="token punctuation">.</span><span class="token function">termHandler</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">term</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  term<span class="token punctuation">.</span><span class="token function">stdinHandler</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">line</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    term<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="http-term"><a href="#http-term" class="header-anchor">#</a> HTTP term</h2> <p>The <code>TermServer.createHttpTermServer</code> method creates an HTTP term
server, built on top of Vert.x Web using the SockJS protocol.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> TermServer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@vertx/shell&quot;</span>
<span class="token keyword">let</span> server <span class="token operator">=</span> TermServer<span class="token punctuation">.</span><span class="token function">createHttpTermServer</span><span class="token punctuation">(</span>vertx<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">HttpTermOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setPort</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setHost</span><span class="token punctuation">(</span><span class="token string">&quot;localhost&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
server<span class="token punctuation">.</span><span class="token function">termHandler</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">term</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  term<span class="token punctuation">.</span><span class="token function">stdinHandler</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">line</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    term<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>An HTTP term can start its own HTTP server, or it can reuse an existing
Vert.x Web <code>Router</code>.</p> <p>The shell can be found at <code>/shell.html</code>.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> TermServer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@vertx/shell&quot;</span>
<span class="token keyword">let</span> server <span class="token operator">=</span> TermServer<span class="token punctuation">.</span><span class="token function">createHttpTermServer</span><span class="token punctuation">(</span>vertx<span class="token punctuation">,</span> router<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">HttpTermOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setPort</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setHost</span><span class="token punctuation">(</span><span class="token string">&quot;localhost&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
server<span class="token punctuation">.</span><span class="token function">termHandler</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">term</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  term<span class="token punctuation">.</span><span class="token function">stdinHandler</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">line</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    term<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The later option is convenient when the HTTP shell is integrated in an
existing HTTP server.</p> <p>The HTTP term server by default is configured for serving:</p> <ul><li><p>the <code>shell.html</code> page</p></li> <li><p>the <code>term.js</code> client library</p></li> <li><p>the <code>vertxshell.js</code> client library</p></li></ul> <p>The <code>vertxshell.js</code> integrates <code>term.js</code> is the client side part of the
HTTP term.</p> <p>It integrates <code>term.js</code> with SockJS and needs the URL of the HTTP term
server endpoint:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'load'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token keyword">var</span> url <span class="token operator">=</span> <span class="token string">'http://localhost/shell'</span><span class="token punctuation">;</span>
 <span class="token keyword">new</span> <span class="token class-name">VertxTerm</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">{</span>
   cols<span class="token operator">:</span> <span class="token number">80</span><span class="token punctuation">,</span>
   rows<span class="token operator">:</span> <span class="token number">24</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Straight websockets can also be used, if so, the remote term URL should
be suffixed with <code>/websocket</code>:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'load'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token keyword">var</span> url <span class="token operator">=</span> <span class="token string">'ws://localhost/shell/websocket'</span><span class="token punctuation">;</span>
 <span class="token keyword">new</span> <span class="token class-name">VertxTerm</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">{</span>
   cols<span class="token operator">:</span> <span class="token number">80</span><span class="token punctuation">,</span>
   rows<span class="token operator">:</span> <span class="token number">24</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>For customization purpose these resources can be copied and customized,
they are available in the Vert.x Shell jar under the
<code>io.vertx.ext.shell</code> packages.</p> <h1 id="command-discovery"><a href="#command-discovery" class="header-anchor">#</a> Command discovery</h1> <p>The command discovery can be used when new commands need to be added to
Vert.x without an explicit registration.</p> <p>For example, the <em>Dropwizard</em> metrics service, adds specific metrics
command to the shell service on the fly.</p> <p>It can be achieved via the <code>java.util.ServiceLoader</code> of a
<code>CommandResolverFactory</code>.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CustomCommands</span> <span class="token keyword">implements</span> <span class="token class-name">CommandResolverFactory</span> <span class="token punctuation">{</span>

 <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">resolver</span><span class="token punctuation">(</span><span class="token class-name">Vertx</span> vertx<span class="token punctuation">,</span> <span class="token class-name">Handler</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AsyncResult</span><span class="token punctuation">&lt;</span><span class="token class-name">CommandResolver</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> resolverHandler<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   resolverHandler<span class="token punctuation">.</span><span class="token function">handler</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span>myCommand1<span class="token punctuation">,</span> myCommand2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The <code>resolver</code> method is async, because the resolver may need to wait
some condition before commands are resolved.</p> <p>The shell service discovery using the service loader mechanism:</p> <p><strong>The service provider file
<code>META-INF/services/io.vertx.ext.shell.spi.CommandResolverFactory</code>.</strong></p> <div class="language- extra-class"><pre><code>my.CustomCommands
</code></pre></div><p>This is only valid for the <code>ShellService</code>. <code>ShellServer</code> don’t use this
mechanism.</p> <h1 id="command-pack"><a href="#command-pack" class="header-anchor">#</a> Command pack</h1> <p>A command pack is a jar that provides new Vert.x Shell commands.</p> <p>Such jar just need to be present on the classpath and it is discovered
by Vertx. Shell.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CommandPackExample</span> <span class="token keyword">implements</span> <span class="token class-name">CommandResolverFactory</span> <span class="token punctuation">{</span>

  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">resolver</span><span class="token punctuation">(</span><span class="token class-name">Vertx</span> vertx<span class="token punctuation">,</span> <span class="token class-name">Handler</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AsyncResult</span><span class="token punctuation">&lt;</span><span class="token class-name">CommandResolver</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> resolveHandler<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Command</span><span class="token punctuation">&gt;</span></span> commands <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Add commands</span>
    commands<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">Command</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>vertx<span class="token punctuation">,</span> <span class="token class-name">JavaCommandExample</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Add another command</span>
    commands<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">CommandBuilder</span><span class="token punctuation">.</span><span class="token function">command</span><span class="token punctuation">(</span><span class="token string">&quot;another-command&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">processHandler</span><span class="token punctuation">(</span>process <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// Handle process</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>vertx<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Resolve with the commands</span>
    resolveHandler<span class="token punctuation">.</span><span class="token function">handle</span><span class="token punctuation">(</span><span class="token class-name">Future</span><span class="token punctuation">.</span><span class="token function">succeededFuture</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> commands<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The command pack uses command discovery mechanism, so it needs the
descriptor:</p> <p><strong><code>META-INF/services/io.vertx.ext.shell.spi.CommandResolverFactory</code>
descriptor.</strong></p> <div class="language- extra-class"><pre><code>examples.pack.CommandPackExample
</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/reactiverse/es4x/edit/develop/docs/manual/@vertx/shell/index.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">3/12/2020, 10:17:53 AM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/es4x/assets/js/app.45f626e2.js" defer></script><script src="/es4x/assets/js/2.9528bf06.js" defer></script><script src="/es4x/assets/js/122.efa391c4.js" defer></script>
  </body>
</html>
