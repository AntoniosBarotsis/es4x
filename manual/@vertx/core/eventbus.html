<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>The Event Bus | ES for Eclipse Vert.x</title>
    <meta name="generator" content="VuePress 1.5.0">
    <link rel="shortcut icon" type="image/png" href="/es4x/favicon.png">
    <link rel="stylesheet" type="text/css" href="/es4x/player/asciinema-player.css">
    <script src="/es4x/player/asciinema-player.js"></script>
    <meta name="description" content="A Modern JavaScript runtime for Eclipse Vert.x">
    <link rel="preload" href="/es4x/assets/css/0.styles.57be2129.css" as="style"><link rel="preload" href="/es4x/assets/js/app.cfb14a02.js" as="script"><link rel="preload" href="/es4x/assets/js/2.96613d0f.js" as="script"><link rel="preload" href="/es4x/assets/js/72.4a3f3614.js" as="script"><link rel="prefetch" href="/es4x/assets/js/10.25f493b2.js"><link rel="prefetch" href="/es4x/assets/js/100.cfb483ce.js"><link rel="prefetch" href="/es4x/assets/js/101.e546445b.js"><link rel="prefetch" href="/es4x/assets/js/102.9c678484.js"><link rel="prefetch" href="/es4x/assets/js/103.58ddcfc8.js"><link rel="prefetch" href="/es4x/assets/js/104.5d636807.js"><link rel="prefetch" href="/es4x/assets/js/105.9c9f8986.js"><link rel="prefetch" href="/es4x/assets/js/106.fb797c19.js"><link rel="prefetch" href="/es4x/assets/js/107.29eb69ad.js"><link rel="prefetch" href="/es4x/assets/js/108.d97e0b4e.js"><link rel="prefetch" href="/es4x/assets/js/109.28629ef4.js"><link rel="prefetch" href="/es4x/assets/js/11.6250afa8.js"><link rel="prefetch" href="/es4x/assets/js/110.3dd0cba3.js"><link rel="prefetch" href="/es4x/assets/js/111.601b115c.js"><link rel="prefetch" href="/es4x/assets/js/112.a49c45ac.js"><link rel="prefetch" href="/es4x/assets/js/113.ea0e864c.js"><link rel="prefetch" href="/es4x/assets/js/114.24c46597.js"><link rel="prefetch" href="/es4x/assets/js/115.65241419.js"><link rel="prefetch" href="/es4x/assets/js/116.a69493f0.js"><link rel="prefetch" href="/es4x/assets/js/117.03106a2c.js"><link rel="prefetch" href="/es4x/assets/js/118.50ed2245.js"><link rel="prefetch" href="/es4x/assets/js/119.beb4913a.js"><link rel="prefetch" href="/es4x/assets/js/12.1f7f2bd3.js"><link rel="prefetch" href="/es4x/assets/js/120.f13c267c.js"><link rel="prefetch" href="/es4x/assets/js/121.197dd995.js"><link rel="prefetch" href="/es4x/assets/js/122.b44c98b3.js"><link rel="prefetch" href="/es4x/assets/js/123.4586e425.js"><link rel="prefetch" href="/es4x/assets/js/124.d00a049e.js"><link rel="prefetch" href="/es4x/assets/js/125.1f32b7a7.js"><link rel="prefetch" href="/es4x/assets/js/126.e0bbd98d.js"><link rel="prefetch" href="/es4x/assets/js/127.fc93d280.js"><link rel="prefetch" href="/es4x/assets/js/128.98e5a4cc.js"><link rel="prefetch" href="/es4x/assets/js/129.fb3a3f88.js"><link rel="prefetch" href="/es4x/assets/js/13.1a7b9986.js"><link rel="prefetch" href="/es4x/assets/js/130.5cd4d89d.js"><link rel="prefetch" href="/es4x/assets/js/131.6ac7fa33.js"><link rel="prefetch" href="/es4x/assets/js/132.c8ad9a79.js"><link rel="prefetch" href="/es4x/assets/js/133.90881bb4.js"><link rel="prefetch" href="/es4x/assets/js/134.f7596c11.js"><link rel="prefetch" href="/es4x/assets/js/135.f8db6a39.js"><link rel="prefetch" href="/es4x/assets/js/136.bd2de92d.js"><link rel="prefetch" href="/es4x/assets/js/137.eabfa5f6.js"><link rel="prefetch" href="/es4x/assets/js/138.c19e308b.js"><link rel="prefetch" href="/es4x/assets/js/139.e437bff1.js"><link rel="prefetch" href="/es4x/assets/js/14.b66836b1.js"><link rel="prefetch" href="/es4x/assets/js/140.8d09b641.js"><link rel="prefetch" href="/es4x/assets/js/141.4d46fb84.js"><link rel="prefetch" href="/es4x/assets/js/142.99040345.js"><link rel="prefetch" href="/es4x/assets/js/143.7d902150.js"><link rel="prefetch" href="/es4x/assets/js/144.0543ff8f.js"><link rel="prefetch" href="/es4x/assets/js/145.6a2886f8.js"><link rel="prefetch" href="/es4x/assets/js/146.01466845.js"><link rel="prefetch" href="/es4x/assets/js/147.42e445c8.js"><link rel="prefetch" href="/es4x/assets/js/148.e677edea.js"><link rel="prefetch" href="/es4x/assets/js/149.50959280.js"><link rel="prefetch" href="/es4x/assets/js/15.bd087613.js"><link rel="prefetch" href="/es4x/assets/js/150.eabb62e5.js"><link rel="prefetch" href="/es4x/assets/js/151.a6f046ed.js"><link rel="prefetch" href="/es4x/assets/js/152.78e21db3.js"><link rel="prefetch" href="/es4x/assets/js/153.eef01fd9.js"><link rel="prefetch" href="/es4x/assets/js/154.f5b66c27.js"><link rel="prefetch" href="/es4x/assets/js/155.f5cbe3be.js"><link rel="prefetch" href="/es4x/assets/js/156.3fdf30f1.js"><link rel="prefetch" href="/es4x/assets/js/157.aeebd96f.js"><link rel="prefetch" href="/es4x/assets/js/158.bec405e9.js"><link rel="prefetch" href="/es4x/assets/js/159.f81bc2fa.js"><link rel="prefetch" href="/es4x/assets/js/16.a392a655.js"><link rel="prefetch" href="/es4x/assets/js/160.611a570e.js"><link rel="prefetch" href="/es4x/assets/js/161.400aed1c.js"><link rel="prefetch" href="/es4x/assets/js/162.60fdd908.js"><link rel="prefetch" href="/es4x/assets/js/163.841834be.js"><link rel="prefetch" href="/es4x/assets/js/164.368aca3b.js"><link rel="prefetch" href="/es4x/assets/js/165.6ed202c4.js"><link rel="prefetch" href="/es4x/assets/js/166.cd243b01.js"><link rel="prefetch" href="/es4x/assets/js/167.74493e23.js"><link rel="prefetch" href="/es4x/assets/js/168.26ae4c80.js"><link rel="prefetch" href="/es4x/assets/js/169.adffbf41.js"><link rel="prefetch" href="/es4x/assets/js/17.f58ddc3f.js"><link rel="prefetch" href="/es4x/assets/js/170.ec119bad.js"><link rel="prefetch" href="/es4x/assets/js/171.8ce41d74.js"><link rel="prefetch" href="/es4x/assets/js/172.c0640f4c.js"><link rel="prefetch" href="/es4x/assets/js/18.d0e693e8.js"><link rel="prefetch" href="/es4x/assets/js/19.2cfa07bf.js"><link rel="prefetch" href="/es4x/assets/js/20.83c2c4e9.js"><link rel="prefetch" href="/es4x/assets/js/21.bfb22c95.js"><link rel="prefetch" href="/es4x/assets/js/22.80259bfc.js"><link rel="prefetch" href="/es4x/assets/js/23.d3df90af.js"><link rel="prefetch" href="/es4x/assets/js/24.47cf75e1.js"><link rel="prefetch" href="/es4x/assets/js/25.af00dd42.js"><link rel="prefetch" href="/es4x/assets/js/26.2c5dd1f3.js"><link rel="prefetch" href="/es4x/assets/js/27.313c4d9d.js"><link rel="prefetch" href="/es4x/assets/js/28.c3fa5296.js"><link rel="prefetch" href="/es4x/assets/js/29.bc391437.js"><link rel="prefetch" href="/es4x/assets/js/3.4d2250de.js"><link rel="prefetch" href="/es4x/assets/js/30.ab72b827.js"><link rel="prefetch" href="/es4x/assets/js/31.360cf0c4.js"><link rel="prefetch" href="/es4x/assets/js/32.a454f02e.js"><link rel="prefetch" href="/es4x/assets/js/33.9072e3dc.js"><link rel="prefetch" href="/es4x/assets/js/34.2cd817f7.js"><link rel="prefetch" href="/es4x/assets/js/35.1499c4b4.js"><link rel="prefetch" href="/es4x/assets/js/36.b24867f2.js"><link rel="prefetch" href="/es4x/assets/js/37.8a1d9476.js"><link rel="prefetch" href="/es4x/assets/js/38.1caa3e15.js"><link rel="prefetch" href="/es4x/assets/js/39.ab25bad3.js"><link rel="prefetch" href="/es4x/assets/js/4.2410671b.js"><link rel="prefetch" href="/es4x/assets/js/40.13850330.js"><link rel="prefetch" href="/es4x/assets/js/41.1f30e160.js"><link rel="prefetch" href="/es4x/assets/js/42.f65b46db.js"><link rel="prefetch" href="/es4x/assets/js/43.86bd3898.js"><link rel="prefetch" href="/es4x/assets/js/44.25aede52.js"><link rel="prefetch" href="/es4x/assets/js/45.fbb6033a.js"><link rel="prefetch" href="/es4x/assets/js/46.13bb4f87.js"><link rel="prefetch" href="/es4x/assets/js/47.01a4d32b.js"><link rel="prefetch" href="/es4x/assets/js/48.4ef5e818.js"><link rel="prefetch" href="/es4x/assets/js/49.896ad60c.js"><link rel="prefetch" href="/es4x/assets/js/5.f2fd7a11.js"><link rel="prefetch" href="/es4x/assets/js/50.54a8010f.js"><link rel="prefetch" href="/es4x/assets/js/51.26142f55.js"><link rel="prefetch" href="/es4x/assets/js/52.b132a309.js"><link rel="prefetch" href="/es4x/assets/js/53.dc983026.js"><link rel="prefetch" href="/es4x/assets/js/54.3ae4a5b7.js"><link rel="prefetch" href="/es4x/assets/js/55.4b3e9675.js"><link rel="prefetch" href="/es4x/assets/js/56.2cc05aac.js"><link rel="prefetch" href="/es4x/assets/js/57.f8c33e2c.js"><link rel="prefetch" href="/es4x/assets/js/58.7b7e6201.js"><link rel="prefetch" href="/es4x/assets/js/59.beab06b9.js"><link rel="prefetch" href="/es4x/assets/js/6.7eb69711.js"><link rel="prefetch" href="/es4x/assets/js/60.ad528007.js"><link rel="prefetch" href="/es4x/assets/js/61.7462fe68.js"><link rel="prefetch" href="/es4x/assets/js/62.c7245534.js"><link rel="prefetch" href="/es4x/assets/js/63.91dfc6d8.js"><link rel="prefetch" href="/es4x/assets/js/64.a9a5d5d7.js"><link rel="prefetch" href="/es4x/assets/js/65.bd897469.js"><link rel="prefetch" href="/es4x/assets/js/66.b6b4afbd.js"><link rel="prefetch" href="/es4x/assets/js/67.b882907b.js"><link rel="prefetch" href="/es4x/assets/js/68.32bb2628.js"><link rel="prefetch" href="/es4x/assets/js/69.6e7fa7f2.js"><link rel="prefetch" href="/es4x/assets/js/7.e56c8e30.js"><link rel="prefetch" href="/es4x/assets/js/70.9fa2afb4.js"><link rel="prefetch" href="/es4x/assets/js/71.228413c9.js"><link rel="prefetch" href="/es4x/assets/js/73.abf3fc90.js"><link rel="prefetch" href="/es4x/assets/js/74.13ff27d1.js"><link rel="prefetch" href="/es4x/assets/js/75.96ffdfe8.js"><link rel="prefetch" href="/es4x/assets/js/76.ef6180eb.js"><link rel="prefetch" href="/es4x/assets/js/77.7c3517c1.js"><link rel="prefetch" href="/es4x/assets/js/78.a4cb55ca.js"><link rel="prefetch" href="/es4x/assets/js/79.2a3d8a2f.js"><link rel="prefetch" href="/es4x/assets/js/8.3d81d937.js"><link rel="prefetch" href="/es4x/assets/js/80.80c9d719.js"><link rel="prefetch" href="/es4x/assets/js/81.7be9486c.js"><link rel="prefetch" href="/es4x/assets/js/82.f30975e2.js"><link rel="prefetch" href="/es4x/assets/js/83.2e22eebd.js"><link rel="prefetch" href="/es4x/assets/js/84.60798b2c.js"><link rel="prefetch" href="/es4x/assets/js/85.a6928290.js"><link rel="prefetch" href="/es4x/assets/js/86.0be2ea51.js"><link rel="prefetch" href="/es4x/assets/js/87.ad51e710.js"><link rel="prefetch" href="/es4x/assets/js/88.81d5d220.js"><link rel="prefetch" href="/es4x/assets/js/89.aac46f66.js"><link rel="prefetch" href="/es4x/assets/js/9.2edb4e2b.js"><link rel="prefetch" href="/es4x/assets/js/90.4a4fd3dc.js"><link rel="prefetch" href="/es4x/assets/js/91.065cc9a5.js"><link rel="prefetch" href="/es4x/assets/js/92.055a4ecc.js"><link rel="prefetch" href="/es4x/assets/js/93.71b53f02.js"><link rel="prefetch" href="/es4x/assets/js/94.b096f725.js"><link rel="prefetch" href="/es4x/assets/js/95.af24f6b1.js"><link rel="prefetch" href="/es4x/assets/js/96.38f15cba.js"><link rel="prefetch" href="/es4x/assets/js/97.c53fc06f.js"><link rel="prefetch" href="/es4x/assets/js/98.3426a32c.js"><link rel="prefetch" href="/es4x/assets/js/99.fa951d15.js">
    <link rel="stylesheet" href="/es4x/assets/css/0.styles.57be2129.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/es4x/" class="home-link router-link-active"><!----> <span class="site-name">ES for Eclipse Vert.x</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/es4x/get-started/" class="nav-link">
  Get started
</a></div><div class="nav-item"><a href="/es4x/advanced/" class="nav-link">
  Advanced
</a></div><div class="nav-item"><a href="/es4x/manual/" class="nav-link router-link-active">
  Manual
</a></div><div class="nav-item"><a href="/es4x/api/" class="nav-link">
  APIs
</a></div><div class="nav-item"><a href="https://github.com/reactiverse/es4x/blob/master/CHANGELOG.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Changelog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/es4x/manual/@vertx/core/eventbus.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li><li class="dropdown-item"><!----> <a href="/es4x/zh/" class="nav-link">
  简体中文
</a></li><li class="dropdown-item"><!----> <a href="/es4x/pt/" class="nav-link">
  Português
</a></li></ul></div></div> <a href="https://github.com/reactiverse/es4x" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/es4x/get-started/" class="nav-link">
  Get started
</a></div><div class="nav-item"><a href="/es4x/advanced/" class="nav-link">
  Advanced
</a></div><div class="nav-item"><a href="/es4x/manual/" class="nav-link router-link-active">
  Manual
</a></div><div class="nav-item"><a href="/es4x/api/" class="nav-link">
  APIs
</a></div><div class="nav-item"><a href="https://github.com/reactiverse/es4x/blob/master/CHANGELOG.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Changelog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/es4x/manual/@vertx/core/eventbus.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li><li class="dropdown-item"><!----> <a href="/es4x/zh/" class="nav-link">
  简体中文
</a></li><li class="dropdown-item"><!----> <a href="/es4x/pt/" class="nav-link">
  Português
</a></li></ul></div></div> <a href="https://github.com/reactiverse/es4x" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Manuals</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/es4x/manual/" aria-current="page" class="sidebar-link">API Reference Manuals</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="the-event-bus"><a href="#the-event-bus" class="header-anchor">#</a> The Event Bus</h1> <p>The <code>event bus</code> is the <strong>nervous system</strong> of Vert.x.</p> <p>There is a single event bus instance for every Vert.x instance and it is
obtained using the method <code>eventBus</code>.</p> <p>The event bus allows different parts of your application to communicate
with each other, irrespective of what language they are written in, and
whether they’re in the same Vert.x instance, or in a different Vert.x
instance.</p> <p>It can even be bridged to allow client-side JavaScript running in a
browser to communicate on the same event bus.</p> <p>The event bus forms a distributed peer-to-peer messaging system spanning
multiple server nodes and multiple browsers.</p> <p>The event bus supports publish/subscribe, point-to-point, and
request-response messaging.</p> <p>The event bus API is very simple. It basically involves registering
handlers, unregistering handlers and sending and publishing messages.</p> <p>First some theory:</p> <h2 id="the-theory"><a href="#the-theory" class="header-anchor">#</a> The Theory</h2> <h3 id="addressing"><a href="#addressing" class="header-anchor">#</a> Addressing</h3> <p>Messages are sent on the event bus to an <strong>address</strong>.</p> <p>Vert.x doesn’t bother with any fancy addressing schemes. In Vert.x an
address is simply a string. Any string is valid. However it is wise to
use some kind of scheme, <em>e.g.</em> using periods to demarcate a namespace.</p> <p>Some examples of valid addresses are europe.news.feed1,
acme.games.pacman, sausages, and X.</p> <h3 id="handlers"><a href="#handlers" class="header-anchor">#</a> Handlers</h3> <p>Messages are received by handlers. You register a handler at an address.</p> <p>Many different handlers can be registered at the same address.</p> <p>A single handler can be registered at many different addresses.</p> <h3 id="publish-subscribe-messaging"><a href="#publish-subscribe-messaging" class="header-anchor">#</a> Publish / subscribe messaging</h3> <p>The event bus supports <strong>publishing</strong> messages.</p> <p>Messages are published to an address. Publishing means delivering the
message to all handlers that are registered at that address.</p> <p>This is the familiar <strong>publish/subscribe</strong> messaging pattern.</p> <h3 id="point-to-point-and-request-response-messaging"><a href="#point-to-point-and-request-response-messaging" class="header-anchor">#</a> Point-to-point and Request-Response messaging</h3> <p>The event bus also supports <strong>point-to-point</strong> messaging.</p> <p>Messages are sent to an address. Vert.x will then route them to just one
of the handlers registered at that address.</p> <p>If there is more than one handler registered at the address, one will be
chosen using a non-strict round-robin algorithm.</p> <p>With point-to-point messaging, an optional reply handler can be
specified when sending the message.</p> <p>When a message is received by a recipient, and has been handled, the
recipient can optionally decide to reply to the message. If they do so,
the reply handler will be called.</p> <p>When the reply is received back by the sender, it too can be replied to.
This can be repeated <em>ad infinitum</em>, and allows a dialog to be set up
between two different verticles.</p> <p>This is a common messaging pattern called the <strong>request-response</strong>
pattern.</p> <h3 id="best-effort-delivery"><a href="#best-effort-delivery" class="header-anchor">#</a> Best-effort delivery</h3> <p>Vert.x does its best to deliver messages and won’t consciously throw
them away. This is called <strong>best-effort</strong> delivery.</p> <p>However, in case of failure of all or parts of the event bus, there is a
possibility messages might be lost.</p> <p>If your application cares about lost messages, you should code your
handlers to be idempotent, and your senders to retry after recovery.</p> <h3 id="types-of-messages"><a href="#types-of-messages" class="header-anchor">#</a> Types of messages</h3> <p>Out of the box Vert.x allows any primitive/simple type, String, or
<code>buffers</code> to be sent as messages.</p> <p>However it’s a convention and common practice in Vert.x to send messages
as <a href="http://json.org/" target="_blank" rel="noopener noreferrer">JSON<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>JSON is very easy to create, read and parse in all the languages that
Vert.x supports so it has become a kind of <em>lingua franca</em> for Vert.x.</p> <p>However you are not forced to use JSON if you don’t want to.</p> <p>The event bus is very flexible and also supports sending arbitrary
objects over the event bus. You can do this by defining a <code>codec</code> for
the objects you want to send.</p> <h2 id="the-event-bus-api"><a href="#the-event-bus-api" class="header-anchor">#</a> The Event Bus API</h2> <p>Let’s jump into the API.</p> <h3 id="getting-the-event-bus"><a href="#getting-the-event-bus" class="header-anchor">#</a> Getting the event bus</h3> <p>You get a reference to the event bus as follows:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> eb <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">eventBus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>There is a single instance of the event bus per Vert.x instance.</p> <h3 id="registering-handlers"><a href="#registering-handlers" class="header-anchor">#</a> Registering Handlers</h3> <p>This simplest way to register a handler is using <code>consumer</code>. Here’s an
example:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> eb <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">eventBus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

eb<span class="token punctuation">.</span><span class="token function">consumer</span><span class="token punctuation">(</span><span class="token string">&quot;news.uk.sport&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">message</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;I have received a message: &quot;</span> <span class="token operator">+</span> message<span class="token punctuation">.</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>When a message arrives for your handler, your handler will be called,
passing in the <code>message</code>.</p> <p>The object returned from call to consumer() is an instance of
<code>MessageConsumer</code>.</p> <p>This object can subsequently be used to unregister the handler, or use
the handler as a stream.</p> <p>Alternatively you can use <code>consumer</code> to return a MessageConsumer with no
handler set, and then set the handler on that. For example:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> eb <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">eventBus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> consumer <span class="token operator">=</span> eb<span class="token punctuation">.</span><span class="token function">consumer</span><span class="token punctuation">(</span><span class="token string">&quot;news.uk.sport&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
consumer<span class="token punctuation">.</span><span class="token function">handler</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">message</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;I have received a message: &quot;</span> <span class="token operator">+</span> message<span class="token punctuation">.</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>When registering a handler on a clustered event bus, it can take some
time for the registration to reach all nodes of the cluster.</p> <p>If you want to be notified when this has completed, you can register a
<code>completion handler</code> on the MessageConsumer object.</p> <div class="language-js extra-class"><pre class="language-js"><code>consumer<span class="token punctuation">.</span><span class="token function">completionHandler</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token function">succeeded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;The handler registration has reached all nodes&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Registration failed!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="un-registering-handlers"><a href="#un-registering-handlers" class="header-anchor">#</a> Un-registering Handlers</h3> <p>To unregister a handler, call <code>unregister</code>.</p> <p>If you are on a clustered event bus, un-registering can take some time
to propagate across the nodes. If you want to be notified when this is
complete, use <code>unregister</code>.</p> <div class="language-js extra-class"><pre class="language-js"><code>consumer<span class="token punctuation">.</span><span class="token function">unregister</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token function">succeeded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;The handler un-registration has reached all nodes&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Un-registration failed!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="publishing-messages"><a href="#publishing-messages" class="header-anchor">#</a> Publishing messages</h3> <p>Publishing a message is simple. Just use <code>publish</code> specifying the
address to publish it to.</p> <div class="language-js extra-class"><pre class="language-js"><code>eventBus<span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span><span class="token string">&quot;news.uk.sport&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Yay! Someone kicked a ball&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>That message will then be delivered to all handlers registered against
the address news.uk.sport.</p> <h3 id="sending-messages"><a href="#sending-messages" class="header-anchor">#</a> Sending messages</h3> <p>Sending a message will result in only one handler registered at the
address receiving the message. This is the point-to-point messaging
pattern. The handler is chosen in a non-strict round-robin fashion.</p> <p>You can send a message with <code>send</code>.</p> <div class="language-js extra-class"><pre class="language-js"><code>eventBus<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&quot;news.uk.sport&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Yay! Someone kicked a ball&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="setting-headers-on-messages"><a href="#setting-headers-on-messages" class="header-anchor">#</a> Setting headers on messages</h3> <p>Messages sent over the event bus can also contain headers. This can be
specified by providing a {@link io.vertx.core.eventbus.DeliveryOptions}
when sending or publishing:</p> <div class="language-$lang extra-class"><pre class="language-text"><code>{@link docoverride.eventbus.Examples#headers(io.vertx.core.eventbus.EventBus)}
</code></pre></div><h3 id="message-ordering"><a href="#message-ordering" class="header-anchor">#</a> Message ordering</h3> <p>Vert.x will deliver messages to any particular handler in the same order
they were sent from any particular sender.</p> <h3 id="the-message-object"><a href="#the-message-object" class="header-anchor">#</a> The Message object</h3> <p>The object you receive in a message handler is a <code>Message</code>.</p> <p>The <code>body</code> of the message corresponds to the object that was sent or
published.</p> <p>The headers of the message are available with <code>headers</code>.</p> <h3 id="acknowledging-messages-sending-replies"><a href="#acknowledging-messages-sending-replies" class="header-anchor">#</a> Acknowledging messages / sending replies</h3> <p>When using <code>send</code> the event bus attempts to deliver the message to a
<code>MessageConsumer</code> registered with the event bus.</p> <p>In some cases it’s useful for the sender to know when the consumer has
received the message and &quot;processed&quot; it using <strong>request-response</strong>
pattern.</p> <p>To acknowledge that the message has been processed, the consumer can
reply to the message by calling <code>reply</code>.</p> <p>When this happens it causes a reply to be sent back to the sender and
the reply handler is invoked with the reply.</p> <p>An example will make this clear:</p> <p>The receiver:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> consumer <span class="token operator">=</span> eventBus<span class="token punctuation">.</span><span class="token function">consumer</span><span class="token punctuation">(</span><span class="token string">&quot;news.uk.sport&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
consumer<span class="token punctuation">.</span><span class="token function">handler</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">message</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;I have received a message: &quot;</span> <span class="token operator">+</span> message<span class="token punctuation">.</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  message<span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token string">&quot;how interesting!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The sender:</p> <div class="language-js extra-class"><pre class="language-js"><code>eventBus<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token string">&quot;news.uk.sport&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Yay! Someone kicked a ball across a patch of grass&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">ar</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>ar<span class="token punctuation">.</span><span class="token function">succeeded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Received reply: &quot;</span> <span class="token operator">+</span> ar<span class="token punctuation">.</span><span class="token function">result</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The reply can contain a message body which can contain useful
information.</p> <p>What the &quot;processing&quot; actually means is application-defined and depends
entirely on what the message consumer does and is not something that the
Vert.x event bus itself knows or cares about.</p> <p>Some examples:</p> <ul><li><p>A simple message consumer which implements a service which returns
the time of the day would acknowledge with a message containing the
time of day in the reply body</p></li> <li><p>A message consumer which implements a persistent queue, might
acknowledge with <code>true</code> if the message was successfully persisted in
storage, or <code>false</code> if not.</p></li> <li><p>A message consumer which processes an order might acknowledge with
<code>true</code> when the order has been successfully processed so it can be
deleted from the database</p></li></ul> <h3 id="sending-with-timeouts"><a href="#sending-with-timeouts" class="header-anchor">#</a> Sending with timeouts</h3> <p>When sending a message with a reply handler, you can specify a timeout
in the <code>DeliveryOptions</code>.</p> <p>If a reply is not received within that time, the reply handler will be
called with a failure.</p> <p>The default timeout is 30 seconds.</p> <h3 id="send-failures"><a href="#send-failures" class="header-anchor">#</a> Send Failures</h3> <p>Message sends can fail for other reasons, including:</p> <ul><li><p>There are no handlers available to send the message to</p></li> <li><p>The recipient has explicitly failed the message using <code>fail</code></p></li></ul> <p>In all cases, the reply handler will be called with the specific
failure.</p> <h3 id="message-codecs"><a href="#message-codecs" class="header-anchor">#</a> Message Codecs</h3> <p>You can send any object you like across the event bus if you define and
register a {@link io.vertx.core.eventbus.MessageCodec message codec} for
it.</p> <p>Message codecs have a name and you specify that name in the {@link
io.vertx.core.eventbus.DeliveryOptions} when sending or publishing the
message:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token punctuation">{</span><span class="token annotation punctuation">@link</span> docoverride<span class="token punctuation">.</span>eventbus<span class="token punctuation">.</span><span class="token class-name">Examples</span>#example10<span class="token punctuation">}</span>
</code></pre></div><p>If you always want the same codec to be used for a particular type then
you can register a default codec for it, then you don’t have to specify
the codec on each send in the delivery options:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token punctuation">{</span><span class="token annotation punctuation">@link</span> docoverride<span class="token punctuation">.</span>eventbus<span class="token punctuation">.</span><span class="token class-name">Examples</span>#example11<span class="token punctuation">}</span>
</code></pre></div><p>You unregister a message codec with {@link
io.vertx.core.eventbus.EventBus#unregisterCodec}.</p> <p>Message codecs don’t always have to encode and decode as the same type.
For example you can write a codec that allows a MyPOJO class to be sent,
but when that message is sent to a handler it arrives as a MyOtherPOJO
class.</p> <h3 id="clustered-event-bus"><a href="#clustered-event-bus" class="header-anchor">#</a> Clustered Event Bus</h3> <p>The event bus doesn’t just exist in a single Vert.x instance. By
clustering different Vert.x instances together on your network they can
form a single, distributed event bus.</p> <h3 id="clustering-programmatically"><a href="#clustering-programmatically" class="header-anchor">#</a> Clustering programmatically</h3> <p>If you’re creating your Vert.x instance programmatically you get a
clustered event bus by configuring the Vert.x instance as clustered;</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Vertx <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@vertx/core&quot;</span>
<span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VertxOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Vertx<span class="token punctuation">.</span><span class="token function">clusteredVertx</span><span class="token punctuation">(</span>options<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token function">succeeded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> vertx <span class="token operator">=</span> res<span class="token punctuation">.</span><span class="token function">result</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> eventBus <span class="token operator">=</span> vertx<span class="token punctuation">.</span><span class="token function">eventBus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;We now have a clustered event bus: &quot;</span> <span class="token operator">+</span> eventBus<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Failed: &quot;</span> <span class="token operator">+</span> res<span class="token punctuation">.</span><span class="token function">cause</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>You should also make sure you have a <code>ClusterManager</code> implementation on
your classpath, for example the Hazelcast cluster manager.</p> <h3 id="clustering-on-the-command-line"><a href="#clustering-on-the-command-line" class="header-anchor">#</a> Clustering on the command line</h3> <p>You can run Vert.x clustered on the command line with</p> <div class="language- extra-class"><pre><code>vertx run my-verticle.js -cluster
</code></pre></div><h2 id="automatic-clean-up-in-verticles"><a href="#automatic-clean-up-in-verticles" class="header-anchor">#</a> Automatic clean-up in verticles</h2> <p>If you’re registering event bus handlers from inside verticles, those
handlers will be automatically unregistered when the verticle is
undeployed.</p> <h1 id="configuring-the-event-bus"><a href="#configuring-the-event-bus" class="header-anchor">#</a> Configuring the event bus</h1> <p>The event bus can be configured. It is particularly useful when the
event bus is clustered. Under the hood the event bus uses TCP
connections to send and receive messages, so the {@link
io.vertx.core.eventbus.EventBusOptions} let you configure all aspects of
these TCP connections. As the event bus acts as a server and client, the
configuration is close to {@link io.vertx.core.net.NetClientOptions} and
{@link io.vertx.core.net.NetServerOptions}.</p> <div class="language-$lang extra-class"><pre class="language-text"><code>{@link examples.EventBusExamples#example13}
</code></pre></div><p>The previous snippet depicts how you can use SSL connections for the
event bus, instead of plain TCP connections.</p> <p><strong>WARNING</strong>: to enforce the security in clustered mode, you <strong>must</strong>
configure the cluster manager to use encryption or enforce security.
Refer to the documentation of the cluster manager for further details.</p> <p>The event bus configuration needs to be consistent in all the cluster
nodes.</p> <p>The {@link io.vertx.core.eventbus.EventBusOptions} also lets you specify
whether or not the event bus is clustered, the port and host.</p> <p>When used in containers, you can also configure the public host and
port:</p> <div class="language-$lang extra-class"><pre class="language-text"><code>{@link examples.EventBusExamples#example14}
</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/reactiverse/es4x/edit/develop/docs/manual/@vertx/core/eventbus.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">3/12/2020, 11:19:42 AM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/es4x/assets/js/app.cfb14a02.js" defer></script><script src="/es4x/assets/js/2.96613d0f.js" defer></script><script src="/es4x/assets/js/72.4a3f3614.js" defer></script>
  </body>
</html>
